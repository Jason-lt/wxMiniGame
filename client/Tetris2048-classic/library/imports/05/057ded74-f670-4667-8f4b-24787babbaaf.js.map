{"version":3,"sources":["../../../../../assets/Scripts/CommonFrame/assets/Scripts/CommonFrame/Bilog.js"],"names":["tywx","clickStatEventType","clickStatEventTypeUserFrom","clickStatEventTypeWxLoginStart","clickStatEventTypeWxLoginSuccess","clickStatEventTypeWxLoginFailed","clickStatEventTypeAuthorizationStart","clickStatEventTypeAuthorizationSuccess","clickStatEventTypeAuthorizationFailed","clickStatEventTypeLoginSDKStart","clickStatEventTypeLoginSDKSuccess","clickStatEventTypeLoginSDKFailed","clickStatEventTypeTCP_Start","clickStatEventTypeTCP_Success","clickStatEventTypeTCP_Failed","BiLog","uploadLogTimely","logtxt","StateInfo","networkConnected","LOGD","header","configObj","SystemInfo","errorLogServer","cloudId","intClientId","HttpUtil","httpPost","getSystemInfo","cloud_id","rec_type","rec_id","receive_time","user_id","UserInfo","userId","game_id","gameId","client_id","clientId","device_id","Util","getLocalUUID","ip_addr","nettype","phone_maker","phone_model","model","phone_carrier","reserved","uploadClickStatLogTimely","callbackObj","undefined","biLogServer","clickStat","eventId","paramsList","debugMode","dyeparams","length","i","push","console","log","JSON","stringify","bilog","assemblelog","eventid","paramsarr","time","Date","getTime","_timetag","paramstr","join","logStr","str","trimTab0","txt","replace"],"mappings":"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","file":"Bilog.js","sourceRoot":"../../../../../assets/Scripts/CommonFrame","sourcesContent":["/**\n * Created by xiaochuntian on 2018/5/2.\n */\n\n\ntywx.clickStatEventType = {\n    /**\n     * tywx.SystemInfo.errorLogServer = \"https://clienterr.touch4.me/api/bilog5/clientlog\"\n     * tywx.SystemInfo.biLogServer = \"https://cbi.touch4.me/api/bilog5/text\"\n     * 使用方法:\n     * 将bilog.js加入工程后,在需要打点的地方调用tywx.BiLog.clickStat(事件id,[参数列表]);\n     * 重要说明,必须看\n     * 以下事件是富豪斗地主设计的打点事件及其对应的编码,各项目组需要根据自己的需求进行设计\n     */\n    clickStatEventTypeUserFrom : 99990001,//用户来源\n\n    clickStatEventTypeWxLoginStart : 67890005,//微信登录开始\n    clickStatEventTypeWxLoginSuccess : 67890006,//微信登录成功\n    clickStatEventTypeWxLoginFailed : 678900007,//微信登录失败\n\n    clickStatEventTypeAuthorizationStart : 67890008,//授权开始\n    clickStatEventTypeAuthorizationSuccess : 67890009,//授权成功\n    clickStatEventTypeAuthorizationFailed : 67890010,//授权失败\n\n    clickStatEventTypeLoginSDKStart : 67890011,//登录SDK开始\n    clickStatEventTypeLoginSDKSuccess : 67890012,//登录SDK成功\n    clickStatEventTypeLoginSDKFailed : 67890013,//登录SDK时失败\n\n    clickStatEventTypeTCP_Start : 67890014,//TCP连接开始\n    clickStatEventTypeTCP_Success : 67890015,//TCP连接成功\n    clickStatEventTypeTCP_Failed : 67890016,//TCP连接失败\n\n};\n\ntywx.BiLog = {\n\n    /**\n     * 上传实时log,富豪斗地主用此接口上传错误情况下的日志\n     * @param logtxt:log内容\n     */\n    uploadLogTimely:function (logtxt) {\n        if(!tywx.StateInfo.networkConnected) {\n            tywx.LOGD('tywx.BiLog', 'net error!');\n            return;\n        }\n        if(logtxt) {\n            var header = ['Content-Type:text/plain'];\n            var configObj = {\n                'url': tywx.SystemInfo.errorLogServer + '?cloudname=' + tywx.SystemInfo.cloudId + '.' + tywx.SystemInfo.intClientId,\n                'header': header,\n                'postData': logtxt,\n                'callback': null\n            };\n            tywx.HttpUtil.httpPost(configObj,'POST');\n        }\n    },\n\n    getSystemInfo : function(){\n        this.cloud_id = tywx.SystemInfo.cloudId;   //独立服务id\n        this.rec_type = '1';   //日志类型\n        this.rec_id     = '0'; //日志记录id\n        this.receive_time  ='0'; // 日志接收时间  输出日志时统一填0，BI服务会在接收时添加\n        this.user_id = tywx.UserInfo.userId || '0';      //用户id\n        this.game_id = tywx.SystemInfo.gameId;      //游戏id\n        this.client_id = tywx.SystemInfo.clientId;\n        this.device_id = tywx.Util.getLocalUUID();\t//device id\n        this.ip_addr='#IP';// ip地址\t占位--服务器处理\n        this.nettype= \"0\"; //网络状况\n        this.phone_maker= \"0\"; //手机制造商\n        this.phone_model= tywx.UserInfo.model; //手机型号\n        this.phone_carrier= \"0\";//手机运营商\n        this.reserved ='0';\n    },\n    /*BI组打点\n     参数1是事件id，参数2是[],内含扩展参数\n     60001事件id\n     在查询工具，cloud id+game id+事件id即可找到,GDSS有前端日志查询工具\n     ty.BiLog.clickStat(ddz.StatEventInfo.DdzButtonClickInPlugin,\n     [ddz.PluginHall.Model.statInfoType[scope.index],ddz.GameId]);\n\n     // ty.BiLog.clickStat(hall5.BILogEvents.BILOG_EVENT_PLUGIN_UPDATE_SUCCESS,[hall5.BilogStatEvent.Plugin_Update_Success,gameid]);\n     */\n    uploadClickStatLogTimely:function (logtxt) {\n        var callbackObj = this;\n        if(logtxt!=undefined && logtxt!='') {\n            var header = ['Content-Type:text/plain'];\n            var configObj = {\n                'url': tywx.SystemInfo.biLogServer,\n                'headers': header,\n                'postData': logtxt,\n                'obj': callbackObj,\n                'tag': null,\n                'callback': null\n            };\n        }\n        tywx.HttpUtil.httpPost(configObj,'POST');\n    },\n\n    /**\n     * 打点接口\n     * @param eventId      打点事件\n     * @param ParamsList   额外参数,最多10位,参见bi组文档说明\n     */\n    clickStat: function (eventId, paramsList) {\n        if(tywx.StateInfo.debugMode){\n            return;\n        }\n        // tywx.LOGE(\"\",\"============clickStat====================\"+eventId+\"====\"+ParamsList[0]);\n        paramsList = paramsList || [];\n        var dyeparams = [];\n        if (paramsList.length < 10) {\n            for (var i = 0; i < 9; i++) {\n                if (i < paramsList.length) {\n                    dyeparams.push(paramsList[i]);}\n                else {\n                    dyeparams.push(0);\n                }\n            }\n        }\n        else {\n            dyeparams = paramsList;\n        }\n        console.log('clickStat: function (eventId, paramsList');\n        tywx.LOGD('BI打点', \"eventid= \" + eventId + \" 描述 = \" + JSON.stringify(dyeparams));\n        var bilog = this.assemblelog(eventId, dyeparams);\n        this.uploadClickStatLogTimely(bilog+ '\\n');\n    },\n\n    assemblelog:function (eventid, paramsarr) {\n        //获得1970到现在的秒数\n        var time = new Date().getTime();\n        //隔一分钟取网络状况\n        if(time-this._timetag>60000)\n        {\n            this._timetag = time;\n            this.nettype=0;\n        }\n        var paramstr = paramsarr.join('\\t');\n\n        this.getSystemInfo();\n        var logStr =this.cloud_id+'\\t'+this.rec_type+'\\t'+time+'\\t'+this.rec_id+'\\t'+this.receive_time+\n            '\\t'+eventid+'\\t'+this.user_id+'\\t'+this.game_id+'\\t'+this.client_id+'\\t'+this.device_id+'\\t'+\n            this.ip_addr +'\\t'+this.nettype+'\\t'+this.phone_maker +'\\t'+this.phone_model +'\\t'+this.phone_carrier+'\\t'+paramstr+'\\t'+ this.reserved ;\n\n        var str = this.trimTab0(logStr);\n        return str;\n    },\n\n    trimTab0:function (str) {\n        if(str==null || str==undefined)\n            return '';\n        var txt = str.replace(/(\\t0)*$/,'');\n        return txt;\n    },\n};\n"]}