{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/Game.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","girdRoot","default","type","Prefab","bg","Sprite","btnSound","battleRootPrefab","uiRootPrefab","rankPrefab","storePrefab","revivePrefab","titlePrefab","titleInfoPrefab","tipsNode","Node","btnCloseBanner","onLoad","console","log","_renderType","game","RENDER_TYPE_CANVAS","httpUtils","getComponent","active","initGameinfo","getConfigFile","Global","cdnGameConfig","self","LoadAtlas","loadAtlasRes","startGame","getReviveCoin","reviveCoinState","registReviveCoinCallback","bind","initFriendRank","xhr","loader","getXMLHttpRequest","open","onreadystatechange","readyState","status","responseText","length","ret","JSON","parse","totalSwith","linkImages","cdnShareImages","shareImages","cdnTexts","shareTexts","cdnShareImages1","shareImages1","cdnTexts1","shareTexts1","bgm","audioManager","i","registBGM","loopBGM","bannerAdConfig","e","send","error","startLoadRes","clearGameInfo","clearFriendGenStoneInfo","d","Date","now","gameinfo","loadFriendGenStoneInfo","shareTimes","shareTotalTimes","shareDate","toDateString","shareTime","shareData1","arrOpenGId","shareData2","shareData3","shareGroupData","reviveCoinNum","shareReviveCoinData","arrInviteCode","videoData","videoDate","Num","saveFriendGenStoneInfo","undefined","shareTicket","shareInfo","sourceCode","toString","indexOf","inviteCode","showDialogTextAlawys","push","startUI","updateReviveCoin","reviveUI","uiScript","instantiate","node","parent","removeChild","showStartUI","addChild","initStoreData","initTitleData","initUIData","showShareUI","showRank","isGroup","rankui","initData","showStore","storeUI","showRevive","showTitle","titleUI","showTitleInfo","titleInfoUI","onClose","storeData","loadInfo","skinIndex","loadCurrentSkin","titleData","titleDateData","titleUnlockData","shareData","loadShareData","d1","saveShareData","saveScore","wx","data","loadLocalScore","score","parseInt","maxscore","gold","loadScore","wxGold","showDialogText","text","p","setLocalZOrder","stopAllActions","label","getChildByName","Label","string","width","find","setTimeout","runAction","sequence","delayTime","callFunc","playSound","sname","volume","isBGMPlaying","loadRes","AudioClip","err","clip","sound","audioSource","AudioSource","play","restart","enterScene","gridController","initGridData","onCloseBanner","wxBannerAd","hideBannerAd"],"mappings":"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","file":"Game.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\nlet ThirdAPI = require('./common/ThirdAPI')\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        girdRoot: {\n            default: null,\n            type: cc.Prefab,\n        },\n        bg: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //声音\n        btnSound: {\n            default: null,\n            type: cc.Prefab,\n        },\n\n        //战斗\n        battleRootPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //ui\n        uiRootPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //排行\n        rankPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //商店\n        storePrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //复活界面\n        revivePrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //成就\n        titlePrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //成就查看\n        titleInfoPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //提示文本\n        tipsNode: {\n            default: null,\n            type: cc.Node,\n        },\n        btnCloseBanner: {\n            default: null,\n            type: cc.Node,\n        },\n    },\n\n    onLoad() {\n        console.log('主场景加载');\n\n        if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {\n            //cc.renderer.enableDirtyRegion(false);\n        }\n        //请求cdn数据\n        //2048配置测试更新\n        var httpUtils = this.getComponent('httpUtils');\n\n        this.tipsNode.active = false;\n        //this.clearGameInfo();\n        this.initGameinfo();\n\n        //请求cdn数据\n        this.getConfigFile();\n        console.log('startgame', Global.cdnGameConfig);\n\n        var self = this;\n        Global.LoadAtlas = require(\"LoadAtlas\");\n        Global.LoadAtlas.loadAtlasRes(\"textures/gridItem/skins\", function () {});\n        Global.LoadAtlas.loadAtlasRes(\"textures/gridItem/items\", function () {\n            self.startGame();\n\n            //ThirdAPI.registOnShow({callback: self.getReviveCoin.bind(self)});\n            self.getReviveCoin(Global.reviveCoinState);\n            Global.registReviveCoinCallback(self.getReviveCoin.bind(self));\n        });\n\n        Global.game = this.getComponent('Game');\n\n        ThirdAPI.initFriendRank();\n        //this.getReviveCoin();\n\n        //每周清空排行榜数据\n        //ThirdAPI.clearRankData();\n    },\n\n    // 从cdn获取文件\n    getConfigFile: function () {\n        let self = this;\n        try {\n            let xhr = cc.loader.getXMLHttpRequest();\n            xhr.open(\"GET\", \"https://sanxqn.nalrer.cn/tysanxiao/classics2048/config1.json\", true);\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if ((xhr.status >= 200 && xhr.status < 300)) {\n                        console.log(\"http res(\" + xhr.responseText.length + \"):\" + xhr.responseText);\n                        try {\n                            let ret = JSON.parse(xhr.responseText);\n                            console.log('get config', ret);\n\n                            // 游戏开关\n                            \n                            Global.cdnGameConfig = ret.cdnGameConfig;\n                            console.log('Global.cdnGameConfig.totalSwith:' + Global.cdnGameConfig.totalSwith);\n\n                            // 游戏内链图\n                            Global.linkImages = ret.linkImages;\n                            console.log('LinkImages:', Global.linkImages);\n\n                            // 游戏分享图及文案\n                            Global.cdnShareImages = ret.shareImages;\n                            Global.cdnTexts = ret.shareTexts;\n                            console.log('Share images and texts:', Global.cdnShareImages, Global.cdnTexts);\n\n                            Global.cdnShareImages1 = ret.shareImages1;\n                            Global.cdnTexts1 = ret.shareTexts1;\n                            console.log('Share prop images and texts:', Global.cdnShareImages1, Global.cdnTexts1);\n\n                            // 音频文件\n                            if (ret.bgm && ret.bgm.length > 0) {\n                                let audioManager = require('audioManager');\n                                for (let i = 0; i < ret.bgm.length; i++) {\n                                    console.log('注册背景音乐:', i, ret.bgm[i]);\n                                    audioManager.registBGM(i, ret.bgm[i]);\n                                }\n\n                                audioManager.loopBGM();\n                            }\n\n                            // banner广告信息\n                            if (ret.bannerAdConfig) {\n                                Global.bannerAdConfig = ret.bannerAdConfig;\n                                console.log('Banner ad config:', Global.bannerAdConfig);\n                            }\n\n                        } catch (e) {\n                            console.log(\"err:\" + e);\n                        }\n                    } else {\n                        console.log('get config error', xhr);\n                    }\n                }\n            };\n            xhr.send();\n        } catch (error) {\n            console.log(' get config error', error);\n        }\n    },\n\n    startLoadRes: function () {\n        var self = this;\n        Global.LoadAtlas = require(\"LoadAtlas\");\n        Global.LoadAtlas.loadAtlasRes(\"textures/gridItem/skins\", function () {});\n        Global.LoadAtlas.loadAtlasRes(\"textures/gridItem/items\", function () {\n            self.startGame();\n        });\n    },\n\n    // 清除游戏缓存数据\n    clearGameInfo: function () {\n        ThirdAPI.clearFriendGenStoneInfo();\n    },\n\n    // 加载游戏缓存数据\n    initGameinfo: function () {\n        var d = new Date(Date.now());\n\n        // 加载游戏缓存数据\n        Global.gameinfo = ThirdAPI.loadFriendGenStoneInfo();\n\n        // 没有数据初始化\n        if (!Global.gameinfo) {\n            Global.gameinfo = {\n                shareTimes: 0,\n                shareTotalTimes: 0,\n                shareDate: d.toDateString(),\n                shareTime: 0,\n                shareData1: {\n                    shareDate: d.toDateString(),\n                    arrOpenGId: [],\n                },\n                shareData2: {\n                    shareDate: d.toDateString(),\n                    arrOpenGId: [],\n                },\n                shareData3: {\n                    shareDate: d.toDateString(),\n                    arrOpenGId: [],\n                },\n                shareGroupData: {\n                    shareDate: d.toDateString(),\n                    arrOpenGId: [],\n                },\n                reviveCoinNum: 0,\n                shareReviveCoinData: {\n                    shareDate: d.toDateString(),\n                    arrInviteCode: [],\n                },\n                videoData: {\n                    videoDate: d.toDateString(),\n                    Num: 0,\n                },\n            }\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n        //判断是否是当日(向朋友索取)\n        if (Global.gameinfo.shareDate != d.toDateString()) {\n            Global.gameinfo.shareTimes = 0;\n            Global.gameinfo.shareTotalTimes = 0;\n            Global.gameinfo.shareTime = 0;\n            Global.gameinfo.shareDate = d.toDateString();\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        if (!Global.gameinfo.videoData || Global.gameinfo.videoData.videoDate != d.toDateString()) {\n            Global.gameinfo.videoData = {\n                videoDate: d.toDateString(),\n                Num: 0,\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        if (!Global.gameinfo.shareData1 || Global.gameinfo.shareData1.shareDate != d.toDateString()) {\n            Global.gameinfo.shareData1 = {\n                shareDate: d.toDateString(),\n                arrOpenGId: [],\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n        if (!Global.gameinfo.shareData2 || Global.gameinfo.shareData2.shareDate != d.toDateString()) {\n            Global.gameinfo.shareData2 = {\n                shareDate: d.toDateString(),\n                arrOpenGId: [],\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n        if (!Global.gameinfo.shareData3 || Global.gameinfo.shareData3.shareDate != d.toDateString()) {\n            Global.gameinfo.shareData3 = {\n                shareDate: d.toDateString(),\n                arrOpenGId: [],\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        // 分享群的奖励的数据存储\n        if (!Global.gameinfo.shareGroupData || Global.gameinfo.shareGroupData.shareDate != d.toDateString()) {\n            Global.gameinfo.shareGroupData = {\n                shareDate: d.toDateString(),\n                arrOpenGId: [],\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        // 复活卡的数据存储\n        if (!Global.gameinfo.shareReviveCoinData || Global.gameinfo.shareReviveCoinData.shareDate != d.toDateString()) {\n            Global.gameinfo.shareReviveCoinData = {\n                shareDate: d.toDateString(),\n                arrInviteCode: [],\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        if (Global.gameinfo.reviveCoinNum == undefined) {\n            Global.gameinfo.reviveCoinNum = 1;\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        } else if (Global.gameinfo.reviveCoinNum > 1) {\n            Global.gameinfo.reviveCoinNum = 1;\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        console.log('game info : ', Global.gameinfo);\n    },\n\n    //判断是否获得复活币\n    getReviveCoin: function (reviveCoinState) {\n        console.log('getReviveCoin ', reviveCoinState);\n        var shareTicket = reviveCoinState.shareTicket;\n        var shareInfo = reviveCoinState.shareInfo;\n        console.log('检测是否从微信群进入...', shareTicket, shareInfo);\n        if (shareTicket && shareInfo) {\n            console.log('是从微信群进入...');\n            if (shareInfo.sourceCode == 3020000006) {\n                console.log('是从微信群道具分享点进入...');\n\n                var d = new Date();\n                console.log('分享时间和点击时间对比：', d.toString(), shareInfo.shareTime);\n                if (Date.parse(d) - Date.parse(shareInfo.shareTime) < 60 * 60 * 1000) {\n                    console.log('链接可用');\n\n                    if (Global.gameinfo.reviveCoinNum == 0) {\n                        if (Global.gameinfo.shareReviveCoinData.arrInviteCode.indexOf(shareInfo.inviteCode) != -1) {\n                            console.log('今日已经领取过次好友赠送的复活卡了', shareInfo.inviteCode);\n                            Global.game.showDialogTextAlawys('今日已经领取过次好友赠送的复活卡了!');\n                        } else {\n                            console.log('此人的送道具链接没点过', shareInfo.inviteCode);\n                            Global.gameinfo.shareReviveCoinData.arrInviteCode.push(shareInfo.inviteCode);\n                            Global.gameinfo.reviveCoinNum = 1;\n                            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n\n                            if (Global.startUI) {\n                                Global.startUI.updateReviveCoin();\n                            }\n                            if (Global.reviveUI) {\n                                Global.reviveUI.updateReviveCoin();\n                            }\n                            this.showDialogTextAlawys(\"获得复活卡一张！\");\n                        }\n                    } else {\n                        this.showDialogTextAlawys(\"复活卡已达数量上限\");\n                    }\n                } else {\n                    console.log('链接已过期');\n                    this.showDialogTextAlawys(\"已被抢光了，下次加油吧！\");\n                }\n            }\n        } else {\n            console.log('不是从微信群进入...');\n        }\n\n        /*\n        var d = new Date();\n        console.log('当前时间：', d, Date.parse(d));\n        setTimeout(() => {\n            var d1 = new Date();\n            console.log('当前时间：', d1, Date.parse(d1), Date.parse(d)+10*1000);\n        }, 10000);\n        */\n    },\n\n    //开始游戏\n    startGame: function () {\n        if (!Global.uiScript) {\n            Global.uiScript = cc.instantiate(this.uiRootPrefab).getComponent(\"uiRoot\");\n        }\n        //如果有父节点则删除自身节点\n        if (Global.uiScript.node.parent) {\n            Global.uiScript.node.parent.removeChild(Global.uiScript.node);\n        }\n        Global.uiScript.showStartUI();\n\n        this.node.addChild(Global.uiScript.node);\n\n        this.initStoreData();\n        this.initTitleData();\n\n        this.initUIData();\n    },\n\n    //显示分享界面\n    showShareUI: function () {\n        if (!Global.uiScript) {\n            Global.uiScript = cc.instantiate(this.uiRootPrefab).getComponent(\"uiRoot\");\n        }\n        //如果有父节点则删除自身节点\n        if (Global.uiScript.node.parent) {\n            Global.uiScript.node.parent.removeChild(Global.uiScript.node);\n        }\n        this.node.addChild(Global.uiScript.node);\n        Global.uiScript.showShareUI();\n    },\n\n    //显示排行榜界面\n    showRank: function (isGroup) {\n        if (!Global.rankui) {\n            Global.rankui = cc.instantiate(this.rankPrefab).getComponent(\"rankUI\");\n        }\n        if (Global.rankui.node.parent) {\n            Global.rankui.node.parent.removeChild(Global.rankui.node);\n        }\n        this.node.addChild(Global.rankui.node);\n        Global.rankui.initData(isGroup);\n    },\n\n    //显示商店界面\n    showStore: function () {\n        if (!Global.storeUI) {\n            Global.storeUI = cc.instantiate(this.storePrefab).getComponent(\"UIStore\");\n        }\n        if (Global.storeUI.node.parent) {\n            Global.storeUI.node.parent.removeChild(Global.storeUI.node);\n        }\n        this.node.addChild(Global.storeUI.node);\n        Global.storeUI.initData();\n    },\n\n    //显示复活界面\n    showRevive: function () {\n        if (!Global.reviveUI) {\n            Global.reviveUI = cc.instantiate(this.revivePrefab).getComponent(\"reviveUI\");\n        }\n        if (Global.reviveUI.node.parent) {\n            Global.reviveUI.node.parent.removeChild(Global.reviveUI.node);\n        }\n        this.node.addChild(Global.reviveUI.node);\n        Global.reviveUI.initData();\n    },\n\n    //显示成就界面\n    showTitle: function () {\n        if (!Global.titleUI) {\n            Global.titleUI = cc.instantiate(this.titlePrefab).getComponent(\"UITitle\");\n        }\n        if (Global.titleUI.node.parent) {\n            Global.titleUI.node.parent.removeChild(Global.titleUI.node);\n        }\n        this.node.addChild(Global.titleUI.node);\n        Global.titleUI.initData();\n    },\n\n    //显示成就查看界面\n    showTitleInfo: function () {\n        if (!Global.titleInfoUI) {\n            Global.titleInfoUI = cc.instantiate(this.titleInfoPrefab).getComponent(\"UITitleInfo\");\n        }\n        if (Global.titleInfoUI.node.parent) {\n            Global.titleInfoUI.node.parent.removeChild(Global.titleInfoUI.node);\n        }\n        this.node.addChild(Global.titleInfoUI.node);\n        Global.titleInfoUI.initData();\n    },\n\n    //初始化ui信息\n    initUIData: function () {\n        this.showStore();\n        if (Global.storeUI) {\n            Global.storeUI.onClose();\n        }\n\n        this.showTitle();\n        if (Global.titleUI) {\n            Global.titleUI.onClose();\n        }\n\n        //Global.titleUI.updateItemsState(1);\n        //Global.titleUI.updateItemsState(2);\n        //Global.titleUI.updateItemsState(3);\n    },\n\n    //加载已购皮肤数据\n    initStoreData: function () {\n        //ThirdAPI.clearInfo('skinstore');\n        Global.storeData = ThirdAPI.loadInfo('skinstore');\n        if (Global.storeData == null) {\n            Global.storeData = [];\n        }\n\n        //ThirdAPI.saveScore(0, 0);\n\n        //ThirdAPI.clearCurrentSkin();\n        Global.skinIndex = ThirdAPI.loadCurrentSkin();\n        //console.log('current skin index : ', Global.skinIndex);\n    },\n\n    //加载成就数据\n    initTitleData: function () {\n        //ThirdAPI.clearInfo('title');\n        //Global.titleData = ThirdAPI.loadInfo('title');\n        if (Global.titleData == null) {\n            Global.titleData = [];\n        }\n\n        //ThirdAPI.clearInfo('title-date');\n        //Global.titleDateData = ThirdAPI.loadInfo('title-date');\n        if (Global.titleDateData == null) {\n            Global.titleDateData = [];\n        }\n\n        //ThirdAPI.clearInfo('title-unlock');\n        //Global.titleUnlockData = ThirdAPI.loadInfo('title-unlock');\n        if (Global.titleUnlockData == null) {\n            Global.titleUnlockData = [];\n        }\n\n        //ThirdAPI.clearInfo('title-unlock');\n        Global.shareData = ThirdAPI.loadShareData();\n        var d = new Date(Date.now());\n        if (!Global.shareData) {\n            //console.log('无分享限制数据，初始化');\n            var d1 = new Date(Date.now());\n            //console.log(d1.toDateString());\n            Global.shareData = {\n                shareTimes: 0,\n                shareDate: d1.toDateString()\n            }\n            ThirdAPI.saveShareData(Global.shareData.shareTimes, Global.shareData.shareDate);\n        } else if (Global.shareData.shareDate != d.toDateString()) {\n            //console.log('无今日分享限制数据，初始化');\n            Global.shareData = {\n                shareTimes: 0,\n                shareDate: d.toDateString()\n            }\n\n            ThirdAPI.saveShareData(Global.shareData.shareTimes, Global.shareData.shareDate);\n        }\n\n        //获取系统日期\n        //var d1 = new Date(Date.now());\n        //console.log(d1.toDateString());\n    },\n\n    // 存储分数到服务器\n    saveScore: function () {\n        //更新金币并存储\n        if (typeof wx !== 'undefined') {\n            let data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                //console.log('gridController on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n            });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n    },\n\n    //分享完的提示文字\n    showDialogText: function (text, p) {\n        //总开关判断\n        if (Global.cdnGameConfig.totalSwith) {\n            console.log('开关已打开，不显示文字提示');\n            return;\n        }\n        this.tipsNode.active = true;\n        this.tipsNode.setLocalZOrder(1000);\n        this.tipsNode.stopAllActions();\n        // this.tipsNode.x = p.x;\n        // this.tipsNode.y = p.y;\n        var label = this.tipsNode.getChildByName('label');\n        label.getComponent(cc.Label).string = text;\n        this.tipsNode.getChildByName(\"sprite\").width = cc.find('Canvas').width;\n\n        setTimeout(() => {\n            this.tipsNode.active = false;\n        }, 2000);\n    },\n\n    //分享完的提示文字\n    showDialogTextAlawys: function (text, p) {\n        /*\n        console.log('提示文字：', text);\n        this.tipsNode.active = true;\n        this.tipsNode.setLocalZOrder(1000);\n        this.tipsNode.stopAllActions();\n        // this.tipsNode.x = p.x;\n        // this.tipsNode.y = p.y;\n        var label = this.tipsNode.getChildByName('label');\n        label.getComponent(cc.Label).string = text;\n        this.tipsNode.getChildByName(\"sprite\").width = cc.find('Canvas').width;\n\n        setTimeout(() => {\n            this.tipsNode.active = false;\n        }, 2000);\n        */\n\n        console.log('提示文字：', text);\n        this.tipsNode.active = true;\n        this.tipsNode.setLocalZOrder(1000);\n        this.tipsNode.stopAllActions();\n        // this.tipsNode.x = p.x;\n        // this.tipsNode.y = p.y;\n        var label = this.tipsNode.getChildByName('label');\n        label.getComponent(cc.Label).string = text;\n        this.tipsNode.getChildByName(\"sprite\").width = cc.find('Canvas').width;\n\n        var self = this;\n        this.tipsNode.runAction(cc.sequence(cc.delayTime(2), cc.callFunc(function () {\n            self.tipsNode.active = false;\n        })));\n    },\n\n    //播放声音\n    playSound: function (sname, volume) {\n        if (!Global.isBGMPlaying) {\n            return;\n        }\n        var self = this;\n        cc.loader.loadRes(\"audio/\" + sname, cc.AudioClip, function (err, clip) {\n            var sound = cc.instantiate(self.btnSound);\n            self.node.addChild(sound);\n            var audioSource = sound.getComponent(cc.AudioSource);\n            audioSource.clip = clip;\n            audioSource.volume = volume;\n            audioSource.play();\n        });\n    },\n\n    //重新开始\n    restart: function () {\n        this.enterScene();\n    },\n\n    //打开游戏战斗界面\n    enterScene: function () {\n        if (!Global.gridController) {\n            Global.gridController = cc.instantiate(this.girdRoot);\n        }\n        if (Global.gridController.parent) {\n            Global.gridController.parent.removeChild(Global.gridController);\n        }\n        this.node.addChild(Global.gridController);\n        Global.gridController.getComponent(\"gridController\").initGridData();\n    },\n\n    onCloseBanner: function () {\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.hideBannerAd();\n        this.btnCloseBanner.active = false;\n    },\n});"]}