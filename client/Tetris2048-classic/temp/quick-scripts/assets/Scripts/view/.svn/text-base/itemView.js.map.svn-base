{"version":3,"sources":["itemView.js"],"names":["cc","Class","extends","Component","properties","itemSprite","default","type","Sprite","itemNum","Prefab","downAudio","url","AudioClip","num1","num2","num3","num4","numPrefab","goldPrefab","isSoonItem","bornNum","targetGrid","numInstance","goldInstance","curState","canMove","initData","randomIndex","setSpriteFrame","updateColor","updateNum","changeStateToWaitDown","speed","log","startDownForBorn","Global","gridController","getComponent","bornGrid","node","stopAllActions","forjoinaction","self","runAction","sequence","delayTime","waitToDown","callFunc","canDown","nodePos","getPosition","targetPos","cury","y","dist","pDistance","canDownNum","Math","floor","itemSize","hdx","hIndex","vdx","vIndex","firstCurH","allGrids","curH","element1","callback","callBackForJoin","actions","t","length","actiond","gridDownDelayTime","push","playTime","abs","action","moveTo","console","stopAction","myAction","startQuickDownForBorn","toRemove","parent","removeChild","targetOff","toRevive","finished","blink","getDuration","clearItemToRemove","spawnAction","spawn","rotateBy","scaleTo","skinIndex","tho","parseInt","hun","ten","uni","getSpriteNum","setVisible","x","allWidth","width","LoadAtlas","require","spriteFrame","getSpriteFrameFromName","scaleX","scaleY","spr","num","string","getRect","height","loadAtlasRes","soonItemSize","dtime","forJoin","toJoin","pos","combineTime","action1","gridDownSpeed","gridControllerScript","idx","downGrids","indexOf","splice","targetScript","item","setPosition","p","gridNum","on","itemClick","Node","EventType","TOUCH_START","touchStart","playDownAudio","evtObj","Event","EventCustom","setUserData","dispatchEvent","isBGMPlaying","combineID","audioEngine","play","setFinishCallback","playAudioEnd","playAudioStart","resume","uncache"],"mappings":"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","file":"itemView.js","sourceRoot":"../../../../../assets/Scripts/view","sourcesContent":["/*\n    1. 从itemcontroller中产生\n    2. 出生点，出生数字\n    3. 受鼠标影响\n    4. 运动停止，回调\n\n*/\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //出生item的精灵贴图\n        itemSprite: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //出生的数字\n        itemNum: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //下落声音\n        downAudio: {\n            url: cc.AudioClip,\n            default: null\n        },\n        num1: {\n            default: null,\n            type: cc.Sprite,\n        },\n        num2: {\n            default: null,\n            type: cc.Sprite,\n        },\n        num3: {\n            default: null,\n            type: cc.Sprite,\n        },\n        num4: {\n            default: null,\n            type: cc.Sprite,\n        },\n        numPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        goldPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n\n        isSoonItem: false, //是即将出现的item？\n        bornNum: 0, //出生的随机数\n        targetGrid: null, //目标格子\n        numInstance: null, //飞入分数的实例\n        goldInstance: null, //飞入分数的实例\n        curState: 0, //  1 等待下落   2 下落  3  下落完毕等待合并   4 合并\n        canMove: true,\n    },\n\n    initData: function (randomIndex, isSoonItem) {\n        this.isSoonItem = isSoonItem;\n        this.bornNum = randomIndex;\n        this.setSpriteFrame();\n    },\n\n    //根据生产的索引值来设置出生的精灵贴图\n    setSpriteFrame: function () {\n        this.updateColor();\n        this.updateNum();\n    },\n\n    //等待下落\n    changeStateToWaitDown: function (speed) {\n        cc.log(this.curState);\n        if (this.curState == 1) {\n            return;\n        }\n        if (this.curState == 3) {\n            this.startDownForBorn(speed);\n            return;\n        }\n        if (this.curState > 3) {\n            return;\n        }\n        if (Global.gridController.getComponent('gridController').bornGrid == this.node) {\n            if (this.curState > 0) {\n                this.curState = 1; //等待下落\n                this.node.stopAllActions();\n                this.forjoinaction = null;\n                let self = this;\n                this.node.runAction(cc.sequence(cc.delayTime(Global.waitToDown), cc.callFunc(function () {\n                    self.startDownForBorn(speed);\n                })));\n            }\n        }\n    },\n\n    canDown: function () {\n        var nodePos = this.node.getPosition();\n        var targetPos = this.targetGrid.getPosition();\n\n        var cury = nodePos.y;\n        var dist = cc.pDistance(nodePos, targetPos);\n        var canDownNum = Math.floor(dist / Global.itemSize);\n        var hdx = this.targetGrid.getComponent('gridView').hIndex;\n        var vdx = this.targetGrid.getComponent('gridView').vIndex;\n        var firstCurH = canDownNum <= 1 ? 0 : canDownNum;\n        var gridController = Global.gridController.getComponent(\"gridController\");\n        var allGrids = gridController.allGrids;\n        for (let curH = vdx - firstCurH; curH <= vdx; curH++) {\n            var element1 = allGrids[hdx][curH];\n            if (cury > element1.getPosition().y) {\n                return true;\n            }\n        }\n        return false;\n    },\n\n    //开始进行从出生点到最终位置的动作\n    startDownForBorn: function (speed) {\n        this.curState = 2; //下落\n\n        //this.node.stopAllActions();\n        var nodePos = this.node.getPosition();\n        var targetPos = this.targetGrid.getPosition();\n\n        var dist = cc.pDistance(nodePos, targetPos);\n        var canDownNum = Math.floor(dist / Global.itemSize);\n\n        var callback = cc.callFunc(this.callBackForJoin, this);\n\n        var hdx = this.targetGrid.getComponent('gridView').hIndex;\n        var vdx = this.targetGrid.getComponent('gridView').vIndex;\n\n        var cury = nodePos.y;\n        var actions = [];\n        var t = 0;\n        var firstCurH = canDownNum <= 1 ? 0 : canDownNum;\n        var gridController = Global.gridController.getComponent(\"gridController\");\n        var allGrids = gridController.allGrids;\n\n        for (let curH = vdx - firstCurH; curH <= vdx; curH++) {\n            if (curH == -1) {\n                continue;\n            }\n            if (actions.length > 0) {\n                var actiond = cc.delayTime(Global.gridDownDelayTime);\n                actions.push(actiond);\n                t += Global.gridDownDelayTime;\n            }\n\n            var element1 = allGrids[hdx][curH];\n            var playTime = Math.abs(cury - element1.getPosition().y) / speed;\n            if (playTime == 0) {\n                continue;\n            }\n\n            cury += element1.getPosition().y - cury;\n            t += playTime;\n            var action = cc.moveTo(playTime, element1.getPosition());\n            actions.push(action);\n        }\n\n        actions.push(callback);\n\n        //异常处理，当前节点和目标节点相等\n        cc.log(this.curState);\n        if (actions.length <= 1) {\n            console.log('处理异常');\n            if (this.forjoinaction == null) {\n                this.curState = 4;\n                this.node.runAction(callback);\n            }\n            return 0;\n        } else {\n            console.log('actions.length = 0');\n            if (this.forjoinaction != null) {\n                console.log('this.forjoinaction != null' + actions.length);\n                this.node.stopAction(this.forjoinaction);\n                this.forjoinaction = null;\n            }\n        }\n\n        //var action = cc.moveTo(playTime, targetPos);\n        var myAction = cc.sequence(actions);\n        this.node.runAction(myAction);\n        return t;\n    },\n\n    //快速下落动作\n    startQuickDownForBorn: function (speed) {\n        this.curState = 5;\n        this.node.stopAllActions();\n        var nodePos = this.node.getPosition();\n        var targetPos = this.targetGrid.getPosition();\n        var playTime = cc.pDistance(nodePos, targetPos) / speed;\n        var action = cc.moveTo(playTime, targetPos);\n        var callback = cc.callFunc(this.callBackForJoin, this);\n\n        var myAction = cc.sequence(action, callback);\n        this.node.runAction(myAction);\n        return playTime;\n    },\n/*\n    //格子合并\n    toJoin(pos) {\n        var finished = cc.callFunc(this.toRemove, this);\n        var playTime = cc.pDistance(this.node.getPosition(), pos) / Global.combineTime;\n        //合并动作\n        var action = cc.moveTo(playTime, pos);\n        var action1 = cc.delayTime(0.1);\n\n        //var seq = cc.sequence(action1,action);\n        var myAction = cc.sequence(action1, action, finished);\n        this.node.runAction(myAction);\n\n        return playTime + 0.1;\n    },*/\n\n    toRemove: function () {\n        this.node.stopAllActions();\n        if (this.node.parent) {\n            this.node.parent.removeChild(this.node);\n        }\n        this.node.targetOff(this);\n        this.curState = 0; \n    },\n\n    //复活消除多余格子\n    toRevive: function () {\n        this.node.stopAllActions();\n        var finished = cc.callFunc(this.toRemove, this);\n        var action = cc.blink(1, 2);\n        var myAction = cc.sequence(action, finished);\n        this.node.runAction(myAction);\n        return action.getDuration() + 0.01;\n    },\n\n    //消除动画\n    clearItemToRemove: function () {\n        this.node.stopAllActions();\n        //动作完成则删除节点\n        var callback = cc.callFunc(this.toRemove, this);\n        //缩放动作\n        var spawnAction = cc.spawn(cc.rotateBy(0.5, 360, 360), cc.sequence(cc.scaleTo(0.5, 0.5), cc.scaleTo(0.5, 0)));\n\n        this.node.runAction(cc.sequence(spawnAction, callback));\n        return 500;\n    },\n\n    //更新分数图集\n    updateNum: function () {\n        if (Global.skinIndex == 0) {\n            var tho = parseInt(this.bornNum / 1000);\n            var hun = parseInt((this.bornNum / 100) % 10);\n            var ten = parseInt((this.bornNum % 100) / 10);\n            var uni = parseInt(this.bornNum % 10);\n            //千位\n            if (tho > 0) {\n                this.getSpriteNum(this.num1, tho);\n            }\n            //百位\n            if (hun > 0 || tho > 0) {\n                this.getSpriteNum(this.num2, hun);\n            }\n            //十位\n            if (ten > 0 || tho > 0 || hun > 0) {\n                this.getSpriteNum(this.num3, ten);\n            }\n            //个位\n            if (uni > 0 || tho > 0 || hun > 0 || ten > 0) {\n                this.getSpriteNum(this.num4, uni);\n            }\n\n            //是否可见\n            if (tho == 0) {\n                this.num1.setVisible(false);\n            }\n            if (tho == 0 && hun == 0) {\n                this.num2.setVisible(false);\n            }\n            if (tho == 0 && hun == 0 && ten == 0) {\n                this.num3.setVisible(false);\n            }\n\n            //个位\n            if (this.bornNum > 0 && this.bornNum < 9) {\n                this.num4.node.x = 0;\n            } else if (this.bornNum >= 10 && this.bornNum < 99) {\n                var allWidth = this.num3.node.width + this.num4.node.width;\n                this.num3.node.x = -allWidth / 2 + this.num3.node.width / 2;\n                this.num4.node.x = this.num3.node.x + this.num3.node.width / 2 + this.num4.node.width / 2;\n            } else if (this.bornNum >= 100 && this.bornNum < 999) {\n                //百十个位 \n                var allWidth = this.num2.node.width + this.num3.node.width + this.num4.node.width;\n                this.num2.node.x = -allWidth / 2 + this.num2.node.width / 2;\n                this.num3.node.x = this.num2.node.x + this.num2.node.width / 2 + this.num3.node.width / 2;\n                this.num4.node.x = this.num3.node.x + this.num3.node.width / 2 + this.num4.node.width / 2;\n\n            } else if (this.bornNum >= 1000 && this.bornNum < 9999) {\n                var allWidth = this.num1.node.width + this.num2.node.width + this.num3.node.width + this.num4.node.width;\n                this.num1.node.x = -allWidth / 2 + this.num1.node.width / 2 + 6;\n                this.num2.node.x = this.num1.node.x + this.num1.node.width / 2 + this.num2.node.width / 2 - 3;\n                this.num3.node.x = this.num2.node.x + this.num2.node.width / 2 + this.num3.node.width / 2 - 3;\n                this.num4.node.x = this.num3.node.x + this.num3.node.width / 2 + this.num4.node.width / 2 - 3;\n            }\n        } else {\n            console.log('皮肤', Global.skinIndex, this.bornNum, 'skin' + (Global.skinIndex + 1) + '_' + this.bornNum);\n            var LoadAtlas = require(\"LoadAtlas\");\n            this.num4.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/skins', 'skin' + (Global.skinIndex + 1) + '_' + this.bornNum);\n            this.num4.node.scaleX = this.isSoonItem ? 0.7 : 1;\n            this.num4.node.scaleY = this.isSoonItem ? 0.7 : 1;\n        }\n    },\n\n    getSpriteNum: function (spr, num) {\n        var string = \"skin1_\" + num;\n        var LoadAtlas = require(\"LoadAtlas\");\n        var spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', num);\n        spr.spriteFrame = spriteFrame;\n        spr.node.width = spriteFrame.getRect().width; // Global.gridNumSize;\n        spr.node.height = spriteFrame.getRect().height; // Global.gridNumSize;\n        spr.node.scaleX = (this.bornNum > 999 || this.isSoonItem) ? 0.8 : 1;\n        spr.node.scaleY = (this.bornNum > 999 || this.isSoonItem) ? 0.8 : 1;\n        spr.setVisible(true);\n    },\n\n    //更新color\n    updateColor: function () {\n        var self = this;\n        var LoadAtlas = require(\"LoadAtlas\");\n        LoadAtlas.loadAtlasRes(\"textures/gridItem/items\", function () {\n            var LoadAtlas = require(\"LoadAtlas\");\n            self.itemSprite.spriteFrame = LoadAtlas.getSpriteFrameFromName(\"textures/gridItem/items\", \"color1_\" + self.bornNum);\n            var soonItemSize = Global.soonItemSize;\n            if (self.bornNum > 99) {\n                soonItemSize = 90;\n            } else if (self.bornNum > 999) {\n                soonItemSize = Global.itemSize;\n            }\n            self.itemSprite.node.width = self.isSoonItem ? soonItemSize : Global.itemSize;\n            self.itemSprite.node.height = self.isSoonItem ? soonItemSize : Global.itemSize;\n        });\n    },\n\n    //回调grid控制器的合并逻辑\n    callBackForJoin: function () {\n        if (this.curState < 3) {\n            this.curState = 3\n        }\n        let self = this;\n        let dtime = Global.forJoin;\n        if(!this.canMove){\n            dtime = dtime / 3;\n        }\n        this.forjoinaction = cc.sequence(cc.delayTime(dtime), cc.callFunc(function () {\n            self.forJoin();\n        }));\n        this.node.runAction(this.forjoinaction);\n    },\n\n      //格子合并\n      toJoin(pos) {\n        this.curState = 4; \n        var finished = cc.callFunc(this.toRemove, this);\n        var playTime = cc.pDistance(this.node.getPosition(), pos) / Global.combineTime;\n        //合并动作\n        var action = cc.moveTo(playTime, pos);\n        var action1 = cc.delayTime(0.1);\n\n        //var seq = cc.sequence(action1,action);\n        var myAction = cc.sequence(action1,action, finished);\n        this.node.runAction(myAction);\n    },\n\n    forJoin: function () {\n        console.log('forJoin');\n        //是否可以继续下降\n        if (this.canDown()) {\n            this.startDownForBorn(Global.gridDownSpeed);\n            return;\n        }\n        //删除格子\n        this.node.stopAllActions();\n        var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n        let idx = gridControllerScript.downGrids.indexOf(this.getComponent('itemView'));\n        if (idx >= 0) {\n            gridControllerScript.downGrids.splice(idx, 1);\n        }\n\n        var targetScript = this.targetGrid.getComponent('gridView');\n        targetScript.item = this;\n        this.node.setPosition(cc.p(targetScript.node.getPosition()));\n        cc.log('下落停止 item callBackForJoin ：' + targetScript.hIndex + \" :: \" + targetScript.vIndex + \"node pos X\" + this.node.x + \"  node pos Y\" + this.node.y);\n        targetScript.gridNum = this.bornNum;\n\n        //添加事件侦听\n        var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n        this.node.on(\"itemclick\", gridControllerScript.itemClick, gridControllerScript);\n        this.node.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\n\n        // }, Global.gridDownDelayTime * 1000);\n\n        this.playDownAudio();\n        this.canMove = false;\n        this.curState = 0;\n    },\n\n    touchStart: function () {\n        cc.log('itemclick');\n        var evtObj = new cc.Event.EventCustom('itemclick', true);\n        evtObj.setUserData(this.targetGrid);\n        this.node.dispatchEvent(evtObj);\n    },\n\n   \n\n    //播放落地声音\n    playDownAudio: function () {\n        cc.log('play down audio');\n        if (Global.isBGMPlaying && this.downAudio != null) {\n            this.combineID = cc.audioEngine.play(this.downAudio, false, 1);\n            //回调\n            var self = this;\n            if (self.combineID > 0) {\n                cc.audioEngine.setFinishCallback(self.combineID, function () {\n                    self.playAudioEnd();\n                });\n            }\n        }\n    },\n    //播放声音\n    playAudioStart: function () {\n        if (this.combineID != 0) {\n            cc.audioEngine.resume(this.combineID);\n        }\n    },\n    //暂停声音声音\n    playAudioEnd: function () {\n        cc.audioEngine.uncache(this.combineID);\n    },\n\n\n\n    // update (dt) {},\n});"]}