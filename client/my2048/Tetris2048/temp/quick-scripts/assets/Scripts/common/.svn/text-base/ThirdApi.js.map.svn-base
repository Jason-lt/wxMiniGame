{"version":3,"sources":["ThirdApi.js"],"names":["FBGlobal","require","WXGlobal","Platform","wx","FBInstant","initOnEnter","ThirdAPI","getRank","params","type","console","log","getFriendRank","getGroupRank","shakeShort","shakeLong","showGameClub","value","saveScore","maxscore","gold","saveFBScore","data","cc","sys","localStorage","setItem","error","loadScore","callback","result","loadLocalScore","getFBScore","storage","getItem","JSON","parse","parseInt","saveReviveData","shareTimes","date","Date","toDateString","Global","reviveTodayTimes","clearReviveData","data2","stringify","loadReviveData","removeItem","saveShareData","shareDate","loadShareData","clearShareData","clearRankData","score","unixTime","getTime","beforeClearTime","clearTime","oldTime","oldDay","getDay","todaySeconds","getHours","getMinutes","getSeconds","weekdayUnixTime","sundayUnixTime","currUnixTime","canClear","clearInfo","key","list","saveInfo","i","length","loadInfo","push","index","clearCurrentSkin","saveCurrentSkin","current","loadCurrentSkin","ret","currentSkin","isFromGroup","sendChannelPrefix","shareGame","imageurl","failcallback","sourcecode","onShareGame","saveFriendGenStoneInfo","loadFriendGenStoneInfo","clearFriendGenStoneInfo","getShareUserInfo","exitGame","exit","getSystemInfo","module","exports"],"mappings":"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","file":"ThirdApi.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["let FBGlobal = require('./fbAPI')\nlet WXGlobal = require('./wxAPI')\nlet Platform = (typeof wx !== 'undefined') ? 1 : ((typeof FBInstant !== 'undefined') ? 2 : 0)\n\nif (Platform === 1) {\n\n    WXGlobal.initOnEnter();\n\n} else {\n\n}\n\n\nlet ThirdAPI = {\n\n    getRank: function (params, type) {\n        console.log('ThirdAPI getRank', params, type);\n\n        if (Platform === 1) {\n            if (type === 'Friend') {\n                return WXGlobal.getFriendRank(params);\n            } else if (type === 'Group') {\n                return WXGlobal.getGroupRank(params);\n            }\n\n        } else if (Platform === 2) {\n            return FBGlobal.getRank(params);\n        }\n    },\n\n    shakeShort: function (params) {\n        if (Platform === 1) {\n            WXGlobal.shakeShort(params);\n        } else if (Platform === 2) {\n            console.log('FB 平台未实现震动');\n        }\n    },\n\n    shakeLong: function (params) {\n        if (Platform === 1) {\n            WXGlobal.shakeLong(params);\n        } else if (Platform === 2) {\n            console.log('FB 平台未实现震动');\n        }\n    },\n\n    showGameClub: function (value) {\n        if (Platform === 1) {\n            WXGlobal.showGameClub(value);\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    //保存分数\n    saveScore: function (maxscore, gold) {\n        console.log('ThirdAPI saveScore', maxscore, gold);\n\n        if (Platform === 1) {\n            WXGlobal.saveScore(maxscore, gold);\n        } else if (Platform === 2) {\n            FBGlobal.saveFBScore(maxscore, gold);\n        }\n        // 本地通过cocos再存储一份\n        try {\n            let data = \"{ \\\"maxscore\\\": \" + maxscore + \",\\n \\\"gold\\\": \" + gold + \"\" + \" }\"\n            console.log('try save local score', data);\n            cc.sys.localStorage.setItem(\"triline-data\", data);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //获取本地分数\n    loadScore: function (callback) {\n        if (Platform === 1) {\n            // return WXGlobal.loadScore(callback);\n            // 微信无法在主域获取用户托管数据,所以取通过cocos存储的本地数据\n            let result = this.loadLocalScore();\n            if (callback) {\n                callback(result.maxscore, result.gold);\n            }\n        } else if (Platform === 2) {\n            return FBGlobal.getFBScore(callback);\n        }\n    },\n\n    loadLocalScore: function () {\n        let result = {\n            maxscore: 0,\n            gold: 0\n        }\n        try {\n            let storage = cc.sys.localStorage.getItem('triline-data');\n            console.log('storage data : ' + storage);\n            let data = JSON.parse(storage);\n            if (data) {\n                result.maxscore = parseInt(data.maxscore);\n            }\n            if (data.gold) {\n                result.gold = parseInt(data.gold);\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    //存储复活次数\n    saveReviveData: function (shareTimes) {\n        try {\n            let storage = cc.sys.localStorage.getItem('2048-revive-data');\n            let data = JSON.parse(storage);\n            //如果本地数据\n            if (!data) {\n                data = {\n                    date: (new Date()).toDateString(),\n                    shareTimes: Global.reviveTodayTimes\n                };\n            } else {\n                if (data.date && data.date != (new Date()).toDateString()) {\n                    //删除无效数据\n                    console.log('重新保存数据：' + (new Date()).toDateString(), Global.reviveTodayTimes);\n                    this.clearReviveData();\n                    data = {\n                        date: (new Date()).toDateString(),\n                        shareTimes: Global.reviveTodayTimes\n                    };\n                } else {\n                    console.log('更新保存数据' + shareTimes);\n                    data = {\n                        date: (new Date()).toDateString(),\n                        shareTimes: shareTimes\n                    };\n                }\n            }\n            let data2 = JSON.stringify(data);\n            console.log('try save local revive', data2);\n            cc.sys.localStorage.setItem(\"2048-revive-data\", data2);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadReviveData: function () {\n        try {\n            let storage = cc.sys.localStorage.getItem('2048-revive-data');\n            console.log('revive storage data : ' + storage);\n            let data = JSON.parse(storage);\n            if (data) {\n                //判断是否是当天\n                if (data.date && data.date == (new Date()).toDateString()) {\n                    return parseInt(data.shareTimes);\n                } else {\n                    return Global.reviveTodayTimes;\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return Global.reviveTodayTimes;\n    },\n\n    //清除复活次数\n    clearReviveData: function () {\n        try {\n            cc.sys.localStorage.removeItem('triline-revive-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //复活次数存储\n    saveShareData: function (shareTimes, shareDate) {\n        try {\n            let data = {\n                shareDate: shareDate,\n                shareTimes: shareTimes\n            };\n            let data2 = JSON.stringify(data);\n            cc.sys.localStorage.setItem(\"2048-share-data\", data2);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadShareData: function () {\n        let result = {\n            shareTimes: 0,\n            shareDate: ''\n        }\n        try {\n            let storage = cc.sys.localStorage.getItem('2048-share-data');\n            if (storage) {\n                let data = JSON.parse(storage);\n                if (data) {\n                    if (data.shareDate) {\n                        result.shareDate = data.shareDate;\n                    }\n                    if (data.shareTimes) {\n                        result.shareTimes = data.shareTimes;\n                    }\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    //清除分享次数\n    clearShareData: function () {\n        try {\n            cc.sys.localStorage.removeItem('2048-share-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //清除排行榜数据\n    clearRankData: function () {\n        console.log('ThirdAPI ready clearRankData');\n        if (Platform === 1) {\n            let data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('clearRankData on ThirdAPI loadScore', score + \" :: \" + gold);\n            });\n\n            //先判断这一周是否有被清空过排行榜数据，没有数据则自动清空\n            try {\n                var unixTime = (new Date()).getTime();\n                let storage = cc.sys.localStorage.getItem('2048-rank-data');\n                if (storage) {\n                    // 有数据则判断这周是否清零过\n                    let data2 = JSON.parse(storage);\n                    var beforeClearTime = parseInt(data2.clearTime);\n                    if (beforeClearTime == 0) {\n                        console.log('清除排行的时间为0');\n                        //没有排行本地数据则分数清零\n                        cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                            clearTime: parseInt(unixTime)\n                        }));\n                        ThirdAPI.saveScore(0, gold);\n                    } else {\n                        var oldTime = new Date(beforeClearTime);\n                        var oldDay = (oldTime.getDay() == 0) ? 7 : oldTime.getDay();\n\n                        //计算当天从零点开始的秒数(小时、分钟、秒)\n                        var todaySeconds = oldTime.getHours() * 3600 + oldTime.getMinutes() * 60 + oldTime.getSeconds();\n\n                        var weekdayUnixTime = (beforeClearTime / 1000) - parseInt(oldDay - 1) * 86400 - todaySeconds;\n                        var sundayUnixTime = (beforeClearTime / 1000) + (7 - oldDay) * 86400 + (86400 - todaySeconds - 1);\n\n                        //如果这周没有清零则清一遍\n                        var currUnixTime = (new Date()).getTime();\n                        var canClear = ((parseInt(weekdayUnixTime * 1000) <= currUnixTime) && (currUnixTime <= parseInt(sundayUnixTime * 1000))) ? false : true;\n                        if (canClear) {\n                            //这一周排行榜数据没有清零\n                            console.log('新的一周可以清空排行榜数据');\n                            cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                                clearTime: parseInt(unixTime)\n                            }));\n                            ThirdAPI.saveScore(0, gold);\n                        }\n                    }\n                } else {\n                    //没有排行本地数据则分数清零\n                    cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                        clearTime: parseInt(unixTime)\n                    }));\n                    ThirdAPI.saveScore(0, gold);\n                }\n            } catch (error) {\n                console.error(error);\n            }\n        } else if (Platform === 2) {\n            //FB暂未清除排行榜\n        }\n    },\n\n    clearInfo: function (key) {\n        //console.log('ThirdAPI clearStoreInfo');\n        let list = []\n        try {\n            cc.sys.localStorage.removeItem('triline-data' + key);\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    saveInfo: function (key, list) {\n        //console.log('ThirdAPI saveStoreInfo');\n\n        // 本地通过cocos再存储一份\n        try {\n\n            let data = \"[\";\n            for (let i = 0; i < list.length; i++) {\n                if (i > 0) {\n                    data += \",\";\n                }\n                data += \"{\\\"index\\\":\\\"\" + list[i] + \"\\\"}\";\n            }\n            data += \"]\";\n            //let data = \"{ \\\"name\\\" : \\\"bob\\\", \\\"id\\\":\\\"10\\\"}\";\n            //console.log('try save local score',data);\n            cc.sys.localStorage.setItem('triline-data' + key, data);\n        } catch (error) {\n            //console.error(error);\n        }\n    },\n\n    loadInfo: function (key) {\n        //console.log('ThirdAPI loadStoreInfo');\n        let list = []\n        try {\n            let storage = cc.sys.localStorage.getItem('triline-data' + key);\n            //console.log('storage data : ' + storage);\n            let data = JSON.parse(storage);\n            //console.log('data : ', data);\n            if (data) {\n                for (let i = 0; i < data.length; i++) {\n                    list.push(data[i].index);\n                }\n                //console.log(\"the list of store data is :\", list);\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    clearCurrentSkin: function () {\n        //console.log('ThirdAPI clearStoreInfo');\n        let list = []\n        try {\n            cc.sys.localStorage.removeItem('triline-currentskin-data');\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    saveCurrentSkin: function (current) {\n        //console.log('ThirdAPI saveStoreInfo');\n\n        // 本地通过cocos再存储一份\n        try {\n            let data = \"{ \\\"currentSkin\\\": \" + current + \" }\"\n            //console.log('try save local score',data);\n            cc.sys.localStorage.setItem(\"triline-currentskin-data\", data);\n        } catch (error) {\n            //console.error(error);\n        }\n    },\n\n    loadCurrentSkin: function () {\n        //console.log('ThirdAPI loadStoreInfo');\n        let ret = 0;\n        try {\n            let storage = cc.sys.localStorage.getItem('triline-currentskin-data');\n            let data = JSON.parse(storage);\n            if (data) {\n                ret = parseInt(data.currentSkin);\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return ret;\n    },\n\n    isFromGroup: function () {\n        console.log('ThirdAPI isFromGroup');\n\n        if (Platform === 1) {\n            return WXGlobal.isFromGroup();\n        }\n        else if (Platform === 2) {\n        }\n    },\n\n    sendChannelPrefix: function (key) {\n        console.log('ThirdAPI sendChannelPrefix');\n\n        if (Platform === 1) {\n            return WXGlobal.sendChannelPrefix(key);\n        }\n        else if (Platform === 2) {\n        }\n    },\n    shareGame: function (imageurl, callback, failcallback, sourcecode) {\n        if (Platform === 1) {\n            if (callback) {\n                console.log('wx has callback');\n\n            } else {\n                console.log('wx has no callback');\n            }\n\n            // if (imageurl == 'screenshot') {\n            //     imageurl = WXGlobal.getShareScreenShot();\n            // }\n\n            WXGlobal.shareGame(imageurl, callback, failcallback, sourcecode);\n        } else if (Platform === 2) {\n            FBGlobal.onShareGame(imageurl, callback);\n        }\n    },\n\n    //加载好友索取钻石的信息\n    saveFriendGenStoneInfo: function (storage) {\n        console.log('ThirdAPI saveInfo');\n        try {\n            let data = JSON.stringify(storage);\n            console.log('try save local data', data);\n            cc.sys.localStorage.setItem('new2048-claimData', data);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadFriendGenStoneInfo: function () {\n        console.log('ThirdAPI loadInfo');\n        try {\n            let storage = cc.sys.localStorage.getItem('new2048-claimData');\n            console.log('storage data : ' + storage);\n            let data = JSON.parse(storage);\n            if (data) {\n                // result.maxscore = parseInt(data.maxscore);\n                return data;\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return null;\n    },\n\n    clearFriendGenStoneInfo: function () {\n        try {\n            cc.sys.localStorage.removeItem('new2048-claimData');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n/*\n    loadFriendGenStoneInfo: function () {\n        Global.gemStoneInfo.getTimes = 0;\n        Global.gemStoneInfo.showShareTime = new Date().getTime();\n        Global.gemStoneInfo.time = new Date().getTime();\n        try {\n            let storage = cc.sys.localStorage.getItem('new2048-claim-data');\n            if (storage) {\n                let data = JSON.parse(storage);\n                if (data) {\n                    //先判断时间是否当天，第二天重置\n                    var lastDate = 0;\n                    if (data.time) {\n                        lastDate = new Date(data.time).getDate();\n                    }\n                    if (data.time && lastDate !== new Date().getDate()) {\n                        Global.gemStoneInfo.getTimes = 0;\n                        Global.gemStoneInfo.showShareTime = new Date().getTime();\n                        Global.gemStoneInfo.time = new Date().getTime();\n\n                    } else {\n\n                    }\n\n\n\n                    if (data.getTimes) {\n                        console.log('loadFriendGenStoneInfo getTimes:' + data.getTimes);\n                        Global.gemStoneInfo.getTimes = data.getTimes;\n                    }\n                    if (data.showShareTime) {\n                        console.log('loadFriendGenStoneInfo showShareTime:' + data.showShareTime);\n                        Global.gemStoneInfo.showShareTime = data.showShareTime;\n                    }\n                    if (data.time) {\n                        console.log('loadFriendGenStoneInfo time:' + data.time);\n                        Global.gemStoneInfo.time = data.time;\n                    }\n                } else {\n                    console.log('loadFriendGenStoneInfo getTimes: not data');\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return Global.gemStoneInfo;\n    },*/\n\n    getShareUserInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getShareUserInfo()\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    exitGame: function () {\n        if (Platform === 1) {\n            return WXGlobal.exit()\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    getSystemInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getSystemInfo()\n        } else if (Platform === 2) {\n\n        }\n    }\n}\n\nmodule.exports = ThirdAPI;"]}