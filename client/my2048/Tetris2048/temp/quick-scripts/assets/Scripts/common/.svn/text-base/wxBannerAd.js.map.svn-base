{"version":3,"sources":["wxBannerAd.js"],"names":["wxBannerAd","bannerAd","bannerAdTimer","createBannerAd","console","log","wx","destroyBannerAd","sysInfo","getSystemInfoSync","isFitIphoneX","model","toLowerCase","replace","indexOf","adUnitId","style","left","top","width","show","addBannerAdTimer","onResize","res","height","realWidth","realHeight","buttomHeight","screenHeight","Global","lineHight","linePosY","screenWidth","error","hideBannerAd","hide","showBannerAd","destroy","clearTimeout","bannerAdConfig","swith","setTimeout","interval","module","exports"],"mappings":"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","file":"wxBannerAd.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["// banner广告接入\n\nlet wxBannerAd = {\n    bannerAd: null,\n    bannerAdTimer: null,\n\n    createBannerAd: function () {\n        console.log('call initBannerAd');\n\n        if (typeof wx !== 'undefined') {\n            try {\n                this.destroyBannerAd();\n                //var adheight = sysInfo.screenHeight/cc.winSize.height*( (cc.winSize.height * 0.693 + 208));\n\n                var sysInfo = wx.getSystemInfoSync();\n                // 判断是否为iphonex\n                var isFitIphoneX = (sysInfo.model.toLowerCase().replace(/\\s+/g, \"\").indexOf(\"iphonex\", 0) != -1);\n\n                this.bannerAd = wx.createBannerAd({\n                    adUnitId: 'adunit-b4b17fafcb3b6c17',\n                    style: {\n                        left: 0,\n                        top: 0,\n                        width: 300//sysInfo.screenWidth\n                    }\n                })\n\n                if (this.bannerAd) {\n\n                    this.bannerAd.show();\n                    this.addBannerAdTimer();\n\n                    this.bannerAd.onResize(res => {\n                        console.log(\"res:\", res.width, res.height)\n                        if (this.bannerAd.style) {\n                            console.log(\"real:\", this.bannerAd.style.realWidth, this.bannerAd.style.realHeight)\n\n                            /*\n                            // 适配iphoneX\n                            //var isFitIphoneX = (sysInfo.model == \"iPhone X\");//(cc.winSize.width / cc.winSize.height) <= 0.56;\n                            \n                            var fitOffsetY = isFitIphoneX ? 0.01 : 0;\n                            console.log('fitOffsetY:', fitOffsetY, isFitIphoneX);\n                            console.log('res height:', sysInfo.screenHeight, cc.winSize.height, sysInfo.screenHeight / cc.winSize.height);\n        \n                            this.bannerAd.style.left = (sysInfo.screenWidth - res.width) / 2;\n                            this.bannerAd.style.top = sysInfo.screenHeight - res.height + fitOffsetY;//- Global.bannerAdConfig.showHeight + fitOffsetY;                          \n\n                            console.log(\"top:\", this.bannerAd.style.top);\n                            */\n                            //var buttomHeight = sysInfo.screenHeight / sysInfo.pixelRatio - (Global.lineHight / 2 - Global.linePosY) / sysInfo.pixelRatio;\n                            var buttomHeight = sysInfo.screenHeight / 2 - (sysInfo.screenHeight * Global.lineHight / 568 / 2 - Global.linePosY) / 2;\n                            if (isFitIphoneX) {\n                                console.log('isIphoneX');\n                                buttomHeight -= 6;\n                            }\n                            //var buttomHeight = sysInfo.screenHeight / sysInfo.pixelRatio - (Global.lineHight / 2 - Global.linePosY) / sysInfo.pixelRatio - (sysInfo.screenHeight - 568) / 4;\n                            //var buttomHeight = sysInfo.screenHeight / sysInfo.pixelRatio - (sysInfo.screenHeight * sysInfo.pixelRatio -Math.abs(Global.lineHight)) / sysInfo.pixelRatio;\n                            //if (this.bannerAd.style.realHeight >= buttomHeight) {\n                                //console.log('重设宽度');\n                                //this.bannerAd.style.width = 300;\n\n                                //this.bannerAd.style.top = sysInfo.screenHeight - this.bannerAd.style.realHeight;\n                            //} else {\n                                // this.bannerAd.style.top = sysInfo.screenHeight - buttomHeight;\n                            //}\n\n                            console.log('buttomHeight', Global.lineHight, Global.linePosY, buttomHeight);\n                            this.bannerAd.style.left = (sysInfo.screenWidth - res.width) / 2;\n                            this.bannerAd.style.top = sysInfo.screenHeight - buttomHeight;\n                        }\n                    })\n                }\n            } catch (error) {\n                console.log(error);\n            }\n        }\n    },\n\n    hideBannerAd: function () {\n        console.log('call hideBannerAd');\n\n        try {\n            if (this.bannerAd) {\n                this.bannerAd.hide();\n            }\n        } catch (error) {\n\n        }\n    },\n\n    showBannerAd: function () {\n        console.log('call showBannerAd');\n\n        try {\n            if (this.bannerAd) {\n                this.bannerAd.show();\n            }\n        } catch (error) {\n\n        }\n    },\n\n    //销毁广告\n    destroyBannerAd: function () {\n        console.log('call destroyBannerAd');\n\n        try {\n            if (this.bannerAd) {\n                this.bannerAd.destroy();\n            }\n            clearTimeout(this.bannerAdTimer);\n            this.bannerAd = null;\n            this.bannerAdTimer = null;\n        } catch (error) {\n\n        }\n    },\n\n    //增加广告计时器\n    addBannerAdTimer: function () {\n        console.log('addBannerAdTimer');\n        if (!Global.bannerAdConfig.swith) {\n            console.log('关闭每60s刷新banner广告机制');\n            clearTimeout(this.bannerAdTimer);\n            return;\n        }\n        this.bannerAdTimer = setTimeout(() => {\n            this.createBannerAd();\n        }, Global.bannerAdConfig.interval);\n    },\n}\n\nmodule.exports = wxBannerAd;"]}