{"version":3,"sources":["../../../../../assets/Scripts/controller/assets/Scripts/controller/gridController.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","nextFriendNode","default","type","Node","nextSurFriendSprite","Sprite","gridPrefab","Prefab","rewardVideoAdBtn","successNode","gainPropName","Label","gainPropIcon","light","pauseNode","chooseNode","test_btnNode","itemPrefab","randomScore","soonGridNum","soonGridInstance","startX","startY","allGrids","bornGrid","startTouchPosition","deleteGrids","joinGrids","targetGrid","line","gemStone","goldNode","prop","nodesGroup","clearPropBtn","clearLabel","clearAdd","clearUseNumNode","clearUseNum","superPropBtn","superLabel","superAdd","superUseNumNode","superUseNum","layoutNode","guideNode","bombNode","bombSurplus","blinkSpr","clearTips","fitOffsetY","propClearTime","score","downGrids","scoreScript","isClickBomming","clickGridNum","createItemIndex","moveItemIndex","startTime","addTimes","usePropTimes","useSuperTimes","useDoubleTimes","useProp","popDialogTimes","bombShareTimes","createItemNum","createItemNum1","start","listenUtil","eventCtrl","addListen","cdnChange","bind","myUtil","isFitIphoneX","isIphoneX","setPosition","getComponent","Widget","top","console","log","setLocalZOrder","params","initGridData","listParma","allWidth","Global","hNum","itemSize","itemSplit","allHeight","vNum","screenWidth","y","reset","createAllGrid","setTouchControl","active","node","setOpacity","cdnGameConfig","string","bombRunAction","isDailyLimit","undefined","startInit","list","setShowScore","addScore","initForTimerLimit","process","updateGold","getNextFriend","director","getScheduler","schedule","setLine","canTest","label","getChildByName","testEnabled","wxBannerAd","createBannerAd","nextSpr","drawRect","x","width","height","scoreNum","that","rect","callback","entries","setTimeout","openDataContext","wx","getOpenDataContext","sharedCanvas","canvas","texture","Texture2D","initWithElement","handleLoadedTexture","sp","SpriteFrame","spriteFrame","error","unixTime","Date","getTime","today","getDayForYear","startDay","parseInt","dailyStartTime","day","Math","abs","data","self","dailyConfig","gameinfo","dailyTime","saveFriendGenStoneInfo","num","vIndex","hIndex","item","instantiate","pos","getPosition","p","initData","addChild","gridScript","gridNum","linePosY","lineHight","winSize","getWinSize","down","checkGridMerge","isDown","resetItemAction","curState","downNum","index","length","element","gridJoin","runAction","sequence","delayTime","callFunc","clearAllJoin","canJoin","findDownNum","startBianli","combineTimes","checkJoin","hightBornGrid","bornXgridNum","gameOver","createItem","isFind","actionJoin","joinComplete","isJoin","randomForArray","gridRandomScores","isShowChooseNum","createItem2","dropStone","hasGrid","push","targetPos","upGrid","upGridScript","itemScript","isStone","updateNumForProp","gridController","totalSwith","createGridNumForClear","historyMaxScore","histroyMaxScore","usePropStatus","createGridNumForSuper","updateNum","createDownGrid","onPauseGameForOther","isPropGuide","itemNumber","gridAddBox","setSoonGrid","bornXgrid","posX","posY","position","useClear","useDouble","downSpeed","gridDownSpeed","getStopPosition","targetView","startDownForBorn","nextScore","randomScores","concat","joinRandomScores","parent","setGridBox","useClearProp","clearPropNum","game","showDialogPropText","parma","randomPropInfo","limitForGame","setPropSprite","biManager","bilog","useSuperProp","superPropNum","useDoubleProp","doublePropNum","showAddPropDialogWindow","LoadAtlas","setVisible","clearParma","getSpriteFrameFromName","superParma","closeListen","off","EventType","TOUCH_START","nodeStart","TOUCH_MOVE","nodeMove","TOUCH_END","nodeEnd","createGrid","gridItem","gridView","setIndex","itemClick","event","clickGrid","getUserData","stopAllActions","scale1","scaleTo","scaleTime","clearItem","currHindex","currVindex","downtime","wxGold","costGold","loadLocalScore","maxscore","gold","loadScore","saveScore","goldLabel","onSeeAd","wxRewardVideoAd","initCreateReward","onAdSuccess","onAdFail","destroyBannerAd","find","button","playLightAction","randomIndex","randomPropCode","prop_parma","getClearPropNum","gainAddPropNum","saveClearPropNum","getSuperPropNum","saveSuperPropNum","startUI","showGold","loadAtlasRes","addPropSprite","name","closeTimer","closeSuccessNode","repeatForever","rotateBy","clickProp","resetProp","scaleBy","scale2","repeat","xBorn","yBorn","addIndex","on","getLocation","moveStartX","ceil","canMove","isPaused","moveTemp","dist","downDist","xPadding","round","moveThreshold","isUpOrDown","moveDownThreshold","isMoveGrid","isTouchDown","isMoveQuickDown","priView","maxDownTime","quickDownAction","gridQuickDownSpeed","changeStateToWaitDown","yDist","hindex","_hIndex","_vIndex","endx","soonMoveGrid","floor","vindex","isClearGrid","gridviewScript","_curitem","gridCombineDownSpeed","curtime","onPauseOrResume","playSound","resumeAllActions","pauseAllActions","isShow","hidePropTipsNode","onRestart","removeChild","restart","goMainScene","startGame","resume","onShareGame","FBInstant","shareGame","getImgBase64","goldNum","addGold","updateRedDot","rotation","onBombShare","useBomb","pauseInterval","onBombShareSuccess","onBombShareFail","onStartBomb","onBombAdFail","openGId","bombShareSuccess","showDialogText","shareData1","arrOpenGId","indexOf","needBombIndex","grid","blinkPos","myAction","fadeTo","actions","time","itemViewScript","clearTime","currBornXGridNum","msg","clearGameProgressInfo","unschedule","reviveShareTimes","loadReviveData","reviveTimes","reviveTotalTimes","showReviveWindow","showShareWindow","clearGridForRevive","clearVNum","toRevive","flyNumPools","finished","reviveSuccess","toRemove","randomForWeight","weightConfig","oneWeightRate","oneTotalWeight"],"mappings":"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","file":"gridController.js","sourceRoot":"../../../../../assets/Scripts/controller","sourcesContent":["var ThirdAPI = require('../common/ThirdAPI')\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //\n        nextFriendNode: {\n            default: null,\n            type: cc.Node,\n        },\n        //\n        nextSurFriendSprite: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        gridPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        //\n        rewardVideoAdBtn: {\n            default: null,\n            type: cc.Node\n        },\n\n        successNode:cc.Node,\n        gainPropName: {\n            default: null,\n            type: cc.Label,\n        },\n        gainPropIcon: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        light: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        pauseNode: {\n            default: null,\n            type: cc.Node\n        },\n        chooseNode: {\n            default: null,\n            type: cc.Node\n        },\n        test_btnNode: {\n            default: null,\n            type: cc.Node\n        },\n\n        //item\n        itemPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n\n        //\n        randomScore: 0,\n        //\n        soonGridNum: {\n            default: null,\n            type: cc.Prefab,\n        },\n        soonGridInstance: null,\n\n        startX: 0,\n        startY: 0,\n        //\n        allGrids: [],\n        //\n        bornGrid: null,\n        //\n        startTouchPosition: null,\n\n        //\n        deleteGrids: [],\n        joinGrids: [],\n        //\n        targetGrid: {\n            default: null,\n            type: cc.Node\n        },\n\n        line: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        //\n        gemStone: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        //\n        goldNode: {\n            default: null,\n            type: cc.Node\n        },\n        prop: {\n            default: null,\n            type: cc.Node\n        },\n        nodesGroup: {\n            default: null,\n            type: cc.Node,\n        },\n        //\n        clearPropBtn: {\n            default: null,\n            type: cc.Sprite,\n        },\n        clearLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        clearAdd: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //\n        clearUseNumNode: {\n            default: null,\n            type: cc.Node\n        },\n        clearUseNum: {\n            default: null,\n            type: cc.Label,\n        },\n        //\n        superPropBtn: {\n            default: null,\n            type: cc.Sprite,\n        },\n        superLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        superAdd: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //\n        superUseNumNode: {\n            default: null,\n            type: cc.Node\n        },\n        superUseNum: {\n            default: null,\n            type: cc.Label,\n        },\n\n        layoutNode: {\n            default: null,\n            type: cc.Node,\n        },\n        guideNode: {\n            default: null,\n            type: cc.Node,\n        },\n        bombNode: {\n            default: null,\n            type: cc.Node\n        },\n        bombSurplus: {\n            default: null,\n            type: cc.Label,\n        },\n        blinkSpr: {\n            default: null,\n            type: cc.Sprite,\n        },\n        clearTips: {\n            default: null,\n            type: cc.Node\n        },\n        fitOffsetY: 0,\n        propClearTime: 0, //\n\n        //\n        score: {\n            default: null,\n            type: cc.Node,\n        },\n        //\n        downGrids: [],\n\n        scoreScript: null,\n        isClickBomming: false,\n        clickGridNum: 0, //\n        createItemIndex: 0,\n        moveItemIndex: 0,\n\n        startTime: 0, //\n        addTimes: 0, //\n\n        usePropTimes: 0, //\n        useSuperTimes: 0, //\n        useDoubleTimes: 0, //\n        useProp: -1, //\n\n        //\n        popDialogTimes: 0,\n        bombShareTimes: 0, //\n\n        createItemNum: 0, //\n        createItemNum1: 0, //\n    },\n\n    start: function () {\n        listenUtil.eventCtrl.addListen('cdnchange', this.cdnChange.bind(this));\n        // \n        //var isFitIphoneX = cc.winSize.width / cc.winSize.height < 0.50;\n        var myUtil = require('myUtil');\n        var isFitIphoneX = myUtil.isIphoneX();\n        this.fitOffsetY = 0;\n        if (isFitIphoneX) {\n            this.fitOffsetY = 40;\n            this.nodesGroup.setPosition(0, -this.fitOffsetY);\n            this.nodesGroup.getComponent(cc.Widget).top = this.fitOffsetY;\n            console.log('widght:', this.fitOffsetY);\n\n            // this.layoutNode.getPosition().y += 30;\n            // this.layoutNode.getComponent(cc.Widget).top += 30;\n\n            this.layoutNode.setLocalZOrder(1000);\n        }\n    },\n\n    cdnChange: function (params) {\n        console.log('cdn');\n        // this.layoutNode.active = Global.cdnGameConfig.totalSwith;\n    },\n\n    initGridData: function (listParma) {\n        // \n        //var isFitIphoneX = cc.winSize.width / cc.winSize.height < 0.50;\n        var myUtil = require('myUtil');\n        var isFitIphoneX = myUtil.isIphoneX();\n\n        this.fitOffsetY = 0;\n        if (isFitIphoneX) {\n            this.fitOffsetY = 40;\n            //this.nodesGroup.setPosition(0, -this.fitOffsetY);\n            //this.nodesGroup.getComponent(cc.Widget).top = this.fitOffsetY;\n        }\n\n        //\n        var allWidth = Global.hNum * Global.itemSize + (Global.hNum - 1) * Global.itemSplit;\n        var allHeight = Global.vNum * Global.itemSize + (Global.vNum - 1) * Global.itemSplit;\n\n        this.startX = -(Global.screenWidth / 2) + (Global.screenWidth - allWidth) / 2 + Global.itemSize / 2;\n        this.startY = 328 - this.fitOffsetY; //-(Global.screenHeight / 2) + Global.paddingButtom + allHeight - Global.itemSize + 30 - this.fitOffsetY; \n        this.rewardVideoAdBtn.y = this.startY - 6 * Global.itemSize - 6 * Global.itemSplit + 100;\n        this.scoreScript = this.score.getComponent(\"score\");\n\n        //\n        this.reset();\n\n        //\n        this.createAllGrid();\n        //\n        this.setTouchControl();\n        //\n        this.guideNode.active = true;\n        //\n        this.blinkSpr.node.setOpacity(0);\n        this.bombNode.active = (this.bombShareTimes < Global.cdnGameConfig.bombShareTimes) ? true : false;\n        this.bombSurplus.string = Global.cdnGameConfig.bombShareTimes - this.bombShareTimes;\n        this.bombRunAction();\n        //\n        if (Global.isDailyLimit || listParma != undefined) {\n            if (listParma != undefined) {\n                this.startInit(listParma.list);\n                // this.scoreScript.addScore(listParma.score);\n                this.scoreScript.setShowScore(listParma.score);\n                this.scoreScript.addScore(listParma.score);\n            } else {\n                this.initForTimerLimit();\n            }\n\n        } else {\n            //\n            this.process();\n        }\n\n        if (!Global.myUtil) {\n            Global.myUtil = require('myUtil');\n        }\n\n        //\n        this.updateGold();\n        //\n        this.nextFriendNode.active = !Global.isDailyLimit;\n        this.getNextFriend();\n        cc.director.getScheduler().schedule(this.getNextFriend, this, 1, false);\n\n        this.setLine(allWidth, allHeight);\n        this.pauseNode.active = false;\n        this.chooseNode.active = false;\n        this.clearTips.active = false;\n\n        // this.layoutNode.active = Global.cdnGameConfig.totalSwith;\n        this.test_btnNode.active = Global.canTest;\n        if (Global.canTest) {\n            var label = this.test_btnNode.getChildByName('Label');\n            label.getComponent(cc.Label).string = ' ' + (Global.testEnabled ? '' : '');\n        }\n\n\n\n        //\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n\n        this.rewardVideoAdBtn.setLocalZOrder(1000);\n        this.successNode.setLocalZOrder(1000);\n    },\n\n    getNextFriend: function () {\n        //console.log(\"\", this.scoreScript.scoreNum);\n        var nextSpr = this.nextSurFriendSprite;\n        // this.drawRect = {\n        //     x: 0,\n        //     y: 0,\n        //     width: this.nextFriendSp.node.width,\n        //     height: this.nextFriendSp.node.height\n        // };\n        var drawRect = {\n            x: 0,\n            y: 0,\n            width: this.nextSurFriendSprite.node.width,\n            height: this.nextSurFriendSprite.node.height\n        };\n        var scoreNum = this.scoreScript.scoreNum;\n        // var nextSpr = this.nextFriendSp;\n        var that = this;\n        ThirdAPI.getNextFriend({\n            rect: drawRect,\n            score: scoreNum,\n            callback: function(entries) {\n                //console.log('');\n                setTimeout(function(){\n                    try {\n                        var openDataContext = wx.getOpenDataContext();\n                        var sharedCanvas = openDataContext.canvas;\n                        var texture = new cc.Texture2D();\n                        texture.initWithElement(sharedCanvas);\n                        texture.handleLoadedTexture();\n                        var sp = new cc.SpriteFrame(texture);\n                        nextSpr.spriteFrame = sp;\n                    } catch (error) {\n                        // console.log(\"file = [gridController] fun = [getNextFriend] error = \",error);\n                    }\n                }, 500);\n            }\n        });\n    },\n\n    //\n    initForTimerLimit: function () {\n        //\n        var myUtil = require('myUtil');\n        var unixTime = (new Date()).getTime();\n        var today = myUtil.getDayForYear(unixTime);\n        var startDay = myUtil.getDayForYear(parseInt(Global.cdnGameConfig.dailyStartTime) * 1000);\n        var day = Math.abs(today - startDay);\n        this.data = null;\n        var self = this;\n        console.log('today:' + today, \"startDay:\" + startDay);\n        if (Global.dailyConfig && !Global.dailyConfig[day]) {\n            console.log('jsonjson');\n            self.data = Global.dailyConfig[0];\n        } else {\n            console.log('json' + day + \"\");\n            self.data = Global.dailyConfig[day];\n        }\n        Global.gameinfo.dailyTime = (new Date()).getTime();\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n\n        self.startInit(self.data);\n        console.log(self.data);\n    },\n\n    startInit: function (data) {\n        var num = 0;\n        for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n            for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                if (parseInt(data[num]) > 0) {\n                    var item = cc.instantiate(this.itemPrefab);\n                    //\n                    var pos = this.allGrids[hIndex][vIndex].getPosition();\n                    item.setPosition(cc.p(pos.x, pos.y));\n                    item.getComponent('itemView').initData(data[num], false);\n                    this.node.addChild(item);\n                    var gridScript = this.allGrids[hIndex][vIndex].getComponent('gridView');\n                    gridScript.item = item.getComponent('itemView');\n                    gridScript.gridNum = data[num];\n                }\n                num++;\n            }\n        }\n        this.guideNode.active = false;\n        this.process();\n    },\n\n    //\n    setLine: function (width, height) {\n        this.line.node.width = width + 20;\n        this.line.node.height = height + 20;\n        var linePosY = height / 2 - this.startY - Global.itemSize / 2;\n        this.line.node.setPosition(cc.p(0, -linePosY));\n\n        //Global.lineHight = 0 - 430 - this.fitOffsetY - Global.itemSize / 2 - height;\n        Global.lineHight = this.line.node.height;\n\n        //Global.lineHight = this.line.node.height;\n        Global.linePosY = -linePosY;\n        console.log('line:', -linePosY, this.line.node.height, cc.winSize.width, cc.winSize.height, cc.director.getWinSize());\n    },\n\n    process: function () {\n        //1.\n        this.down();\n        //\n        this.checkGridMerge();\n    },\n\n    //\n    down: function () {\n        this.isDown = false;\n        this.downGrids = [];\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                if (this.resetItemAction(hIndex, vIndex, false)) {\n                    this.isDown = true;\n                }\n            }\n        }\n\n        if (this.bornGrid && this.bornGrid.getComponent('itemView').curState > 0) {\n            this.isDown = true;\n        }\n    },\n\n    checkGridMerge: function () {\n        var self = this;\n        var downNum = 0;\n        // for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n        //     for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n        //         var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n        //         if (gridScript.item && gridScript.item.getComponent('itemView').curState > 0) {\n        //             downNum++;\n        //         }\n        //     }\n        // }\n        for (var index = 0; index < this.downGrids.length; index++) {\n            const element = this.downGrids[index];\n            if (element.curState > 0) {\n                downNum++;\n            }\n        }\n        if (this.bornGrid != null && this.bornGrid.getComponent('itemView').curState > 0) {\n            downNum++;\n        }\n        if ((this.bornGrid == null || this.bornGrid.getComponent('itemView').curState == 0) && downNum == 0) {\n            this.gridJoin();\n        } else {\n            this.node.runAction(cc.sequence(cc.delayTime(0.5), cc.callFunc(function () {\n                self.checkGridMerge();\n            })));\n        }\n\n        //this.gridJoin();\n    },\n\n    gridJoin: function () {\n        var self = this;\n        //2.\n        //self.bornGrid = null;\n\n        //\n        if (self.clickGridNum > 0) {\n            self.process();\n            self.clickGridNum = 0;\n            return;\n        }\n\n        self.clearAllJoin();\n\n        var canJoin = false;\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n                if (!self.findDownNum() || (self.findDownNum() && gridScript.isDown)) {\n                    //\n                    if (gridScript.startBianli()) {\n                        canJoin = true;\n                    }\n                }\n            }\n        }\n\n        if (canJoin) {\n            Global.combineTimes++;\n            console.log(',combineTimes:' + Global.combineTimes);\n            this.bornGrid = null;\n            this.checkJoin();\n        } else {\n            var hightBornGrid = self.allGrids[Global.bornXgridNum][0];\n            if (hightBornGrid.getComponent('gridView').item != null && !self.isDown) {\n                //gameover\n                var self = this;\n                self.node.runAction(cc.sequence(cc.delayTime(0.5), cc.callFunc(function () {\n                    self.gameOver();\n                })));\n                return;\n            }\n            if (!self.isDown) {\n                Global.combineTimes = 0;\n                self.bornGrid = null;\n                self.createItem();\n            } else {\n                self.process();\n            }\n        }\n    },\n\n    //\n    checkJoin: function () {\n        console.log('');\n        var self = this;\n        self.node.runAction(cc.sequence(cc.delayTime(0.1), cc.callFunc(function () {\n            var isFind = false;\n            for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                    var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n                    if (gridScript.actionJoin) {\n                        isFind = true;\n                        break;\n                    }\n                }\n            }\n            if (!isFind) {\n                console.log('');\n                self.joinComplete();\n            } else {\n                console.log('2222');\n                self.checkJoin();\n            }\n        })));\n    },\n\n    joinComplete: function () {\n        var self = this;\n        //\n        var hightBornGrid = self.allGrids[Global.bornXgridNum][0];\n        if (hightBornGrid.getComponent('gridView').item != null) {\n            //isDownisDown\n            //item\n            self.isDown = true;\n        }\n        self.gridJoin();\n    },\n\n    findDownNum: function () {\n        var self = this;\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n                if (gridScript.isDown) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    //\n    clearAllJoin: function () {\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var gridScript = this.allGrids[hIndex][vIndex].getComponent('gridView');\n                gridScript.isJoin = false;\n            }\n        }\n    },\n\n    //item\n    createItem: function () {\n        //\n        //this.dropStone();\n\n        var myUtil = require(\"myUtil\");\n        if (this.randomScore == 0) {\n            this.randomScore = myUtil.randomForArray(Global.gridRandomScores);\n        }\n\n        if (Global.testEnabled) {\n            this.isShowChooseNum(true);\n        } else {\n            this.createItem2();\n        }\n    },\n\n    //()\n    dropStone: function () {\n        //\n\n\n        //,\n        var list = []; //[[0,1],[2,4],[hIndex,vIndex]]\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            var hasGrid = false;\n            for (var vIndex = Global.vNum - 1; vIndex >= 0; vIndex--) {\n                var gridScript = this.allGrids[hIndex][vIndex].getComponent('gridView');\n                if (gridScript.item != null) {\n                    hasGrid = true;\n                } else {\n                    if (hasGrid) {\n                        list.push([hIndex, vIndex]);\n                        break;\n                    }\n                }\n\n\n                /*\n                                if (hasGrid && gridScript.item == null) {\n                                    list.push([hIndex, vIndex]);\n                                    break;\n                                } else {\n                                    //\n                                    hasGrid = true;\n                                }*/\n            }\n        }\n        console.log('list:', list);\n        if (list.length <= 0) return;\n\n        //\n        var myUtil = require('myUtil');\n        var targetPos = myUtil.randomForArray(list);\n        var hIndex = targetPos[0];\n        var vIndex = targetPos[1];\n\n\n\n        /*\n                //\n                if (vIndex >= Global.vNum) {\n                    return;\n                }\n                var upGrid = this.allGrids[hIndex][vIndex];\n                if (!upGrid) return;\n                var upGridScript = upGrid.getComponent(\"gridView\");\n\n                //item\n                if (upGridScript.item !== null) {\n                    return;\n                }*/\n        var upGrid = this.allGrids[hIndex][vIndex];\n        var upGridScript = upGrid.getComponent(\"gridView\");\n        //item\n        var item = cc.instantiate(this.itemPrefab);\n        //\n        item.setPosition(upGrid.getPosition());\n        var itemScript = item.getComponent('itemView');\n        itemScript.isStone = true;\n\n        itemScript.initData(0, false);\n        itemScript.updateNumForProp();\n\n        Global.gridController.addChild(item);\n        upGridScript.item = itemScript;\n\n        //var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n\n        //itemScript.targetGrid = this.allGrids[hIndex][vIndex];\n        //Global.candropProp = false;\n    },\n\n    createItem2: function () {\n        this.createItemNum++;\n        this.createItemNum1++;\n        \n        if (this.useProp != -1 || (!Global.isDailyLimit && Global.cdnGameConfig.totalSwith && this.createItemNum == parseInt(Global.cdnGameConfig.createGridNumForClear) && Global.historyMaxScore <= parseInt(Global.cdnGameConfig.histroyMaxScore))) {\n            console.log('', this.useProp);\n            Global.usePropStatus = this.createItemNum == Global.cdnGameConfig.createGridNumForClear ? 0 : this.useProp;\n        } else {\n            Global.usePropStatus = -1;\n        }\n        this.useProp = -1;\n\n        //\n        if (!Global.isDailyLimit && Global.cdnGameConfig.totalSwith && Global.historyMaxScore <= parseInt(Global.cdnGameConfig.histroyMaxScore) &&\n            (this.createItemNum == (parseInt(Global.cdnGameConfig.createGridNumForClear) - 1) ||\n                this.createItemNum == parseInt(Global.cdnGameConfig.createGridNumForClear) ||\n                this.createItemNum == (parseInt(Global.cdnGameConfig.createGridNumForSuper) - 1) ||\n                this.createItemNum == parseInt(Global.cdnGameConfig.createGridNumForSuper))) {\n\n\n            if (this.createItemNum == (Global.cdnGameConfig.createGridNumForClear - 1)) {\n                this.soonGridInstance.getComponent(\"itemView\").updateNum(0);\n                this.createDownGrid();\n            } else if (this.createItemNum == Global.cdnGameConfig.createGridNumForClear) {\n                this.onPauseGameForOther();\n                this.clearTips.active = true;\n                this.clearTips.setLocalZOrder(20);\n            } else if (this.createItemNum == (Global.cdnGameConfig.createGridNumForSuper - 1)) {\n                this.soonGridInstance.getComponent(\"itemView\").updateNum(1);\n                this.createDownGrid();\n            } else if (this.createItemNum == Global.cdnGameConfig.createGridNumForSuper) {\n                Global.isPropGuide = true;\n                this.isShowChooseNum(true);\n\n            }\n        } else {\n            var itemNumber = 0;\n            if(Global.cdnGameConfig && Global.cdnGameConfig.itemNumber) {\n                itemNumber = Global.cdnGameConfig.itemNumber;\n                if (Global.cdnGameConfig && Global.cdnGameConfig.gridAddBox){\n                    if (this.createItemNum >= itemNumber &&(this.createItemNum-itemNumber) % Global.cdnGameConfig.gridAddBox == 0){\n                        //\n                        if (this.soonGridInstance) {\n                            Global.usePropStatus = 6;\n                            // this.soonGridInstance.getComponent(\"itemView\").setGridBox();\n                        }\n                    }\n\n                }\n            }\n\n            this.createDownGrid();\n            this.setSoonGrid();\n            this.process();\n            this.createItemIndex++;\n            Global.isPropGuide = false;\n        }\n    },\n\n    createDownGrid: function () {\n        var item = cc.instantiate(this.itemPrefab);\n        //\n        var bornXgrid = this.allGrids[Global.bornXgridNum][0];\n        var posX = 0;\n        var posY = this.startY;\n        if (bornXgrid) {\n            var position = bornXgrid.getPosition();\n            posX = position.x;\n            posY = position.y;\n        }\n        item.setPosition(cc.p(posX, posY + Global.itemSize));\n\n        item.getComponent('itemView').initData(this.randomScore, false);\n        item.getComponent('itemView').updateNumForProp();\n        if (Global.usePropStatus == 0) {\n            console.log('');\n            item.getComponent('itemView').useClear = true;\n        } else if (Global.usePropStatus == 2) {\n            console.log('');\n            item.getComponent('itemView').useDouble = true;\n        }\n        this.node.addChild(item);\n\n        this.bornGrid = item;\n\n        var downSpeed = Global.gridDownSpeed;\n        var downNum = this.getStopPosition(Global.bornXgridNum, 0);\n        var targetView = this.allGrids[Global.bornXgridNum][downNum];\n\n        this.bornGrid.getComponent('itemView').targetGrid = targetView;\n\n        item.getComponent('itemView').startDownForBorn(downSpeed);\n\n        //\n        // this.createItemNum++;\n\n        /* this.setSoonGrid();\n         this.process();\n         this.createItemIndex++;*/\n    },\n\n    //\n    setSoonGrid: function (nextScore) {\n        if (nextScore !== undefined) {\n            this.randomScore = nextScore;\n        } else {\n            var myUtil = require(\"myUtil\");\n            var randomScores = Global.gridRandomScores.concat(Global.joinRandomScores);\n            this.randomScore = myUtil.randomForArray(randomScores);\n        }\n\n        if (!this.soonGridInstance || (this.soonGridInstance && !this.soonGridInstance.parent)) {\n            this.soonGridInstance = cc.instantiate(this.soonGridNum);\n            this.node.addChild(this.soonGridInstance);\n        }\n        this.soonGridInstance.setPosition(0, 430 - this.fitOffsetY);\n        this.soonGridInstance.getComponent(\"itemView\").initData(this.randomScore, true);\n\n        var itemNumber = 0;\n        if(Global.cdnGameConfig && Global.cdnGameConfig.itemNumber) {\n            itemNumber = Global.cdnGameConfig.itemNumber;\n            if (Global.cdnGameConfig && Global.cdnGameConfig.gridAddBox){\n                if ((this.createItemNum+1) >= itemNumber &&(this.createItemNum-itemNumber+1) % Global.cdnGameConfig.gridAddBox == 0){\n                    //\n                    this.soonGridInstance.getComponent(\"itemView\").setGridBox();\n                }\n\n            }\n        }\n        // if (Global.cdnGameConfig && Global.cdnGameConfig.gridAddBox){\n        //     if(Global.cdnGameConfig && Global.cdnGameConfig.itemNumber) {\n        //         if ((this.createItemNum+1) > Global.cdnGameConfig.itemNumber && (this.createItemNum+1) % Global.cdnGameConfig.gridAddBox == 0){\n        //             //\n        //             this.soonGridInstance.getComponent(\"itemView\").setGridBox();\n        //         }\n        //     }\n        //\n        // }\n    },\n\n    useClearProp: function () {\n        //\n        if (Global.gameinfo.clearPropNum <= 0) {\n            Global.game.showDialogPropText('');\n            // console.log('');\n            // var parma = {\n            //     'parmaIndex': 0\n            // };\n            // Global.game.showAddPropDialog(parma);\n            //Global.game.showPropDialog(false, \"\", 0);\n            return;\n        }\n        var parma = Global.randomPropInfo[0];\n        if (parma && this.usePropTimes >= parma.limitForGame) {\n            Global.game.showDialogPropText('' + parma.limitForGame + '');\n            return;\n        }\n        Global.gameinfo.clearPropNum--;\n        this.usePropTimes++;\n        this.useProp = 0;\n        //\n        this.setPropSprite();\n        if (this.soonGridInstance) {\n            this.soonGridInstance.getComponent(\"itemView\").updateNum(0);\n        }\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n\n        //\n        var biManager = require('biManager');\n        biManager.bilog(biManager.useClearProp, null);\n    },\n\n    //\n    useSuperProp: function () {\n        console.log('aaa:', Global.usePropStatus, this.useProp);\n\n        if (this.useProp == 1) {\n            Global.game.showDialogPropText('');\n            return;\n        }\n\n        if (Global.gameinfo.superPropNum <= 0) {\n            Global.game.showDialogPropText('');\n            //console.log('');\n            // Global.game.showAddPropDialog({\n            //     'parmaIndex': 1\n            // });\n            //Global.game.showPropDialog(false, \"\", 1);\n            return;\n        }\n        var parma = Global.randomPropInfo[1];\n        if (parma && this.useSuperTimes >= parma.limitForGame) {\n            Global.game.showDialogPropText('' + parma.limitForGame + '');\n            return;\n        }\n        this.isShowChooseNum(true);\n        // this.useSuperTimes++;\n        // Global.gameinfo.superPropNum--;\n        //this.useProp = 1;\n        // this.setPropSprite();\n        // this.soonGridInstance.getComponent(\"itemView\").updateNum(1);\n        // ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n    },\n\n    //\n    useDoubleProp: function () {\n        Global.game.showDialogPropText('...');\n        return;\n        //\n        if (Global.gameinfo.doublePropNum <= 0) {\n            Global.game.showAddPropDialogWindow({\n                'parmaIndex': 2\n            });\n            return;\n        }\n        var parma = Global.randomPropInfo[2];\n        if (parma && this.useDoubleTimes >= parma.limitForGame) {\n            Global.game.showDialogPropText('' + parma.limitForGame + '');\n            return;\n        }\n        this.useDoubleTimes++;\n        Global.gameinfo.doublePropNum--;\n        this.useProp = 2;\n        this.setPropSprite();\n        if (this.soonGridInstance) {\n            this.soonGridInstance.getComponent(\"itemView\").updateNum(2);\n        }\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n    },\n\n    setPropSprite: function () {\n        var LoadAtlas = require(\"LoadAtlas\");\n        //\n        this.clearAdd.setVisible(false);\n        this.clearUseNumNode.active = false;\n        var clearParma = Global.randomPropInfo[0];\n        if (clearParma && this.usePropTimes >= clearParma.limitForGame) {\n            this.clearPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'clear_spr1');\n            //this.clearUseNumNode.active = false;\n        } else {\n            this.clearPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'clear_spr');\n            //\n            //this.clearUseNumNode.active = true;\n            if (clearParma) {\n                this.clearUseNum.string = clearParma.limitForGame - this.usePropTimes;\n            }\n        }\n        if (Global.gameinfo.clearPropNum > 0) {\n            this.clearLabel.string = Global.gameinfo.clearPropNum;\n            //this.clearAdd.setVisible(false);\n        } else {\n            this.clearLabel.string = '0';\n            //this.clearAdd.setVisible(true);\n        }\n\n        //\n        this.superUseNumNode.active = false;\n        var superParma = Global.randomPropInfo[1];\n        if (superParma && this.useSuperTimes >= superParma.limitForGame) {\n            this.superPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'super_spr1');\n            //this.superUseNumNode.active = false;\n        } else {\n            this.superPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'super_spr');\n            //this.superUseNumNode.active = true;\n            if (superParma) {\n                this.superUseNum.string = superParma.limitForGame - this.useSuperTimes;\n            }\n        }\n        this.superAdd.setVisible(false);\n        if (Global.gameinfo.superPropNum > 0) {\n            this.superLabel.string = Global.gameinfo.superPropNum;\n            //this.superAdd.setVisible(false);\n        } else {\n            this.superLabel.string = '0';\n            //this.superAdd.setVisible(true);\n        }\n        //this.superLabel.string = ' x' + Global.gameinfo.superPropNum;\n\n        //\n        // var doubleParma = Global.randomPropInfo[2];\n        // if (doubleParma && this.useDoubleTimes >= doubleParma.limitForGame) {\n        //     this.doublePropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'double_spr1');\n        // } else {\n        //     this.doublePropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'double_spr');\n        // }\n        // this.doubleLabel.string = '';\n    },\n\n    //\n    testEnabled: function () {\n        /* Global.testEnabled = !Global.testEnabled;\n         var btn_node = this.node.getChildByName('test_btn');\n         if (btn_node) {\n             var label = btn_node.getChildByName('Label');\n             label.getComponent(cc.Label).string = ' ' + (Global.testEnabled ? '' : '');\n         }*/\n\n    },\n\n    //\n    closeListen: function () {\n        //\n        this.node.off(cc.Node.EventType.TOUCH_START, this.nodeStart, this);\n        //\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.nodeMove, this);\n        //\n        this.node.off(cc.Node.EventType.TOUCH_END, this.nodeEnd, this);\n    },\n\n    createAllGrid: function () {\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var parma = {\n                    hIndex: hIndex,\n                    vIndex: vIndex,\n                };\n                if (!this.allGrids[hIndex]) {\n                    this.allGrids[hIndex] = [];\n                }\n                this.allGrids[hIndex][vIndex] = this.createGrid(parma);\n            }\n        }\n    },\n\n    //\n    createGrid: function (parma) {\n        //\n        var hIndex = parma.hIndex;\n        var vIndex = parma.vIndex;\n        var posX = this.startX + hIndex * Global.itemSize + hIndex * Global.itemSplit;\n        var posY = this.startY - vIndex * Global.itemSize - vIndex * Global.itemSplit;\n\n        //\n        var gridItem = cc.instantiate(this.gridPrefab);\n        gridItem.setPosition(cc.p(posX, posY));\n\n        gridItem.setLocalZOrder(20);\n\n        //\n        var gridView = gridItem.getComponent(\"gridView\");\n        gridView.node.setPosition(posX, posY);\n        gridView.setIndex(hIndex, vIndex, this);\n        this.node.addChild(gridItem);\n        return gridItem;\n    },\n\n    itemClick: function (event) {\n        var self = this;\n        if (!self.isClickBomming) {\n            return;\n        }\n        if (this.clickGridNum >= 1) {\n            return;\n        }\n        var clickGrid = event.getUserData();\n        self.clickGrid = clickGrid;\n\n        //\n        this.prop.stopAllActions();\n        var scale1 = cc.scaleTo(0.1, 1, 1);\n        this.prop.runAction(scale1);\n\n        //\n        // if (this.bornGrid) {\n        //     this.bornGrid.pauseAllActions();\n        // }\n        //this.node.stopAllActions();\n\n        //\n        var scaleTime = this.clickGrid.getComponent('gridView').item.getComponent(\"itemView\").clearItem();\n        this.clickGrid.getComponent('gridView').item = null;\n        //\n        var currHindex = this.clickGrid.getComponent('gridView').hIndex;\n        var currVindex = this.clickGrid.getComponent('gridView').vIndex;\n        for (var vIndex = currVindex - 1; vIndex > 0; vIndex--) {\n            var downtime = this.resetItemAction(currHindex, vIndex, true);\n        }\n\n        this.clickGridNum++;\n        this.isClickBomming = false;\n        //\n        Global.wxGold -= Global.costGold;\n        //\n        if (typeof wx !== 'undefined') {\n            var data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('gridController on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n            });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n        //\n        var goldLabel = this.goldNode.getChildByName('label');\n        goldLabel.getComponent(cc.Label).string = Global.wxGold;\n\n\n        //console.log('scaleTime:' + scaleTime);\n        //()\n        // this.node.stopAllActions();\n        // this.node.runAction(cc.sequence(cc.delayTime(scaleTime / 1000), cc.callFunc(self.process, self)));\n    },\n\n    //\n    onSeeAd: function () {\n        this.onPauseGameForOther();\n        var wxRewardVideoAd = require('wxRewardVideoAd');\n        wxRewardVideoAd.initCreateReward(this.onAdSuccess.bind(this), this.onAdFail.bind(this));\n        //banner\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n    },\n\n    //\n    onAdSuccess: function () {\n        //\n        var canvas = cc.find('Canvas');\n        var button = this.successNode.getChildByName('button');\n        if (button) {\n            button.width = canvas.width;\n            button.width = canvas.width;\n        }\n        this.playLightAction();\n        this.successNode.active = true;\n        var myUtil = require('myUtil');\n        var randomIndex = myUtil.randomForArray(Global.randomPropCode);\n        var prop_parma = Global.randomPropInfo[randomIndex];\n\n        //\n        if (prop_parma) {\n            if (randomIndex == 0) {\n                Global.gameinfo.clearPropNum = ThirdAPI.getClearPropNum();\n                Global.gameinfo.clearPropNum += parseInt(prop_parma.gainAddPropNum);\n                ThirdAPI.saveClearPropNum(Global.gameinfo.clearPropNum);\n            } else if (randomIndex == 1) {\n                Global.gameinfo.superPropNum = ThirdAPI.getSuperPropNum();\n                Global.gameinfo.superPropNum += parseInt(prop_parma.gainAddPropNum);\n                ThirdAPI.saveSuperPropNum(Global.gameinfo.superPropNum);\n            } else if (randomIndex == 2) {\n                Global.gameinfo.doublePropNum += parseInt(prop_parma.gainAddPropNum);\n            } else if (randomIndex == 4) {\n                Global.startUI.updateGold(parseInt(prop_parma.gainAddPropNum));\n                var gridController = Global.gridController.getComponent('gridController');\n                gridController.showGold();\n            }\n        }\n\n\n        if (prop_parma) {\n            var self = this;\n            var LoadAtlas = require(\"LoadAtlas\");\n            LoadAtlas.loadAtlasRes(\"textures/gridItem/items\", function () {\n                var LoadAtlas = require(\"LoadAtlas\");\n                self.gainPropIcon.spriteFrame = LoadAtlas.getSpriteFrameFromName(\"textures/gridItem/items\", prop_parma.addPropSprite);\n            });\n            self.gainPropName.string = prop_parma.name + 'x' + prop_parma.gainAddPropNum;\n        }\n        //\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        if (Global.gridController.getComponent(\"gridController\")) {\n            Global.gridController.getComponent(\"gridController\").setPropSprite();\n        }\n        this.closeTimer = setTimeout(() => {\n                this.closeSuccessNode();\n    }, 2000);\n\n        //\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n\n        this.onPauseGameForOther();\n    },\n\n    onAdFail: function () {\n        Global.game.showDialogPropText('');\n        //\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n    },\n\n    closeSuccessNode:function(){\n        this.successNode.active = false;\n    },\n\n    playLightAction: function () {\n        this.light.node.runAction(\n            cc.repeatForever(\n                cc.sequence(cc.rotateBy(0.3, -90), cc.rotateBy(0.3, -90), cc.rotateBy(0.3, -90), cc.rotateBy(0.3, -90)))\n        );\n    },\n    \n    //\n    clickProp: function () {\n        if (Global.wxGold < Global.costGold) {\n            console.log('my costGold is ' + Global.costGold);\n            return;\n        }\n\n        if (this.isClickBomming) {\n            this.resetProp();\n        } else {\n            var scale1 = cc.scaleBy(0.4, 1.1, 1.1);\n            var scale2 = cc.scaleBy(0.4, 1 / 1.1, 1 / 1.1);\n            var repeat = cc.repeat(cc.sequence(scale1, scale2), 99999);\n            this.prop.stopAllActions();\n            this.prop.runAction(repeat);\n            // if (this.bornGrid) {\n            //     this.bornGrid.pauseAllActions();\n            // }\n            // this.node.stopAllActions();\n            this.isClickBomming = true;\n            this.clickGridNum = 0;\n        }\n    },\n\n    resetProp: function () {\n        this.isClickBomming = false;\n        this.prop.stopAllActions();\n        var scale1 = cc.scaleTo(0.1, 1, 1);\n        this.prop.runAction(scale1);\n\n\n        // if (this.bornGrid) {\n        //itemitem\n        // var bornGridhIndex = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n        // var bornGridvIndex = Math.ceil(Math.abs((this.bornGrid.y - this.startY) / Global.itemSize));\n        // this.allGrids[bornGridhIndex][bornGridvIndex].getComponent('gridView').item = this.bornGrid;\n        // this.isClickBomming = false;\n        //this.propClearTime = 0;\n        // this.process();\n        //     console.log('');\n        // } else {\n        //     console.log('');\n        // }\n    },\n\n    //\n    getStopPosition: function (xBorn, yBorn) {\n        var addIndex = 0;\n        for (var index = Global.vNum - 1; index >= 0; index--) {\n            var node = this.allGrids[xBorn][index];\n            var gridView = node.getComponent(\"gridView\");\n            if (gridView && gridView.item == null && gridView.vIndex > yBorn) {\n                addIndex++;\n            }\n        }\n        return addIndex;\n    },\n\n    //\n    setTouchControl: function () {\n        var self = this;\n        if (self.node.parent) {\n            //\n            self.node.on(cc.Node.EventType.TOUCH_START, this.nodeStart, this);\n            //\n            self.node.on(cc.Node.EventType.TOUCH_MOVE, this.nodeMove, this);\n            //\n            self.node.on(cc.Node.EventType.TOUCH_END, this.nodeEnd, this);\n        }\n    },\n\n    nodeStart: function (event) {\n        if (!this.bornGrid) return;\n        this.startTouchPosition = event.getLocation();\n        this.moveItemIndex = this.createItemIndex;\n        this.moveStartX = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n    },\n\n    nodeMove: function (event) {\n        if (!this.bornGrid) return;\n        if (this.moveItemIndex != this.createItemIndex) {\n            return;\n        }\n        var self = this;\n        if (this.bornGrid && this.bornGrid.getComponent('itemView').canMove && !cc.game.isPaused() && !this.isClickBomming) {\n            var moveTemp = event.getLocation();\n            var dist = moveTemp.x - self.startTouchPosition.x;\n            var downDist = moveTemp.y - self.startTouchPosition.y;\n\n            //\n            var xPadding = Math.round(dist / Global.moveThreshold);\n            var isUpOrDown = Math.abs(downDist) > Global.moveDownThreshold ? true : false;\n\n            //self.startTouchPosition = moveTemp;\n            var targetGrid = self.isMoveGrid(this.moveStartX + xPadding);\n            if (isUpOrDown) {\n                console.log('xPadding---', xPadding);\n                //\n                var isTouchDown = moveTemp.y <= self.startTouchPosition.y ? true : false;\n                //self.startTouchPosition = moveTemp;\n                var targetGrid = self.isMoveQuickDown(isTouchDown);\n                if (targetGrid) {\n                    this.bornGrid.x = targetGrid.getPosition().x;\n                    var downNum = self.getStopPosition(targetGrid.getComponent('gridView').hIndex, targetGrid.getComponent('gridView').vIndex);\n                    var targetView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex + downNum];\n                    var priView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex];\n                    priView.getComponent('gridView').isDown = false;\n                    targetView.getComponent('gridView').isDown = true;\n\n                    this.bornGrid.getComponent('itemView').targetGrid = targetView;\n                    //\n                    //cc.log('quick down:' + downNum);\n                    if (this.bornGrid.getComponent('itemView').curState == 2 || this.bornGrid.getComponent('itemView').curState == 1) {\n                        self.maxDownTime = this.bornGrid.getComponent('itemView').quickDownAction(Global.gridQuickDownSpeed);\n                    }\n                    self.node.stopAllActions();\n                    self.checkGridMerge();\n                }\n            } else if (targetGrid) {\n                this.bornGrid.x = targetGrid.getPosition().x;\n                cc.log('change bornGridx:' + this.bornGrid.x);\n                var downNum = self.getStopPosition(targetGrid.getComponent('gridView').hIndex, targetGrid.getComponent('gridView').vIndex);\n                var targetView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex + downNum];\n                var priView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex];\n                priView.getComponent('gridView').isDown = false;\n                targetView.getComponent('gridView').isDown = true;\n\n                this.bornGrid.getComponent('itemView').targetGrid = targetView;\n                this.bornGrid.getComponent('itemView').changeStateToWaitDown(Global.gridDownSpeed);\n                self.node.stopAllActions();\n                self.checkGridMerge();\n            }\n        }\n    },\n\n    nodeEnd: function (event) {\n        if (!this.bornGrid) return;\n        /* if (this.moveItemIndex != this.createItemIndex) {\n             console.log('');\n             return;\n         }*/\n\n        var yDist = Math.abs(event.getLocation().y - this.startTouchPosition.y);\n\n        if (yDist == 0) {\n            var self = this;\n            /*  console.log(\"currStatus:\", this.bornGrid.getComponent('itemView').curState, this.bornGrid.getComponent('itemView').canMove);\n              if (this.bornGrid.getComponent('itemView').curState == 3 || this.bornGrid.getComponent('itemView').curState == 4 || this.bornGrid.getComponent('itemView').curState == 5) {\n                  console.log('');\n                  return;\n              }\n\n              console.log('actionJoin', this.bornGrid);*/\n\n\n\n            var targetGrid = self.isMoveQuickDown(true);\n            if (targetGrid) {\n                this.bornGrid.x = targetGrid.getPosition().x;\n                var downNum = self.getStopPosition(targetGrid.getComponent('gridView').hIndex, targetGrid.getComponent('gridView').vIndex);\n                var targetView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex + downNum];\n                var priView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex];\n                priView.getComponent('gridView').isDown = false;\n                targetView.getComponent('gridView').isDown = true;\n\n                this.bornGrid.getComponent('itemView').targetGrid = targetView;\n\n                cc.log('quick down:' + downNum);\n                //\n                if (this.bornGrid.getComponent('itemView').curState == 2 || this.bornGrid.getComponent('itemView').curState == 1) {\n                    self.maxDownTime = this.bornGrid.getComponent('itemView').quickDownAction(Global.gridQuickDownSpeed);\n                }\n                self.node.stopAllActions();\n                self.checkGridMerge();\n            }\n        }\n    },\n\n    /* */\n    isMoveGrid: function (hindex) {\n        //,\n        var _hIndex = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n        var _vIndex = Math.ceil(Math.abs((this.bornGrid.y - this.startY) / Global.itemSize));\n\n        if (hindex == _hIndex) {\n            return null;\n        }\n\n        if (hindex < 0 || hindex >= Global.hNum) {\n            return null;\n        }\n        //gird\b\n        //\n        var startX = hindex + 1;\n        var endx = _hIndex - 1;\n        if (hindex > _hIndex) {\n            startX = _hIndex + 1;\n            endx = hindex - 1;\n        }\n        while (startX <= endx) {\n            var soonMoveGrid = this.allGrids[startX][_vIndex];\n            if (soonMoveGrid && soonMoveGrid.getComponent(\"gridView\").item == null) {\n                startX++;\n                continue;\n            }\n            return null;\n        }\n        var soonMoveGrid = this.allGrids[hindex][_vIndex];\n\n        if (soonMoveGrid && soonMoveGrid.getComponent(\"gridView\").item == null) {\n            return soonMoveGrid;\n        }\n        return null;\n    },\n\n    /* */\n    isMoveQuickDown: function (isTouchDown) {\n        //,\n        var hIndex = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n        var vIndex = Math.floor(Math.abs((this.bornGrid.y - this.startY) / Global.itemSize));\n\n        if (!isTouchDown) {\n            return null;\n        }\n        if (vIndex >= (Global.vNum - 1)) {\n            return null;\n        }\n\n        var soonMoveGrid = this.allGrids[hIndex][vIndex + 1];\n        if (soonMoveGrid && soonMoveGrid.getComponent(\"gridView\").item == null) {\n            return soonMoveGrid;\n        }\n        return null;\n    },\n\n    //\n    resetItemAction: function (hindex, vindex, isClearGrid) {\n        var gridviewScript = this.allGrids[hindex][vindex].getComponent('gridView');\n        if (gridviewScript.item == null) {\n            return false;\n        }\n        var downNum;\n        if (isClearGrid) {\n            downNum = 1;\n        } else {\n            downNum = this.getStopPosition(hindex, vindex);\n        }\n        //\n        if (downNum == 0) {\n            return false;\n        }\n\n        var targetView = this.allGrids[hindex][vindex + downNum];\n        targetView.getComponent('gridView').isDown = true;\n        var _curitem = gridviewScript.item.getComponent('itemView');\n        _curitem.targetGrid = targetView;\n\n        var downSpeed = (this.isDown || Global.combineTimes > 0) ? Global.gridCombineDownSpeed : Global.gridDownSpeed;\n        console.log('' + downSpeed, Global.combineTimes);\n        var curtime = _curitem.startDownForBorn(downSpeed);\n\n        gridviewScript.item = null;\n        //targetView.getComponent('gridView').item = _curitem;\n        gridviewScript.gridNum = 0;\n        //\n        this.downGrids.push(_curitem);\n\n        return true;\n    },\n\n    //\n    onPauseOrResume: function () {\n        Global.game.playSound('btn', 0.1);\n        if (Global.isPaused) {\n            if (this.bornGrid) {\n                this.bornGrid.resumeAllActions();\n            }\n            this.node.resumeAllActions();\n            this.pauseNode.active = false;\n            Global.isPaused = false;\n        } else {\n            if (this.isClickBomming) {\n                this.resetProp();\n            }\n            if (this.bornGrid) {\n                this.bornGrid.pauseAllActions();\n            }\n            this.node.pauseAllActions();\n\n            Global.isPaused = true;\n            this.pauseNode.active = true;\n            this.pauseNode.setLocalZOrder(10);\n        }\n    },\n\n    //\n    onPauseGameForOther: function () {\n        if (Global.isPaused) {\n            if (this.bornGrid) {\n                this.bornGrid.resumeAllActions();\n            }\n            this.node.resumeAllActions();\n            Global.isPaused = false;\n        } else {\n            if (this.isClickBomming) {\n                this.resetProp();\n            }\n            if (this.bornGrid) {\n                this.bornGrid.pauseAllActions();\n            }\n            this.node.pauseAllActions();\n\n            Global.isPaused = true;\n        }\n    },\n\n    //\n    isShowChooseNum: function(isShow){\n        Global.game.playSound('btn', 0.1);\n        this.chooseNode.active = isShow;\n        if (isShow) {\n            this.chooseNode.setLocalZOrder(1);\n        }\n        this.onPauseGameForOther();\n    },\n\n    //\n    hidePropTipsNode: function () {\n        Global.game.playSound('btn', 0.1);\n        this.clearTips.active = false;\n        this.onPauseGameForOther();\n        this.createDownGrid();\n        this.setSoonGrid();\n        this.process();\n        this.createItemIndex++;\n    },\n\n    //\n    onRestart: function () {\n        Global.game.playSound('btn', 0.1);\n        this.closeListen();\n        this.reset();\n\n        if (this.bornGrid && this.bornGrid.parent) {\n            this.bornGrid.parent.removeChild(this.bornGrid);\n        }\n        Global.game.restart();\n    },\n\n    //\n    goMainScene: function () {\n        Global.game.playSound('btn', 0.1);\n        this.closeListen();\n        this.reset();\n\n        if (this.bornGrid && this.bornGrid.parent) {\n            this.bornGrid.parent.removeChild(this.bornGrid);\n        }\n        Global.game.startGame();\n        //\n        if (cc.game.isPaused()) {\n            cc.game.resume();\n        }\n    },\n\n    //\n    onShareGame: function () {\n        Global.game.playSound('btn', 0.1);\n        if (typeof FBInstant !== 'undefined') {\n            ThirdAPI.shareGame(this.getImgBase64(), null);\n        } else {\n            ThirdAPI.shareGame('screenshotForDown', null, null, '244');\n        }\n    },\n\n    //\n    updateGold: function (goldNum) {\n        var goldLabel = this.goldNode.getChildByName('label');\n        goldLabel.getComponent(cc.Label).string = Global.wxGold;\n        //\n        if (Global.addGold[goldNum] === undefined) {\n            cc.log('update gold ');\n            return;\n        }\n        if (parseInt(Global.addGold[goldNum]) <= 0) {\n            return;\n        }\n        //Global.wxGold += parseInt(Global.addGold[goldNum]);\n        if (Global.startUI) {\n            Global.startUI.updateRedDot(parseInt(Global.addGold[goldNum]));\n        }\n        \n        console.log('1 :' + Global.addGold[goldNum] + \"goldNum :\" + goldNum);\n        //\n        if (typeof wx !== 'undefined') {\n            var data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('gridController on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n            });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n        this.showGold();\n    },\n\n    showGold: function () {\n        var goldLabel = this.goldNode.getChildByName('label');\n        goldLabel.getComponent(cc.Label).string = Global.wxGold;\n    },\n\n    bombRunAction: function () {\n        if (this.bombNode.active) {\n            this.bombNode.rotation = 0;\n            this.bombNode.stopAllActions();\n            this.bombNode.runAction(\n                cc.repeatForever(\n                    cc.sequence(cc.rotateBy(0.1, 10), cc.rotateBy(0.2, -20), cc.rotateBy(0.2, 20), cc.rotateBy(0.2, -20), cc.rotateBy(0.1, 10), cc.delayTime(2)))\n            );\n        }\n    },\n\n    //\n    onBombShare: function() {\n        Global.game.playSound('btn', 0.1);\n        //''\n        var biManager = require('biManager');\n        biManager.bilog(biManager.useBomb, null);\n\n        this.pauseInterval = true;\n        if (typeof FBInstant !== 'undefined') {\n            var myUtil = require('myUtil');\n            ThirdAPI.shareGame(myUtil.getImgBase64(), this.onBombShareSuccess.bind(this));\n        } else if (typeof wx !== 'undefined') {\n            if (Global.cdnGameConfig && Global.cdnGameConfig.totalSwith) {\n                ThirdAPI.shareGame('randomImg', this.onBombShareSuccess.bind(this), this.onBombShareFail.bind(this), '253');\n                // this.onPauseGameForOther();\n                // var wxRewardVideoAd = require('wxRewardVideoAd');\n                // wxRewardVideoAd.initCreateReward(this.onStartBomb.bind(this), this.onBombAdFail.bind(this));\n            } else {\n                this.onPauseGameForOther();\n                var wxRewardVideoAd = require('wxRewardVideoAd');\n                wxRewardVideoAd.initCreateReward(this.onStartBomb.bind(this), this.onBombAdFail.bind(this));\n            }\n        } else {\n            this.onBombShareSuccess();\n        }\n    },\n\n    //\n    onBombShareSuccess: function (openGId) {\n        //\n        var biManager = require('biManager');\n        biManager.bilog(biManager.bombShareSuccess, null);\n\n        if (typeof wx !== 'undefined') {\n            if (!openGId) {\n                Global.game.showDialogText('');\n                console.log('');\n                return;\n            }\n        }\n        if (Global.gameinfo.shareData1.arrOpenGId.indexOf(openGId) != -1) {\n            console.log('', openGId);\n            Global.game.showDialogText('');\n            return;\n        } else {\n            console.log('', openGId);\n            Global.gameinfo.shareData1.arrOpenGId.push(openGId);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n        this.onStartBomb();\n    },\n\n    //\n    onStartBomb: function () {\n        //\n        var needBombIndex = -1;\n        for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n            for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    needBombIndex = vIndex;\n                    break;\n                }\n            }\n            if (needBombIndex > -1) {\n                break;\n            }\n        }\n\n        if (needBombIndex < 0) {\n            this.onPauseGameForOther();\n            return;\n        }\n        console.log('needBombIndex:', needBombIndex);\n\n        this.bombShareTimes++;\n        this.bombSurplus.string = Global.cdnGameConfig.bombShareTimes - this.bombShareTimes;\n        this.bombNode.active = this.bombShareTimes < Global.cdnGameConfig.bombShareTimes ? true : false;\n        if (!this.bombNode.active) {\n            this.bombNode.stopAllActions();\n        }\n\n        // this.onPauseGameForOther();\n        this.node.stopAllActions();\n        this.closeListen();\n\n        if (this.bornGrid) {\n            this.bornGrid.stopAllActions();\n        }\n\n        //\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    gridView.node.stopAllActions();\n                    gridView.item.getComponent(\"itemView\").node.stopAllActions();\n                }\n            }\n        }\n\n        //\n        var blinkPos = this.allGrids[Global.bornXgridNum][needBombIndex].getPosition();\n        this.blinkSpr.node.setPosition(blinkPos);\n        this.blinkSpr.node.width = Global.hNum * Global.itemSize;\n\n        this.blinkSpr.node.stopAllActions();\n        this.blinkSpr.node.setLocalZOrder(2000);\n        var myAction = cc.sequence(cc.fadeTo(0.3, 255), cc.fadeTo(0.3, 0), cc.fadeTo(0.3, 255), cc.fadeTo(0.3, 0), cc.fadeTo(0.3, 255), cc.fadeTo(0.3, 0));\n        this.blinkSpr.node.runAction(myAction);\n\n        var actions = [];\n        var time = 1.8;\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            var grid = this.allGrids[hIndex][needBombIndex];\n            var gridView = grid.getComponent(\"gridView\");\n            if (gridView && gridView.item != null) {\n                var itemViewScript = gridView.item.getComponent(\"itemView\");\n                var clearTime = itemViewScript.clearItem(time);\n                time += clearTime;\n                gridView.gridNum = 0;\n                gridView.item = null;\n            }\n        }\n\n        this.clearAllJoin();\n\n        var self = this;\n        self.node.runAction(cc.sequence(cc.delayTime(time + 0.1), cc.callFunc(function () {\n            self.onPauseGameForOther();\n            //\n            self.setTouchControl();\n            if (self.bornGrid) {\n                var targetGrid = self.bornGrid.getComponent('itemView').targetGrid;\n                var currBornXGridNum = targetGrid.getComponent('gridView').hIndex;\n\n                var downNum = self.getStopPosition(currBornXGridNum, 0);\n                var targetView = self.allGrids[currBornXGridNum][downNum];\n                self.bornGrid.getComponent('itemView').targetGrid = targetView;\n                self.bornGrid.getComponent('itemView').startDownForBorn(Global.gridDownSpeed);\n            }\n            //\n            self.process();\n        })));\n    },\n\n    onBombShareFail: function (msg) {\n        console.log('');\n        if (msg === undefined) {\n            Global.game.showDialogText('');\n        } else if (msg == 'fail') {\n            Global.game.showDialogText('');\n        } else if (msg == 'cancel') {\n            Global.game.showDialogText('');\n        } else {\n            Global.game.showDialogText('');\n        }\n    },\n\n    //\n    onBombAdFail: function () {\n        this.onPauseGameForOther();\n        Global.game.showDialogPropText('');\n    },\n\n    //\n    gameOver: function () {\n        this.node.stopAllActions();\n        this.closeListen();\n        ThirdAPI.clearGameProgressInfo();\n        //\n        cc.director.getScheduler().unschedule(this.getNextFriend, this);\n        //banner\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n\n        //\n        Global.reviveShareTimes = ThirdAPI.loadReviveData();\n\n        //\n        if (Global.reviveTimes < Global.reviveTotalTimes && Global.reviveShareTimes > 0) {\n            Global.game.showReviveWindow();\n            // Global.reviveUI.setScore(this.scoreScript.scoreNum);\n        } else {\n            Global.game.showShareWindow();\n            //Global.shareUI.updateMaxLabel(this.scoreScript.scoreNum);\n        }\n    },\n\n    //\n    clearGridForRevive: function () {\n        this.node.stopAllActions();\n        //\n        cc.director.getScheduler().unschedule(this.getNextFriend, this);\n\n        //\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    gridView.node.stopAllActions();\n                    gridView.item.getComponent(\"itemView\").node.stopAllActions();\n                }\n            }\n        }\n\n        //\n        var time = 0;\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.clearVNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    var itemViewScript = gridView.item.getComponent(\"itemView\");\n                    var clearTime = itemViewScript.toRevive();\n                    if (clearTime > time) {\n                        time = clearTime;\n                    }\n                    gridView.gridNum = 0;\n                    gridView.item = null;\n                }\n            }\n        }\n\n        //64\n        /*var time = 0;\n        for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null && gridView.gridNum < 64) {\n                    var itemViewScript = gridView.item.getComponent(\"itemView\");\n                    var clearTime = itemViewScript.toRevive();\n                    if (clearTime > time) {\n                        time = clearTime;\n                    }\n                    gridView.gridNum = 0;\n                    gridView.item = null;\n                }\n            }\n        }*/\n\n        this.clearAllJoin();\n\n        //\n        for (var index = 0; index < Global.flyNumPools.length; index++) {\n            const element = Global.flyNumPools[index];\n            if (element && element.parent) {\n                element.getComponent('flynum').finished();\n            }\n        }\n\n        //\n        console.log('clear time:' + time);\n        var self = this;\n        self.node.runAction(cc.sequence(cc.delayTime(time + 0.1), cc.callFunc(function () {\n            //\n            var biManager = require('biManager');\n            biManager.bilog(biManager.reviveSuccess, null);\n\n            if (self.bornGrid) {\n                self.bornGrid.stopAllActions();\n                if (self.bornGrid.parent) {\n                    self.bornGrid.parent.removeChild(self.bornGrid);\n                }\n            }\n            self.bornGrid = null;\n\n            //\n            //self.reset();\n            //\n            //self.createAllGrid();\n            //\n            self.setTouchControl();\n            //\n            self.process();\n        })));\n    },\n\n    /*\n    //\n    update: function () {\n        var unixTime = (new Date()).getTime();\n        if (unixTime > (this.startTime + Global.accessTime) && this.addTimes < Global.addTimes) {\n            this.addTimes++;\n            this.startTime = (new Date()).getTime();\n\n            Global.gridDownSpeed *= 1.2;\n            Global.gridDownSpeed = parseInt(Global.gridDownSpeed * 100) / 100;\n            Global.waitToDown *= 0.8;\n            Global.waitToDown = parseInt(Global.waitToDown * 100) / 100;\n            console.log('', Global.gridDownSpeed, Global.waitToDown);\n        }\n    },*/\n\n    //\n    reset: function () {\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n\n        this.node.stopAllActions();\n        cc.director.getScheduler().unschedule(this.getNextFriend, this);\n\n        this.popDialogTimes = 0;\n        this.bombShareTimes = 0;\n        //\n        this.startTime = (new Date()).getTime();\n        this.usePropTimes = 0;\n        this.useSuperTimes = 0;\n        this.useDoubleTimes = 0;\n        this.useProp = -1;\n        this.setPropSprite();\n        Global.usePropStatus = -1;\n        this.addTimes = 0;\n        Global.reviveTimes = 0;\n        Global.combineTimes = 0;\n        Global.testEnabled = false;\n        this.randomScore = 0;\n        Global.joinRandomScores = [];\n        Global.isPaused = false;\n        this.isClickBomming = false;\n        this.propClearTime = 0;\n        this.clickGridNum = 0;\n        this.createItemIndex = 0;\n        this.moveItemIndex = 0;\n        this.createItemNum = 0;\n        this.createItemNum1 = 0;\n        Global.isPropGuide = false;\n        //\n        for (var index = 0; index < Global.flyNumPools.length; index++) {\n            const element = Global.flyNumPools[index];\n            if (element && element.parent) {\n                element.getComponent('flynum').finished();\n            }\n        }\n\n        if (this.bornGrid) {\n            this.bornGrid.stopAllActions();\n            if (this.bornGrid.parent) {\n                this.bornGrid.parent.removeChild(this.bornGrid);\n            }\n        }\n        //\n        if (this.allGrids.length > 0) {\n            for (var hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                for (var vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                    var grid = this.allGrids[hIndex][vIndex];\n                    var gridView = grid.getComponent(\"gridView\");\n                    grid.stopAllActions();\n                    if (gridView && gridView.item != null) {\n                        gridView.item.getComponent(\"itemView\").toRemove();\n                    }\n\n                    //grid\n                    if (grid.parent) {\n                        grid.parent.removeChild(grid);\n                    }\n                }\n            }\n            this.clearAllJoin();\n        }\n        this.allGrids = [];\n        this.scoreScript.reset();\n        this.bornGrid = null;\n        if (this.soonGridInstance && this.soonGridInstance.parent) {\n            this.soonGridInstance.parent.removeChild(this.soonGridInstance);\n        }\n        // //\n        // if (Global.gameinfo && (Global.gameinfo.clearPropNum > 1 || Global.gameinfo.superPropNum > 1)) {\n        //     if (Global.gameinfo.clearPropNum > 1) {\n        //         Global.gameinfo.clearPropNum = 1;\n        //     }\n        //     if (Global.gameinfo.superPropNum > 1) {\n        //         Global.gameinfo.superPropNum = 1;\n        //     }\n        //     ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        // }\n\n        //\n        var myUtil = require('myUtil');\n        myUtil.randomForWeight(Global.weightConfig.oneWeightRate, Global.weightConfig.oneTotalWeight);\n    },\n});"]}