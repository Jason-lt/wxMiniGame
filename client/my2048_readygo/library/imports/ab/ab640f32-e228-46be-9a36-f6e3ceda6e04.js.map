{"version":3,"sources":["../../../../../assets/Scripts/ui/assets/Scripts/ui/shareUI.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","bg","default","type","Node","line1","line2","currScore","Label","score","personPer","btn_label","node_gold","fly_node","lbl_gold","lbl_fly","soundOnBtn","soundOffBtn","dailyLabel","backgroundAudio","url","AudioClip","tipbox","getStoneBtn","getStoneForAd","shareBtn","hasShardReward","isStart","start","Global","shareUI","getComponent","setBackground","initData","destroyBannerAd","showEffect","setShowButton","gridControllerScript","gridController","updateMaxLabel","scoreScript","scoreNum","biManager","bilog","entershare","active","cdnGameConfig","totalSwith","isDailyLimit","canShow","wxScore","shareScoreLimit","shareScoreSwith","shareData","shareTimes","wxBannerAd","showTipbox","onTipButton","canvas","find","width","console","log","switchBGM","startUI","node","setPosition","p","action","moveTo","runAction","maxNum","string","myUtil","getPercentString","wx","data","loadLocalScore","parseInt","maxscore","gold","loadScore","dailyBattleTimes","gameinfo","battleTimes","saveScore","historyMaxScore","resetInitData","dailyScore","FBInstant","fbScore","dataScript","titleMaxScore","titleUI","updateItemsState","play","game","playSound","showDialogPropText","saveFriendGenStoneInfo","enterScene","restar","gotoHome","startGame","showRankUI","showRankWindow","onShareGame","shareGame","getImgBase64","onShareSuccess","bind","onShareFail","getStoneForShare","onGetStoneSuccess","openGId","storeShare","saveShareData","shareDate","updateRedDot","shareReward","wxGold","playGetGoldEffect","onGetStoneForAd","wxRewardVideoAd","initCreateReward","onAdSuccess","onAdFail","onChallenge","shareAsync","intent","image","text","myReplayData","then","showDialogText","ani","Animation","fadeIn","on","sequence","scaleTo","callFunc","fadeOut"],"mappings":"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","file":"shareUI.js","sourceRoot":"../../../../../assets/Scripts/ui","sourcesContent":["var ThirdAPI = require('../common/ThirdAPI');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bg: {\n            default: null,\n            type: cc.Node\n        },\n        line1: {\n            default: null,\n            type: cc.Node\n        },\n        line2: {\n            default: null,\n            type: cc.Node\n        },\n        //当前分数\n        currScore: {\n            default: null,\n            type: cc.Label,\n        },\n        score: {\n            default: null,\n            type: cc.Label,\n        },\n        personPer: {\n            default: null,\n            type: cc.Label,\n        },\n        btn_label: {\n            default: null,\n            type: cc.Label,\n        },\n        node_gold: {\n            default: null,\n            type: cc.Node\n        },\n        fly_node: {\n            default: null,\n            type: cc.Node\n        },\n        lbl_gold: {\n            default: null,\n            type: cc.Label,\n        },\n        lbl_fly: {\n            default: null,\n            type: cc.Label,\n        },\n        soundOnBtn: {\n            default: null,\n            type: cc.Node\n        },\n        soundOffBtn: {\n            default: null,\n            type: cc.Node\n        },\n        dailyLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        //背景音乐\n        backgroundAudio: {\n            url: cc.AudioClip,\n            default: null\n        },\n        // 提示信息\n        tipbox: {\n            default: null,\n            type: cc.Node,\n        },\n        //分享给好友得钻石\n        getStoneBtn: {\n            default: null,\n            type: cc.Node,\n        },\n\n        //看视频得钻石\n        getStoneForAd: {\n            default: null,\n            type: cc.Node,\n        },\n\n        shareBtn: {\n            default: null,\n            type: cc.Node,\n        },\n\n        /*\n                buttonstate0: {\n                    default: null,\n                    type: cc.Node\n                },\n                buttonstate1: {\n                    default: null,\n                    type: cc.Node\n                },*/\n\n        hasShardReward: true,\n        isStart: false,\n    },\n\n    start() {\n        Global.shareUI = this.getComponent('shareUI');\n\n        this.setBackground();\n        this.isStart = true;\n    },\n\n    initData: function () {\n        this.hasShardReward = true;\n        this.destroyBannerAd();\n        this.showEffect();\n        this.setBackground();\n        this.setShowButton();\n\n        var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n        if (gridControllerScript) {\n            this.updateMaxLabel(gridControllerScript.scoreScript.scoreNum);\n        }\n\n        //记载进入结算界面打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.entershare, null);\n\n        /*\n                if (Global.cdnGameConfig.totalSwith || Global.isDailyLimit) {\n                    this.buttonstate0.active = false;\n                    this.buttonstate1.active = true;\n                } else {\n                    //分数开关判断\n                    if (Global.cdnGameConfig.shareScoreSwith) {\n                        //判断分数\n                        console.log('判断分数：', Global.cdnGameConfig.shareScoreLimit, Global.wxScore);\n                        var canShow = Global.wxScore > Global.cdnGameConfig.shareScoreLimit ? true : false;\n                        console.log('分享界面按钮判断--canShow:', canShow);\n                        if (canShow) {\n                            this.buttonstate0.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? true : false;\n                            this.buttonstate1.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? false : true;\n                        } else {\n                            this.buttonstate0.active = false;\n                            this.buttonstate1.active = true;\n                        }\n                    } else {\n                        this.buttonstate0.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? true : false;\n                        this.buttonstate1.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? false : true;\n                    }\n\n                    // this.buttonstate0.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? true : false;\n                    // this.buttonstate1.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? false : true;\n                }*/\n\n\n        // if (Global.shareData.shareTimes >= 5) {\n        //     console.log('分享超过5次限制');\n        //     this.buttonstate0.active = false;\n        //     this.buttonstate1.active = true;\n        // }\n    },\n\n    //根据开关设置分享按钮状态\n    setShowButton: function () {\n        this.shareBtn.active = false;\n        if (!Global.cdnGameConfig.totalSwith || Global.isDailyLimit) {\n            this.getStoneBtn.active = false;\n            this.getStoneForAd.active = true;\n        } else {\n            var canShow = Global.wxScore > Global.cdnGameConfig.shareScoreLimit ? true : false;\n            //开关打开，并且不能显示按钮\n            if (Global.cdnGameConfig.shareScoreSwith && !canShow) {\n                this.getStoneBtn.active = false;\n                this.getStoneForAd.active = true;\n            } else {\n                this.getStoneBtn.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? true : false;\n                this.getStoneForAd.active = (this.hasShardReward && Global.shareData.shareTimes < 5) ? false : true;\n            }\n        }\n    },\n\n    //销毁banner广告\n    destroyBannerAd: function () {\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n    },\n\n    // 显示提示框\n    showTipbox: function () {\n        this.tipbox.active = true;\n    },\n\n    onTipButton: function () {\n        this.tipbox.active = false;\n    },\n\n    //设置头部图片的适配宽高\n    setBackground: function () {\n        var canvas = cc.find('Canvas');\n        this.bg.width = canvas.width;\n        this.line1.width = canvas.width;\n        this.line2.width = canvas.width;\n        console.log('width:', this.bg.width, this.line1.width, this.line2.width);\n    },\n\n    switchBGM: function () {\n        Global.startUI.switchBGM();\n    },\n\n    showEffect: function () {\n        this.node_gold.active = false;\n        this.fly_node.active = false;\n\n        this.node.setPosition(cc.p(-640, 0));\n        var action = cc.moveTo(0.6, cc.p(0, 0));\n        this.node.runAction(action);\n    },\n\n    updateMaxLabel: function (maxNum) {\n        //本局最高分\n        this.currScore.string = maxNum;\n        //全球比分\n        var myUtil = require('myUtil');\n        this.personPer.string = myUtil.getPercentString(maxNum);\n        this.score.string = '历史最高分：' + maxNum;\n        if (typeof wx !== 'undefined') {\n            var data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('on ThirdAPI loadScore', score, parseInt(gold));\n            });\n            if (Global.isDailyLimit) {\n                this.dailyLabel.string = \"每日挑战次数：\" + (Global.dailyBattleTimes - Global.gameinfo.battleTimes) + \"/\" + Global.dailyBattleTimes;\n            } else {\n                this.dailyLabel.string = \"\";\n            }\n\n            //不是每日挑战\n            if (!Global.isDailyLimit) {\n                //历史最高分\n                if (score < maxNum) {\n                    ThirdAPI.saveScore(maxNum, gold);\n                    this.score.string = '历史最高分：' + maxNum;\n                    Global.historyMaxScore = maxNum;\n                } else {\n                    this.score.string = '历史最高分：' + score;\n                    Global.historyMaxScore = score;\n                }\n            } else {\n                //兼容dailyScore\n                if (!Global.gameinfo) {\n                    var myUtil = require('myUtil');\n                    myUtil.resetInitData();\n                }\n                if (Global.gameinfo && !Global.gameinfo.dailyScore) {\n                    Global.gameinfo.dailyScore = 0;\n                }\n                this.score.string = \"今日挑战最高分数：\" + parseInt(Global.gameinfo.dailyScore);\n            }\n        } else if (typeof FBInstant !== 'undefined') {\n            if (maxNum > Global.fbScore) {\n                this.score.string = maxNum;\n                //测试\n                Global.dataScript.saveScore(maxNum);\n            } else {\n                this.score.string = Global.fbScore;\n            }\n        }\n\n        Global.titleMaxScore = maxNum;\n        if (Global.titleUI) {\n            Global.titleUI.updateItemsState(1);\n        }\n    },\n\n    //进入游戏\n    play: function () {\n        Global.game.playSound('btn', 0.1);\n        if (Global.isDailyLimit) {\n            //判断挑战次数\n            if (Global.gameinfo.battleTimes <= 0) {\n                console.log('挑战次数不足');\n                Global.game.showDialogPropText(\"每日挑战次数到达上限\");\n                return;\n            }\n            Global.gameinfo.battleTimes--;\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n        Global.game.enterScene();\n\n        //记载结算界面重新开始打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.restar, null);\n    },\n\n    //返回主页\n    gotoHome: function () {\n        Global.game.playSound('btn', 0.1);\n        Global.game.startGame();\n    },\n\n    //进入排行榜\n    showRankUI: function () {\n        Global.game.playSound('btn', 0.1);\n        Global.game.showRankWindow();\n    },\n\n    // 分享功能  intent(\"INVITE\" | \"REQUEST\" | \"CHALLENGE\" | \"SHARE\") 表示分享的意图\n    onShareGame: function () {\n        Global.game.playSound('btn', 0.1);\n        if (typeof FBInstant !== 'undefined') {\n            var myUtil = require('myUtil');\n            ThirdAPI.shareGame(myUtil.getImgBase64(), this.onShareSuccess.bind(this));\n        } else {\n            ThirdAPI.shareGame('screenshot', this.onShareSuccess.bind(this), this.onShareFail.bind(this), '252');\n        }\n    },\n\n    //分享给好友成功\n    onShareSuccess: function () {\n        console.log('分享给好友成功');\n        this.getStoneBtn.active = false;\n        // this.shareBtn.active = true;\n        this.getStoneForAd.active = true;\n        Global.game.showDialogPropText('分享成功！');\n    },\n\n\n    //分享得钻石\n    getStoneForShare: function () {\n        Global.game.playSound('btn', 0.1);\n        if (typeof FBInstant !== 'undefined') {\n            var myUtil = require('myUtil');\n            ThirdAPI.shareGame(myUtil.getImgBase64(), this.onShareSuccess.bind(this));\n        } else {\n            ThirdAPI.shareGame('randomImg', this.onGetStoneSuccess.bind(this), this.onShareFail.bind(this), '251');\n        }\n    },\n\n    //分享得钻石成功\n    onGetStoneSuccess: function (openGId) {\n        //结算界面通过送钻石分享成功\n        var biManager = require('biManager');\n        biManager.bilog(biManager.storeShare, null);\n\n        if (Global.shareData.shareTimes >= 5) {\n            console.log('分享超过5次限制');\n            this.getStoneBtn.active = false;\n            // this.shareBtn.active = true;\n            this.getStoneForAd.active = true;\n            return;\n        }\n\n        //获得钻石动画\n        if (this.hasShardReward) {\n            /* if (Global.gameinfo.shareData3.arrOpenGId.indexOf(openGId) != -1) {\n                 console.log('该群今日已经分享过', openGId);\n                 Global.game.showDialogText('该群今日已经分享过无法获得奖励');\n                 return;\n             } else {\n                 console.log('该群未分享过', openGId);\n                 Global.gameinfo.shareData3.arrOpenGId.push(openGId);\n                 ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n             }\n\n             if (!openGId) {\n                 Global.game.showDialogText('分享失败，必须分享到微信群', {\n                     x: 0,\n                     y: -200\n                 });\n                 console.log('shareUI 分享的不是群');\n                 return;\n             }*/\n            console.log('分享获得钻石,开始播放动画');\n            Global.shareData.shareTimes++;\n            ThirdAPI.saveShareData(Global.shareData.shareTimes, Global.shareData.shareDate);\n\n            //Global.wxGold += parseInt(Global.shareReward);\n            if (Global.startUI) {\n                Global.startUI.updateRedDot(parseInt(Global.shareReward));\n            }\n            //更新并存储\n            if (typeof wx !== 'undefined') {\n                var data = ThirdAPI.loadLocalScore();\n                var score = parseInt(data.maxscore);\n                var gold = parseInt(data.gold);\n                ThirdAPI.loadScore((maxscore, gold) => {\n                    score = parseInt(maxscore);\n                    gold = parseInt(gold);\n                    console.log('shareUI on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n                });\n                ThirdAPI.saveScore(score, Global.wxGold);\n            }\n\n            //更改分享可获钻石状态\n            this.hasShardReward = false;\n            this.playGetGoldEffect();\n        }\n    },\n\n    onGetStoneForAd: function () {\n        Global.game.playSound('btn', 0.1);\n        if (typeof wx !== 'undefined') {\n            var wxRewardVideoAd = require('wxRewardVideoAd');\n            wxRewardVideoAd.initCreateReward(this.onAdSuccess.bind(this), this.onAdFail.bind(this));\n        }\n    },\n\n    onAdSuccess: function () {\n        Global.wxGold += parseInt(Global.shareReward);\n        //更新并存储\n        if (typeof wx !== 'undefined') {\n            var data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n            gold = parseInt(gold);\n            console.log('shareUI on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n        });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n\n        //更改分享可获钻石状态\n        this.hasShardReward = false;\n        this.playGetGoldEffect();\n    },\n\n    //看视频失败\n    onAdFail: function () {\n        Global.game.showDialogPropText('看完完整视频获得钻石');\n    },\n\n\n    /*\n        onShareSuccess: function (openGId) {\n            //总开关判断\n            if (Global.cdnGameConfig.totalSwith || Global.isDailyLimit) {\n                this.buttonstate0.active = false;\n                this.buttonstate1.active = true;\n                return;\n            } else {\n                //分数开关判断\n                if (Global.cdnGameConfig.shareScoreSwith) {\n                    //判断分数\n                    console.log('分享成功之后判断分数：', Global.cdnGameConfig.shareScoreLimit, Global.wxScore);\n                    var canTakeReward = Global.wxScore > Global.cdnGameConfig.shareScoreLimit ? true : false;\n\n                    if (!canTakeReward) {\n                        console.log('分享成功不能领取奖励')\n                        this.buttonstate0.active = false;\n                        this.buttonstate1.active = true;\n                        return;\n                    }\n                }\n            }\n\n    //console.log('今日分享次数:', Global.shareData.shareTimes);\n    /* if (Global.shareData.shareTimes >= 5) {\n            //console.log('分享超过5次限制');\n            this.buttonstate0.active = false;\n            this.buttonstate1.active = true;\n            return;\n        }\n\n        //获得钻石动画\n        if (this.hasShardReward) {\n            if (Global.gameinfo.shareData3.arrOpenGId.indexOf(openGId) != -1) {\n                console.log('该群今日已经分享过', openGId);\n                Global.game.showDialogText('该群今日已经分享过无法获得奖励');\n                return;\n            } else {\n                console.log('该群未分享过', openGId);\n                Global.gameinfo.shareData3.arrOpenGId.push(openGId);\n                ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n            }\n\n            if (!openGId) {\n                Global.game.showDialogText('分享失败，必须分享到微信群', {\n                    x: 0,\n                    y: -200\n                });\n                console.log('shareUI 分享的不是群');\n                return;\n            }\n            console.log('分享获得钻石,开始播放动画');\n            Global.shareData.shareTimes++;\n            ThirdAPI.saveShareData(Global.shareData.shareTimes, Global.shareData.shareDate);\n\n            Global.wxGold += parseInt(Global.shareReward);\n            //更新并存储\n            if (typeof wx !== 'undefined') {\n                var data = ThirdAPI.loadLocalScore();\n                var score = parseInt(data.maxscore);\n                var gold = parseInt(data.gold);\n                ThirdAPI.loadScore((maxscore, gold) => {\n                    score = parseInt(maxscore);\n                    gold = parseInt(gold);\n                    console.log('shareUI on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n                });\n                ThirdAPI.saveScore(score, Global.wxGold);\n            }\n\n            //更改分享可获钻石状态\n            this.hasShardReward = false;\n            this.playGetGoldEffect();\n        }\n    },*/\n\n\n    onChallenge: function () {\n        Global.game.playSound('btn', 0.1);\n        var myUtil = require('myUtil');\n        if (typeof FBInstant === 'undefined') return;\n        FBInstant.shareAsync({\n            intent: 'INVITE',\n            image: myUtil.getImgBase64(),\n            text: 'I just challenged Tetris2048,Join me!',\n            data: {\n                myReplayData: '...'\n            },\n        }).then(() => {\n            // continue with the game.\n        });\n    },\n\n    //分享到群失败\n    onShareFail: function () {\n        console.log('分享失败');\n        Global.game.showDialogText('分享失败!');\n    },\n\n    playGetGoldEffect: function () {\n        this.getStoneBtn.active = false;\n        this.shareBtn.active = true;\n        this.getStoneForAd.active = false;\n        //更改分享可获钻石状态\n        this.hasShardReward = false;\n\n        this.fly_node.active = true;\n        this.lbl_fly.string = '+' + Global.shareReward;\n        var ani = this.fly_node.getComponent(cc.Animation)\n        ani.play();\n        this.node_gold.active = true;\n        this.lbl_gold.string = Global.wxGold - parseInt(Global.shareReward);\n        this.node_gold.runAction(cc.fadeIn(0.5));\n\n        ani.on('stop', () => {\n            this.node_gold.runAction(cc.sequence(\n                cc.scaleTo(0.2, 1.2),\n                cc.callFunc(() => {\n                    this.lbl_gold.string = Global.wxGold;\n                    this.fly_node.active = false;\n                }),\n                cc.scaleTo(0.2, 1),\n                cc.fadeOut(1)\n            ));\n        });\n    },\n});"]}