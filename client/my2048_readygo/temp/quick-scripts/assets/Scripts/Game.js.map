{"version":3,"sources":["Game.js"],"names":["ThirdAPI","require","Tmp","TmpOne","cc","Class","extends","Component","properties","girdRoot","default","type","Prefab","loadingUI","Node","bannerCloseBtn","btnSound","tipsNode","bannerAdInstance","onLoad","console","log","Date","getTime","listenUtil","eventCtrl","addListen","loadIp","bind","biManager","bilog","loadGame","Global","game","getComponent","active","myUtil","resetInitData","loginDateStr","toDateString","startLoadRes","httpUtils","self","httpGets","data","jsonData","JSON","parse","cdnGameConfig","bannerAdConfig","reviveConfig","clearVNum","startConfig","trigger","totalSwith","swith","error","linkImages","cdnShareImages","shareImages","cdnTexts","shareTexts","propShareImages","propShareTexts","loadWeightConfig","weightConfig","loadDailyConfig","dailyConfig","loadingGame","opacity","runAction","sequence","fadeIn","delayTime","fadeOut","callFunc","enterGame","startGame","getProp","setTest","initFriendRank","banSwtich","sendHttpRequest","xhr","result","responseText","replace","city","cname","isBan","banList","i","length","str","search","shareManager","LoadAtlas","loadAtlasRes","loader","loadRes","err","oneWeightRate","oneTotalWeight","retCode","isFromGroup","gameinfo","clearPropNum","clearPropLimit","showDialogPropText","saveFriendGenStoneInfo","superPropNum","superPropLimit","doublePropNum","doublePropLimit","wx","startUI","setTimeout","updateGold","addStone","stoneNum","msg","clearGameInfo","clearFriendGenStoneInfo","loadPrefab","uiRootPrefab","uiScript","instantiate","node","parent","removeChild","showStartUI","cdnchange","addChild","initStoreData","initTitleData","initUIData","showShareWindow","wdfk","GlobalFunc","showRankWindow","canShowGameClub","showGroupRankWindow","showStoreWindow","showReviveWindow","showTitleWindow","showTitleInfoWindow","showRewardWindow","showPropDialogWindow","isChest","showText","parmaIndex","showAddPropDialogWindow","parma","storePrefab","storeUI","initData","onClose","titleUI","storeData","loadInfo","skinIndex","loadCurrentSkin","titleData","titleDateData","titleUnlockData","shareData","loadShareData","d","now","d1","shareTimes","shareDate","saveShareData","saveScore","loadLocalScore","score","parseInt","maxscore","gold","loadScore","wxGold","text","setLocalZOrder","stopAllActions","label","getChildByName","Label","string","width","find","showDialogText","p","playSound","sname","volume","isSoundPlaying","AudioClip","clip","sound","audioSource","AudioSource","play","switchSound","restart","enterScene","list","gridController","initGridData"],"mappings":"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A6YL;AACAC,qBAAiB,2BAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,aAAKC,UAAL,CAAgBF,eAAhB,CAAgC,IAAhC;AACH,KA5ZI;;AA8ZL;AACAG,oBAAgB,wBAAUC,eAAV,EAA2B;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAH,aAAKC,UAAL,CAAgBC,cAAhB,CAA+B,IAA/B,EAAoCC,eAApC;AACH,KA5aI;;AA8aLC,yBAAqB,6BAAUD,eAAV,EAA2B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAH,aAAKC,UAAL,CAAgBG,mBAAhB,CAAoC,IAApC,EAAyCD,eAAzC;AACH,KA3bI;;AA6bL;AACAE,qBAAiB,2BAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAL,aAAKC,UAAL,CAAgBI,eAAhB,CAAgC,IAAhC;AACH,KA9cI;;AAgdL;AACAC,sBAAkB,4BAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAN,aAAKC,UAAL,CAAgBK,gBAAhB,CAAiC,IAAjC;AACH,KA9dI;;AAgeL;AACAC,qBAAiB,2BAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAP,aAAKC,UAAL,CAAgBM,eAAhB,CAAgC,IAAhC;AACH,KAjfI;;AAmfL;AACAC,yBAAqB,+BAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAR,aAAKC,UAAL,CAAgBO,mBAAhB,CAAoC,IAApC;AACH,KAlgBI;;AAogBL;AACAC,sBAAkB,4BAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAT,aAAKC,UAAL,CAAgBQ,gBAAhB,CAAiC,IAAjC;AACH,KAnhBI;;AAqhBL;AACAC,0BAAsB,8BAAUC,O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","file":"Game.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\nvar ThirdAPI = require('./common/ThirdAPI')\nvar Tmp = require('Tmp')\nvar TmpOne = require('TmpOne')\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        girdRoot: {\n            default: null,\n            type: cc.Prefab,\n        },\n        loadingUI: {\n            default: null,\n            type: cc.Node,\n        },\n        bannerCloseBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        //声音\n        btnSound: {\n            default: null,\n            type: cc.Prefab,\n        },\n        //提示文本\n        tipsNode: {\n            default: null,\n            type: cc.Node,\n        },\n\n        bannerAdInstance: null,\n    },\n\n    onLoad: function() {\n        console.log(\"***\", new Date().getTime());\n\n        //监听ip开关\n        listenUtil.eventCtrl.addListen('cdnchange', this.loadIp.bind(this));\n\n        //记载游戏打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.loadGame, null);\n\n        Global.game = this.getComponent('Game');\n        this.tipsNode.active = false;\n\n        var myUtil = require('myUtil');\n        myUtil.resetInitData();\n        //记录登录时的时间\n        Global.loginDateStr = (new Date()).toDateString();\n\n        // tcpManager.websocket.init();\n        // tcpManager.sendCmd.lisiner();\n\n        this.startLoadRes();\n\n        //请求cdn数据\n        var httpUtils = this.getComponent('httpUtils');\n        var self = this;\n        httpUtils.httpGets('https://sanxqn.nalrer.cn/tysanxiao/my2048/my2048config6.json', function (data) {\n            try {\n                if (data === -1) {\n                    //self.startLoadRes();\n                    console.log('请检查网络！');\n                } else {\n                    var jsonData = JSON.parse(data);\n                    console.log(\"jsonData:\", jsonData);\n                    if (jsonData) {\n                        //cdn开关配置\n                        if (jsonData.cdnGameConfig) {\n                            Global.cdnGameConfig = jsonData.cdnGameConfig;\n                        } else {\n                            console.log('读取cdn文件错误，取本地数据');\n                        }\n                        //banner广告配置\n                        if (jsonData.bannerAdConfig) {\n                            // Global.bannerAdConfig = jsonData.bannerAdConfig;\n                        }\n                        //复活消除行数\n                        if (jsonData.reviveConfig) {\n                            if (jsonData.reviveConfig.clearVNum) {\n                                Global.clearVNum = jsonData.reviveConfig.clearVNum;\n                            }\n                        }\n                        //add添加钻石数量\n                        if (jsonData.startConfig) {\n                            Global.startConfig = jsonData.startConfig;\n                        }\n                    }\n                    listenUtil.eventCtrl.trigger('cdnchange', null);\n                    console.log('Global.cdnGameConfig.totalSwith:' + Global.cdnGameConfig.totalSwith, Global.bannerAdConfig.swith);\n                    //self.startLoadRes();\n                }\n            } catch (error) {\n                //self.startLoadRes();\n                console.log(error);\n            }\n        });\n        console.log('startgame', Global.cdnGameConfig);\n        listenUtil.eventCtrl.trigger('cdnchange', null);\n\n        //请求内链图\n        httpUtils.httpGets('https://sanxqn.nalrer.cn/tysanxiao/my2048/linkImages/linkImages.json', function (data) {\n            if (data === -1) {\n                console.log('请检查网络！');\n            } else {\n                console.log('从CDN获取内敛图数据');\n                var jsonData = JSON.parse(data);\n                console.log(jsonData);\n                Global.linkImages = jsonData.linkImages;\n                console.log(Global.linkImages);\n            }\n        });\n\n        // 请求cdn分享图数据\n        httpUtils.httpGets('https://sanxqn.nalrer.cn/tysanxiao/my2048/shareInfo.json', function (data) {\n            if (data === -1) {\n                console.log('请检查网络！');\n            } else {\n                console.log('从CDN获取分享图数据');\n                var jsonData = JSON.parse(data);\n                console.log(jsonData);\n                Global.cdnShareImages = jsonData.shareImages;\n                Global.cdnTexts = jsonData.shareTexts;\n\n                if (jsonData.propShareImages) {\n                    Global.propShareImages = jsonData.propShareImages;\n                }\n                if (jsonData.propShareTexts) {\n                    Global.propShareTexts = jsonData.propShareTexts;\n                }\n                console.log('道具分享图片配置文件：', Global.propShareImages);\n\n                console.log(Global.cdnShareImages);\n            }\n        });\n\n        //请求掉率配置文件\n        httpUtils.httpGets('https://sanxqn.nalrer.cn/tysanxiao/my2048/weightConfig.json', function (data) {\n            try {\n                if (data === -1) {\n                    self.loadWeightConfig();\n                    console.log('请检查网络！');\n                } else {\n                    var jsonData = JSON.parse(data);\n                    console.log(\"jsonData:\", jsonData);\n                    if (jsonData && jsonData.weightConfig) {\n                        Global.weightConfig = jsonData.weightConfig;\n                        console.log('从cdn读取掉率成功：', Global.weightConfig);\n                    } else {\n                        self.loadWeightConfig();\n                    }\n                }\n            } catch (error) {\n                self.loadWeightConfig();\n                console.log('aaaaa:', error);\n            }\n        });\n\n        //请求每日挑战json数据\n        httpUtils.httpGets('https://sanxqn.nalrer.cn/tysanxiao/my2048/grids.json', function (data) {\n            try {\n                if (data === -1) {\n                    self.loadDailyConfig();\n                    console.log('请检查网络！');\n                } else {\n                    var jsonData = JSON.parse(data);\n                    console.log(\"daily jsonData:\", jsonData);\n                    if (jsonData) {\n                        Global.dailyConfig = jsonData;\n                        console.log('从cdn读取每日挑战关卡成功：', Global.dailyConfig);\n                    } else {\n                        self.loadDailyConfig();\n                    }\n                }\n            } catch (error) {\n                self.loadDailyConfig();\n                console.log(error);\n            }\n        });\n    },\n\n    loadingGame: function () {\n        // 加载界面/ReadyGo\n        this.loadingUI.opacity = 0;\n        this.loadingUI.active = true;\n        var self = this;\n        this.loadingUI.runAction(cc.sequence(\n            cc.fadeIn(1),\n            cc.delayTime(1),\n            cc.fadeOut(1),\n            cc.callFunc(function () {\n                self.loadingUI.active = false;\n\n                console.log(\"***3\", new Date().getTime());\n                //记录成功进入游戏打点\n                var biManager = require('biManager');\n                biManager.bilog(biManager.enterGame, null);\n                self.startGame();\n                self.getProp();\n                self.setTest();\n    \n                //初始化好友排行\n                ThirdAPI.initFriendRank();\n            })\n        ));\n    },\n\n    //IP地址检测\n    loadIp: function () {\n        if (Global.cdnGameConfig.banSwtich) {\n            var httpUtils = this.getComponent('httpUtils');\n            var self = this;\n            httpUtils.sendHttpRequest('https://pv.sohu.com/cityjson?ie=utf-8', (xhr) => {\n                console.log('getIp', xhr);\n            var result = JSON.parse(xhr.responseText.replace(/var returnCitySN = /g, '').replace(/;/g, ''));\n            console.log('result ', result);\n            // self.ipresult = result;\n            // self.lbl_info.string = \"IP:%s1\\ncity:%s2\".replace(/%s1/g, result.cip).replace(/%s2/g, result.cname);\n            var city = result.cname;\n            var isBan = false;\n            console.log('banlist', Global.cdnGameConfig.banList);\n\n            for (var i = 0; i < Global.cdnGameConfig.banList.length; i++) {\n                const str = Global.cdnGameConfig.banList[i];\n                console.log('is city', str);\n                if (city.search(str) != -1) {\n                    console.log('目标所在', str);\n                    isBan = true;\n                    break;\n                }\n            }\n            console.log('is Ban', isBan);\n\n            if (isBan) {\n                // Global.cdnGameConfig.totalSwith = false;\n                console.log('目标区域,设置config', Global.cdnGameConfig)\n            }\n\n            listenUtil.eventCtrl.trigger('IPCheckSuccess', null);\n            //self.startLoadRes();\n        }, (error) => {\n                console.log('error', error);\n            })\n        } else {\n\n        }\n    },\n\n    //开始加载资源并启动游戏\n    startLoadRes: function () {\n        console.log(\"***2\", new Date().getTime());\n        var self = this;\n        Global.shareManager = require('./common/shareManager');\n        Global.LoadAtlas = require(\"LoadAtlas\");\n        Global.LoadAtlas.loadAtlasRes(\"textures/gridItem/skins\", function () {});\n        Global.LoadAtlas.loadAtlasRes(\"textures/gridItem/items\", function () {\n            self.loadingGame();\n        });\n    },\n\n    setTest: function () {\n       \n    },\n\n    //加载本地掉率配置文件\n    loadWeightConfig: function () {\n        cc.loader.loadRes('weightConfig', function (err, data) {\n            Global.weightConfig = data.weightConfig;\n            console.log('读取本地掉率json文件', Global.weightConfig.oneWeightRate, Global.weightConfig.oneTotalWeight);\n        });\n    },\n\n    //加载本地每日挑战的关卡数据\n    loadDailyConfig: function () {\n        cc.loader.loadRes('grids', function (err, data) {\n            Global.dailyConfig = data;\n            console.log(\"读取本地掉率json文件\", data);\n        });\n    },\n\n    //判断是否从群里面点击进入，有额外奖励道具\n    getProp: function () {\n        console.log('检测是否从微信群进入...');\n        var retCode = ThirdAPI.isFromGroup();\n        if (retCode != -1) {\n            console.log('是从微信群进入...');\n            //Global.uiScript.startUI.getComponent('startUI').playGetGoldEffect();\n            if (retCode == 1) {\n                //点击得清除道具\n                if (Global.gameinfo.clearPropNum >= Global.clearPropLimit) {\n                    Global.game.showDialogPropText('道具数量已达上限！');\n                } else {\n                    console.log('获得消除锤锤一个');\n                    Global.game.showDialogPropText('恭喜获得消除锤锤道具一个！回赠给好友一个吧！');\n                    Global.gameinfo.clearPropNum++;\n                    ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n                }\n            } else if (retCode == 2) {\n                //点击得万能道具\n                if (Global.gameinfo.superPropNum >= Global.superPropLimit) {\n                    Global.game.showDialogPropText('道具数量已达上限！');\n                } else {\n                    console.log('获得万能道具一个');\n                    Global.game.showDialogPropText('恭喜获得万能道具一个！回赠给好友一个吧！');\n                    Global.gameinfo.superPropNum++;\n                    ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n                }\n            } else if (retCode == 3) {\n                //点击得双倍道具\n                if (Global.gameinfo.doublePropNum >= Global.doublePropLimit) {\n                    Global.game.showDialogPropText('道具数量已达上限！');\n                } else {\n                    Global.game.showDialogPropText('恭喜获得双倍道具一个！回赠给好友一个吧！');\n                    Global.gameinfo.doublePropNum++;\n                    ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n                }\n            } else if (retCode == 4) {\n                Global.game.showDialogPropText('恭喜获得钻石！回赠给好友一个吧！');\n\n                if (typeof wx !== 'undefined') {\n                    /* var data = ThirdAPI.loadLocalScore();\n                     var score = parseInt(data.maxscore);\n                     var gold = parseInt(data.gold);\n                     ThirdAPI.loadScore((maxscore, gold) => {\n                         score = parseInt(maxscore);\n                         gold = parseInt(gold);\n                         console.log('game on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n                     });\n                     Global.wxGold += 30;\n                     ThirdAPI.saveScore(score, Global.wxGold);*/\n                    console.log(\"加钻石1\");\n                    if (Global.startUI) {\n                        console.log(\"加钻石2\");\n                        setTimeout(() => {\n                            Global.startUI.updateGold(30);\n                        }, 100);\n                    } else {\n                        console.log(\"加钻石3\");\n                        if (Global.startUI) {\n                            setTimeout(() => {\n                                Global.startUI.updateGold(30);\n                            }, 500);\n                        }\n                    }\n                }\n            }\n        } else {\n            console.log('不是从微信群进入...');\n        }\n    },\n\n    //加钻石存本地功能\n    addStone: function (stoneNum, msg) {\n        console.log(\"好友互助 加钻石1\");\n        if (Global.startUI) {\n            console.log(\"好友互助 加钻石2\");\n            Global.game.showDialogPropText(msg);\n            Global.startUI.updateGold(stoneNum);\n        } else {\n            console.log(\"好友互助 加钻石3\");\n            var self = this;\n            setTimeout(() => {\n                self.addStone(stoneNum);\n            }, 100);\n        }\n    },\n\n    // 清除游戏缓存数据\n    clearGameInfo: function () {\n        ThirdAPI.clearFriendGenStoneInfo();\n    },\n\n    //开始游戏\n    startGame: function () {\n        var self = this;\n        Global.LoadAtlas.loadPrefab('UIRoot', (uiRootPrefab) => {\n            if (!Global.uiScript) {\n                Global.uiScript = cc.instantiate(uiRootPrefab).getComponent(\"uiRoot\");\n            }\n            //如果有父节点则删除自身节点\n            if (Global.uiScript.node.parent) {\n                Global.uiScript.node.parent.removeChild(Global.uiScript.node);\n            }\n            Global.uiScript.showStartUI();\n\n            if (Global.startUI) {\n                console.log('监听开始界面的cdn数据变化');\n                listenUtil.eventCtrl.addListen('cdnchange', Global.startUI.cdnchange.bind(this));\n            }\n\n            self.node.addChild(Global.uiScript.node);\n\n            self.initStoreData();\n            self.initTitleData();\n\n            self.initUIData();\n        });\n    },\n\n    //显示分享界面\n    showShareWindow: function () {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('UIRoot', (uiRootPrefab) => {\n        //     if (!Global.uiScript) {\n        //         Global.uiScript = cc.instantiate(uiRootPrefab).getComponent(\"uiRoot\");\n        //     }\n        //     //如果有父节点则删除自身节点\n        //     if (Global.uiScript.node.parent) {\n        //         Global.uiScript.node.parent.removeChild(Global.uiScript.node);\n        //     }\n        //     self.node.addChild(Global.uiScript.node);\n        //     Global.uiScript.showShareWindow();\n        // });\n        wdfk.GlobalFunc.showShareWindow(this);\n    },\n\n    //显示排行榜界面\n    showRankWindow: function (canShowGameClub) {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('rankUI', (rankPrefab) => {\n        //     if (!Global.rankui) {\n        //         Global.rankui = cc.instantiate(rankPrefab).getComponent(\"rankUI\");\n        //     }\n        //     if (Global.rankui.node.parent) {\n        //         Global.rankui.node.parent.removeChild(Global.rankui.node);\n        //     }\n        //     self.node.addChild(Global.rankui.node);\n        //     Global.rankui.initData(canShowGameClub);\n        // });\n        wdfk.GlobalFunc.showRankWindow(this,canShowGameClub);\n    },\n\n    showGroupRankWindow: function (canShowGameClub) {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('rankUI', (rankPrefab) => {\n        //     if (!Global.rankui) {\n        //         Global.rankui = cc.instantiate(rankPrefab).getComponent(\"rankUI\");\n        //     }\n        //     if (Global.rankui.node.parent) {\n        //         Global.rankui.node.parent.removeChild(Global.rankui.node);\n        //     }\n        //     self.node.addChild(Global.rankui.node);\n        //     Global.rankui.initGetGroupRank(canShowGameClub);\n        // });\n        wdfk.GlobalFunc.showGroupRankWindow(this,canShowGameClub);\n    },\n\n    //显示商店界面\n    showStoreWindow: function () {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('UIStore', (storePrefab) => {\n        //     if (!Global.storeUI) {\n        //         Global.storeUI = cc.instantiate(storePrefab).getComponent(\"UIStore\");\n        //     }\n        //     if (Global.storeUI.node.parent) {\n        //         Global.storeUI.node.parent.removeChild(Global.storeUI.node);\n        //     }\n        //     self.node.addChild(Global.storeUI.node);\n        //     Global.storeUI.initData();\n        //     //记载成功进入皮肤打点\n        //     var biManager = require('biManager');\n        //     biManager.bilog(biManager.skin, null);\n        // });\n        wdfk.GlobalFunc.showStoreWindow(this);\n    },\n\n    //显示复活界面\n    showReviveWindow: function () {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('reviveUI', (revivePrefab) => {\n        //     if (!Global.reviveUI) {\n        //         Global.reviveUI = cc.instantiate(revivePrefab).getComponent(\"reviveUI\");\n        //     }\n        //     if (Global.reviveUI.node.parent) {\n        //         Global.reviveUI.node.parent.removeChild(Global.reviveUI.node);\n        //     }\n        //     self.node.addChild(Global.reviveUI.node);\n        //     Global.reviveUI.initData();\n        // });\n        wdfk.GlobalFunc.showReviveWindow(this);\n    },\n\n    //显示成就界面\n    showTitleWindow: function () {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('UITitle', (titlePrefab) => {\n        //     if (!Global.titleUI) {\n        //         Global.titleUI = cc.instantiate(titlePrefab).getComponent(\"UITitle\");\n        //     }\n        //     if (Global.titleUI.node.parent) {\n        //         Global.titleUI.node.parent.removeChild(Global.titleUI.node);\n        //     }\n        //     self.node.addChild(Global.titleUI.node);\n        //     Global.titleUI.initData();\n        //     if (Global.titleUI) {\n        //         Global.titleUI.onClose();\n        //     }\n        // });\n        wdfk.GlobalFunc.showTitleWindow(this);\n    },\n\n    //显示成就查看界面\n    showTitleInfoWindow: function () {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('UITitleInfo', (titleInfoPrefab) => {\n        //     if (!Global.titleInfoUI) {\n        //         Global.titleInfoUI = cc.instantiate(titleInfoPrefab).getComponent(\"UITitleInfo\");\n        //     }\n        //     if (Global.titleInfoUI.node.parent) {\n        //         Global.titleInfoUI.node.parent.removeChild(Global.titleInfoUI.node);\n        //     }\n        //     self.node.addChild(Global.titleInfoUI.node);\n        //     Global.titleInfoUI.initData();\n        // });\n\n        wdfk.GlobalFunc.showTitleInfoWindow(this);\n    },\n\n    //弹出好友互助奖励界面\n    showRewardWindow: function () {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('rewardInfo', (rewardPrefab) => {\n        //     if (!Global.rewardUI) {\n        //         Global.rewardUI = cc.instantiate(rewardPrefab).getComponent(\"rewardUI\");\n        //     }\n        //     if (Global.rewardUI.node.parent) {\n        //         Global.rewardUI.node.parent.removeChild(Global.rewardUI.node);\n        //     }\n        //     self.node.addChild(Global.rewardUI.node);\n        //     //tcpManager.sendCmd.sendGetClickUserList();\n        //     Global.rewardUI.initData();\n        // });\n        wdfk.GlobalFunc.showRewardWindow(this);\n    },\n\n    //显示道具分享弹框\n    showPropDialogWindow: function (isChest, showText, parmaIndex) {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('propInfo', (propInfoPrefab) => {\n        //     if (!Global.propInfoUI) {\n        //         Global.propInfoUI = cc.instantiate(propInfoPrefab).getComponent(\"UIPropInfo\");\n        //     }\n        //     if (Global.propInfoUI.node.parent) {\n        //         Global.propInfoUI.node.parent.removeChild(Global.propInfoUI.node);\n        //     }\n        //     self.node.addChild(Global.propInfoUI.node);\n        //     Global.propInfoUI.initData(isChest, showText, parmaIndex);\n        // });\n\n        wdfk.GlobalFunc.showPropDialogWindow(this,isChest, showText, parmaIndex);\n    },\n\n    //显示道具数量不足，拉起分享界面\n    showAddPropDialogWindow: function (parma) {\n        // var self = this;\n        // Global.LoadAtlas.loadPrefab('addPropInfo', (addPropInfoPrefab) => {\n        //     if (!Global.addPropInfoUI) {\n        //         Global.addPropInfoUI = cc.instantiate(addPropInfoPrefab).getComponent(\"addPropInfo\");\n        //     }\n        //     if (Global.addPropInfoUI.node.parent) {\n        //         Global.addPropInfoUI.node.parent.removeChild(Global.addPropInfoUI.node);\n        //     }\n        //     this.node.addChild(Global.addPropInfoUI.node);\n        //     Global.addPropInfoUI.initData(parma);\n        // });\n        wdfk.GlobalFunc.showAddPropDialogWindow(this,parma);\n    },\n\n    //初始化ui信息\n    initUIData: function () {\n        //初始化商城数据\n        var self = this;\n        Global.LoadAtlas.loadPrefab('UIStore', (storePrefab) => {\n            if (!Global.storeUI) {\n                Global.storeUI = cc.instantiate(storePrefab).getComponent(\"UIStore\");\n            }\n            if (Global.storeUI.node.parent) {\n                Global.storeUI.node.parent.removeChild(Global.storeUI.node);\n            }\n            self.node.addChild(Global.storeUI.node);\n            Global.storeUI.initData();\n\n            if (Global.storeUI) {\n                Global.storeUI.onClose();\n            }\n\n            self.showTitleWindow();\n            if (Global.titleUI) {\n                Global.titleUI.onClose();\n            }\n\n            //Global.titleUI.updateItemsState(1);\n            //Global.titleUI.updateItemsState(2);\n            //Global.titleUI.updateItemsState(3);\n        });\n    },\n\n    //加载已购皮肤数据\n    initStoreData: function () {\n        //ThirdAPI.clearInfo('skinstore');\n        Global.storeData = ThirdAPI.loadInfo('skinstore');\n        if (Global.storeData == null) {\n            Global.storeData = [];\n        }\n\n        //ThirdAPI.saveScore(0, 0);\n\n        //ThirdAPI.clearCurrentSkin();\n        Global.skinIndex = ThirdAPI.loadCurrentSkin();\n        //console.log('current skin index : ', Global.skinIndex);\n    },\n\n    //加载成就数据\n    initTitleData: function () {\n        //ThirdAPI.clearInfo('title');\n        //Global.titleData = ThirdAPI.loadInfo('title');\n        if (Global.titleData == null) {\n            Global.titleData = [];\n        }\n\n        //ThirdAPI.clearInfo('title-date');\n        //Global.titleDateData = ThirdAPI.loadInfo('title-date');\n        if (Global.titleDateData == null) {\n            Global.titleDateData = [];\n        }\n\n        //ThirdAPI.clearInfo('title-unlock');\n        //Global.titleUnlockData = ThirdAPI.loadInfo('title-unlock');\n        if (Global.titleUnlockData == null) {\n            Global.titleUnlockData = [];\n        }\n\n        //ThirdAPI.clearInfo('title-unlock');\n        Global.shareData = ThirdAPI.loadShareData();\n        var d = new Date(Date.now());\n        if (!Global.shareData) {\n            //console.log('无分享限制数据，初始化');\n            var d1 = new Date(Date.now());\n            //console.log(d1.toDateString());\n            Global.shareData = {\n                shareTimes: 0,\n                shareDate: d1.toDateString()\n            }\n            ThirdAPI.saveShareData(Global.shareData.shareTimes, Global.shareData.shareDate);\n        } else if (Global.shareData.shareDate != d.toDateString()) {\n            //console.log('无今日分享限制数据，初始化');\n            Global.shareData = {\n                shareTimes: 0,\n                shareDate: d.toDateString()\n            }\n\n            ThirdAPI.saveShareData(Global.shareData.shareTimes, Global.shareData.shareDate);\n        }\n\n        //获取系统日期\n        //var d1 = new Date(Date.now());\n        //console.log(d1.toDateString());\n    },\n\n    // 存储分数到服务器\n    saveScore: function () {\n        //更新金币并存储\n        if (typeof wx !== 'undefined') {\n            var data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                //console.log('gridController on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n            });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n        if (Global.startUI) {\n            Global.startUI.updateGold(0);\n        }\n    },\n\n    //道具提示文本\n    showDialogPropText: function (text) {\n        this.tipsNode.active = true;\n        this.tipsNode.setLocalZOrder(10);\n        this.tipsNode.stopAllActions();\n        var label = this.tipsNode.getChildByName('label');\n        label.getComponent(cc.Label).string = text;\n        this.tipsNode.getChildByName(\"sprite\").width = cc.find('Canvas').width;\n\n        setTimeout(() => {\n            this.tipsNode.active = false;\n        }, 2000);\n    },\n\n    //分享完的提示文字\n    showDialogText: function (text, p) {\n        //总开关判断\n        if (!Global.cdnGameConfig.totalSwith) {\n            console.log('开关已打开，不显示文字提示');\n            return;\n        }\n        this.tipsNode.active = true;\n        this.tipsNode.setLocalZOrder(10);\n        this.tipsNode.stopAllActions();\n        // this.tipsNode.x = p.x;\n        // this.tipsNode.y = p.y;\n        var label = this.tipsNode.getChildByName('label');\n        label.getComponent(cc.Label).string = text;\n        this.tipsNode.getChildByName(\"sprite\").width = cc.find('Canvas').width;\n\n        setTimeout(() => {\n            this.tipsNode.active = false;\n        }, 2000);\n    },\n\n    //播放声音\n    playSound: function (sname, volume) {\n        if (!Global.isSoundPlaying) {\n            return;\n        }\n        var self = this;\n        cc.loader.loadRes(\"audio/\" + sname, cc.AudioClip, function (err, clip) {\n            var sound = cc.instantiate(self.btnSound);\n            self.node.addChild(sound);\n            var audioSource = sound.getComponent(cc.AudioSource);\n            audioSource.clip = clip;\n            audioSource.volume = volume;\n            audioSource.play();\n        });\n    },\n\n    switchSound: function () {\n        Global.isSoundPlaying = !Global.isSoundPlaying;\n    },\n\n    //重新开始\n    restart: function () {\n        this.enterScene();\n    },\n\n    //打开游戏战斗界面\n    enterScene: function (list) {\n        var self = this;\n        Global.LoadAtlas.loadPrefab('gridRoot', (girdRoot) => {\n            if (!Global.gridController) {\n                Global.gridController = cc.instantiate(girdRoot);\n            }\n            if (Global.gridController.parent) {\n                Global.gridController.parent.removeChild(Global.gridController);\n            }\n            self.node.addChild(Global.gridController);\n            Global.gridController.getComponent(\"gridController\").initGridData(list);\n        });\n    },\n\n    /*\n        creatBannerAdBtn: function () {\n            this.bannerAdInstance = cc.instantiate(this.bannerCloseBtn);\n            this.bannerAdInstance.setLocalZOrder(100);\n            this.node.addChild(this.bannerAdInstance);\n\n            this.bannerAdInstance.active = false;\n        },\n\n        //显示或者隐藏banner广告\n        showOrHideBannerAd: function (parma) {\n            if (!parma) {\n                return;\n            }\n            //var pos = parma.pos;\n\n            var spriteFrame = this.bannerAdInstance.getComponent(cc.Sprite).spriteFrame;\n            var width = spriteFrame.getRect().width;\n            var height = spriteFrame.getRect().height;\n\n            this.bannerAdInstance.setPosition(cc.p(parma.x - width, parma.y - height));\n            // this.bannerAdInstance.setPosition(cc.p(0, 0));\n            this.bannerAdInstance.setLocalZOrder(10000);\n            this.bannerAdInstance.active = true;\n            console.log('******');\n\n            this.showBannerAd();\n        },\n\n        showBannerAd: function () {\n            if (this.bannerAdInstance) {\n                this.bannerAdInstance.active = true;\n            }\n        },\n        hideBannerAd: function () {\n            if (this.bannerAdInstance) {\n                this.bannerAdInstance.active = false;\n            }\n            var wxBannerAd = require('wxBannerAd');\n            wxBannerAd.hideBannerAd();\n        },\n    */\n\n});"]}