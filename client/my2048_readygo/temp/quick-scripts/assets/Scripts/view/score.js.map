{"version":3,"sources":["score.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","curLabel","default","type","Label","scoreNum","showScore","hasResetWeight2","hasResetWeight3","hasResetWeight4","hasResetWeight5","setShowScore","addNum","string","addScore","console","log","Global","isDailyLimit","gameinfo","myUtil","resetInitData","dailyTime","Date","getTime","dailyScore","saveFriendGenStoneInfo","wxScore","wxGold","saveScore","weightConfig","oneGearScore","twoGearScore","randomForWeight","twoWeightRate","twoTotalWeight","threeGearScore","threeWeightRate","threeTotalWeight","fourGearScore","fourWeightRate","fourTotalWeight","fiveWeightRate","fiveTotalWeight","scaleAction","node","stopAllActions","scale","bigAction","scaleTo","smallAction","runAction","sequence","update","dt","reset"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,WAAWC,QAAQ,oBAAR,CAAf;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAAU;AACNC,qBAAS,IADH;AAENC,kBAAMP,GAAGQ;AAFH,SADF;AAKRC,kBAAU,CALF;AAMRC,mBAAW,CANH;;AAQRC,yBAAiB,KART;AASRC,yBAAiB,KATT;AAURC,yBAAiB,KAVT;AAWRC,yBAAiB;AAXT,KAHP;;AAiBLC,kBAAa,sBAASC,MAAT,EAAgB;AACzB,aAAKN,SAAL,GAAiBM,MAAjB;AACA;AACA,aAAKX,QAAL,CAAcY,MAAd,GAAuB,KAAKP,SAA5B;AACH,KArBI;;AAuBLQ,cAAU,kBAAUF,MAAV,EAAkB;AACxBG,gBAAQC,GAAR,CAAY,MAAZ;AACA,aAAKX,QAAL,IAAiBO,MAAjB;AACA;AACA,YAAIK,OAAOC,YAAX,EAAyB;AACrB,gBAAI,CAACD,OAAOE,QAAZ,EAAsB;AAClB,oBAAIC,SAASzB,QAAQ,QAAR,CAAb;AACAyB,uBAAOC,aAAP;AACH;AACD;AACAJ,mBAAOE,QAAP,CAAgBG,SAAhB,GAA6B,IAAIC,IAAJ,EAAD,CAAaC,OAAb,EAA5B;AACA,gBAAIP,OAAOE,QAAP,IAAmB,CAACF,OAAOE,QAAP,CAAgBM,UAAxC,EAAoD;AAChDR,uBAAOE,QAAP,CAAgBM,UAAhB,GAA6B,CAA7B;AACH;AACD,gBAAI,KAAKpB,QAAL,GAAgBY,OAAOE,QAAP,CAAgBM,UAApC,EAAgD;AAC5CR,uBAAOE,QAAP,CAAgBM,UAAhB,GAA6B,KAAKpB,QAAlC;AACAX,yBAASgC,sBAAT,CAAgCT,OAAOE,QAAvC;AACH;AACJ,SAdD,MAcO;AACH,gBAAI,KAAKd,QAAL,GAAgBY,OAAOU,OAA3B,EAAoC;AAChCZ,wBAAQC,GAAR,CAAY,0BAAZ,EAAwCC,OAAOU,OAA/C,EAAwDV,OAAOW,MAA/D;AACAX,uBAAOU,OAAP,GAAiB,KAAKtB,QAAtB;AACAX,yBAASmC,SAAT,CAAmBZ,OAAOU,OAA1B,EAAmCV,OAAOW,MAA1C;AACH;AACD,gBAAIR,SAASzB,QAAQ,QAAR,CAAb;AACA;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAI,KAAKU,QAAL,GAAgBY,OAAOa,YAAP,CAAoBC,YAApC,IAAoD,KAAK1B,QAAL,IAAiBY,OAAOa,YAAP,CAAoBE,YAAzF,IAAyG,CAAC,KAAKzB,eAAnH,EAAoI;AAChIa,uBAAOa,eAAP,CAAuBhB,OAAOa,YAAP,CAAoBI,aAA3C,EAA0DjB,OAAOa,YAAP,CAAoBK,cAA9E;AACA,qBAAK5B,eAAL,GAAuB,IAAvB;AACAQ,wBAAQC,GAAR,CAAY,UAAZ,EAAwBC,OAAOa,YAAP,CAAoBC,YAA5C,EAA0Dd,OAAOa,YAAP,CAAoBE,YAA9E;AACH,aAJD,MAIO,IAAI,KAAK3B,QAAL,GAAgBY,OAAOa,YAAP,CAAoBE,YAApC,IAAoD,KAAK3B,QAAL,IAAiBY,OAAOa,YAAP,CAAoBM,cAAzF,IAA2G,CAAC,KAAK5B,eAArH,EAAsI;AACzIY,uBAAOa,eAAP,CAAuBhB,OAAOa,YAAP,CAAoBO,eAA3C,EAA4DpB,OAAOa,YAAP,CAAoBQ,gBAAhF;AACA,qBAAK9B,eAAL,GAAuB,IAAvB;AACAO,wBAAQC,GAAR,CAAY,UAAZ,EAAwBC,OAAOa,YAAP,CAAoBE,YAA5C,EAA0Df,OAAOa,YAAP,CAAoBM,cAA9E;AACH,aAJM,MAIA,IAAI,KAAK/B,QAAL,GAAgBY,OAAOa,YAAP,CAAoBM,cAApC,IAAsD,KAAK/B,QAAL,IAAiBY,OAAOa,YAAP,CAAoBS,aAA3F,IAA4G,CAAC,KAAK9B,eAAtH,EAAuI;AAC1IW,uBAAOa,eAAP,CAAuBhB,OAAOa,YAAP,CAAoBU,cAA3C,EAA2DvB,OAAOa,YAAP,CAAoBW,eAA/E;AACA,qBAAKhC,eAAL,GAAuB,IAAvB;AACAM,wBAAQC,GAAR,CAAY,UAAZ,EAAwBC,OAAOa,YAAP,CAAoBM,cAA5C,EAA4DnB,OAAOa,YAAP,CAAoBS,aAAhF;AACH,aAJM,MAIA,IAAI,KAAKlC,QAAL,GAAgBY,OAAOa,YAAP,CAAoBS,aAApC,IAAqD,CAAC,KAAK7B,eAA/D,EAAgF;AACnFU,uBAAOa,eAAP,CAAuBhB,OAAOa,YAAP,CAAoBY,cAA3C,EAA2DzB,OAAOa,YAAP,CAAoBa,eAA/E;AACA,qBAAKjC,eAAL,GAAuB,IAAvB;AACAK,wBAAQC,GAAR,CAAY,UAAZ,EAAwBC,OAAOa,YAAP,CAAoBS,aAA5C;AACH;AACJ;AACJ,KAtFI;;AAwFLK,iBAAa,uBAAY;AACrB,aAAKC,IAAL,CAAUC,cAAV;AACA,aAAKD,IAAL,CAAUE,KAAV,GAAkB,CAAlB;AACA,YAAIC,YAAYpD,GAAGqD,OAAH,CAAW,IAAX,EAAiB,GAAjB,CAAhB;AACA,YAAIC,cAActD,GAAGqD,OAAH,CAAW,GAAX,EAAgB,CAAhB,CAAlB;AACA,aAAKJ,IAAL,CAAUM,SAAV,CAAoBvD,GAAGwD,QAAH,CAAYJ,SAAZ,EAAuBE,WAAvB,CAApB;AACH,KA9FI;;AAgGLG,YAAQ,gBAASC,EAAT,EAAa;AACjB,YAAI,KAAKhD,SAAL,IAAkB,KAAKD,QAA3B,EAAqC;AACjC;AACH;;AAED,YAAI,KAAKA,QAAL,GAAgB,KAAKC,SAAL,GAAiB,GAArC,EAA0C;AACtC,iBAAKA,SAAL,IAAkB,EAAlB;AACH,SAFD,MAEO,IAAI,KAAKD,QAAL,GAAgB,KAAKC,SAAL,GAAiB,EAArC,EAAyC;AAC5C,iBAAKA,SAAL,IAAkB,EAAlB;AACH,SAFM,MAEA;AACH,iBAAKA,SAAL,IAAkB,CAAlB;AACH;AACD,aAAKL,QAAL,CAAcY,MAAd,GAAuB,KAAKP,SAA5B;AACH,KA7GI;;AA+GLiD,WAAO,iBAAY;AACf,aAAKlD,QAAL,GAAgB,CAAhB;AACA,aAAKC,SAAL,GAAiB,CAAC,CAAlB;AACA,aAAKC,eAAL,GAAuB,KAAvB;AACA,aAAKC,eAAL,GAAuB,KAAvB;AACA,aAAKC,eAAL,GAAuB,KAAvB;AACA,aAAKC,eAAL,GAAuB,KAAvB;AACH;AAtHI,CAAT","file":"score.js","sourceRoot":"../../../../../assets/Scripts/view","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\nvar ThirdAPI = require('../common/ThirdAPI');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        curLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        scoreNum: 0,\n        showScore: 0,\n\n        hasResetWeight2: false,\n        hasResetWeight3: false,\n        hasResetWeight4: false,\n        hasResetWeight5: false,\n    },\n\n    setShowScore:function(addNum){\n        this.showScore = addNum;\n        // this.scoreNum = addNum;\n        this.curLabel.string = this.showScore;\n    },\n\n    addScore: function (addNum) {\n        console.log('bbbb');\n        this.scoreNum += addNum;\n        //保存微信分数\n        if (Global.isDailyLimit) {\n            if (!Global.gameinfo) {\n                var myUtil = require('myUtil');\n                myUtil.resetInitData();\n            }\n            //是每日挑战\n            Global.gameinfo.dailyTime = (new Date()).getTime();\n            if (Global.gameinfo && !Global.gameinfo.dailyScore) {\n                Global.gameinfo.dailyScore = 0;\n            }\n            if (this.scoreNum > Global.gameinfo.dailyScore) {\n                Global.gameinfo.dailyScore = this.scoreNum;\n                ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n            }\n        } else {\n            if (this.scoreNum > Global.wxScore) {\n                console.log('from socre.js add score:', Global.wxScore, Global.wxGold);\n                Global.wxScore = this.scoreNum;\n                ThirdAPI.saveScore(Global.wxScore, Global.wxGold);\n            }\n            var myUtil = require('myUtil');\n            /*    //添加128的掉落数据\n                if (this.scoreNum > 6000 && !this.hasResetWeight2) {\n                    /* var randomScores = Global.gridRandomScores.concat(Global.joinRandomScores);\n                     var index = randomScores.indexOf(128);\n                     if (index <= -1) {\n                         Global.joinRandomScores.push(128);\n                     }\n                     console.log('array' + Global.joinRandomScores);*/\n\n\n            // myUtil.randomForWeight(Global.weightScores2);\n            // this.hasResetWeight2 = true;\n            // console.log('重设掉落概率2');\n            // }\n            // else if (this.scoreNum > 100000 && !this.hasResetWeight3) {\n            //     myUtil.randomForWeight(Global.weightScores2);\n            //     this.hasResetWeight3 = true;\n            //     console.log('重设掉落概率2');\n            // }*／\n\n            if (this.scoreNum > Global.weightConfig.oneGearScore && this.scoreNum <= Global.weightConfig.twoGearScore && !this.hasResetWeight2) {\n                myUtil.randomForWeight(Global.weightConfig.twoWeightRate, Global.weightConfig.twoTotalWeight);\n                this.hasResetWeight2 = true;\n                console.log('重设第二档掉率：', Global.weightConfig.oneGearScore, Global.weightConfig.twoGearScore);\n            } else if (this.scoreNum > Global.weightConfig.twoGearScore && this.scoreNum <= Global.weightConfig.threeGearScore && !this.hasResetWeight3) {\n                myUtil.randomForWeight(Global.weightConfig.threeWeightRate, Global.weightConfig.threeTotalWeight);\n                this.hasResetWeight3 = true;\n                console.log('重设第三档掉率：', Global.weightConfig.twoGearScore, Global.weightConfig.threeGearScore);\n            } else if (this.scoreNum > Global.weightConfig.threeGearScore && this.scoreNum <= Global.weightConfig.fourGearScore && !this.hasResetWeight4) {\n                myUtil.randomForWeight(Global.weightConfig.fourWeightRate, Global.weightConfig.fourTotalWeight);\n                this.hasResetWeight4 = true;\n                console.log('重设第四档掉率：', Global.weightConfig.threeGearScore, Global.weightConfig.fourGearScore);\n            } else if (this.scoreNum > Global.weightConfig.fourGearScore && !this.hasResetWeight5) {\n                myUtil.randomForWeight(Global.weightConfig.fiveWeightRate, Global.weightConfig.fiveTotalWeight);\n                this.hasResetWeight5 = true;\n                console.log('重设第五档掉率：', Global.weightConfig.fourGearScore);\n            }\n        }\n    },\n\n    scaleAction: function () {\n        this.node.stopAllActions();\n        this.node.scale = 1;\n        var bigAction = cc.scaleTo(0.15, 1.5);\n        var smallAction = cc.scaleTo(0.1, 1);\n        this.node.runAction(cc.sequence(bigAction, smallAction));\n    },\n\n    update: function(dt) {\n        if (this.showScore >= this.scoreNum) {\n            return;\n        }\n\n        if (this.scoreNum > this.showScore + 100) {\n            this.showScore += 20;\n        } else if (this.scoreNum > this.showScore + 20) {\n            this.showScore += 10;\n        } else {\n            this.showScore += 1;\n        }\n        this.curLabel.string = this.showScore;\n    },\n\n    reset: function () {\n        this.scoreNum = 0;\n        this.showScore = -1;\n        this.hasResetWeight2 = false;\n        this.hasResetWeight3 = false;\n        this.hasResetWeight4 = false;\n        this.hasResetWeight5 = false;\n    }\n});"]}