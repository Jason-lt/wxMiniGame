{"version":3,"sources":["../../../../../assets/Scripts/ui/assets/Scripts/ui/UITitle.js"],"names":["ThirdAPI","require","loadAtlas","cc","Class","extends","Component","properties","content","default","type","Node","buttonClose","titleitemPrefab","Prefab","labelComplete","Label","arrItems","itemHeight","onLoad","on","onClose","initStoreList","initData","initStore","i","Global","titleUnlockData","length","index","getComponent","setUnlock","titleData","uiScript","startUI","showRedDot","setIsHave","setDate","titleDateData","updateLabelComplete","titleArray","push","name","description","price","reward","item","instantiate","setTitle","setTitleType","setDescription","setPrice","setReward","setPosition","addChild","height","string","updateItemsState","titleType","list","updateCount","updateState","repeat","saveInfo","game","playSound","node","parent","removeChild"],"mappings":"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","file":"UITitle.js","sourceRoot":"../../../../../assets/Scripts/ui","sourcesContent":["let ThirdAPI = require('../common/ThirdAPI')\nvar loadAtlas = require(\"LoadAtlas\")\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // content 节点，商品列表Content\n        content: {\n            default: null,\n            type: cc.Node\n        },\n        // buttonClose 节点，关闭商店\n        buttonClose: {\n            default: null,\n            type: cc.Node\n        },\n        // 成就项\n        titleitemPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        // 完成数量标签\n        labelComplete: {\n            default: null,\n            type: cc.Label,\n        },\n        arrItems: [],\n        itemHeight: 100,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // start () {},\n\n    onLoad() {\n        // 注册按钮\n        this.buttonClose.on('click', this.onClose, this);\n\n        this.initStoreList();\n    },\n\n    // 初始化商店\n    initData: function() {\n        this.initStore();\n    },\n\n    // 初始化商店\n    initStore: function () {\n        \n        // 使用已达成但是未解锁成就列表标记商品\n        for (let i = 0; i < Global.titleUnlockData.length; i++) {\n            var index = Global.titleUnlockData[i];\n            this.arrItems[index].getComponent('TitleItem').setUnlock();\n        }\n        //console.log('是否有未解锁', Global.titleUnlockData.length);\n        if (Global.titleUnlockData.length>Global.titleData.length) {\n            //console.log('红点显示');\n            Global.uiScript.startUI.getComponent('startUI').showRedDot(true);\n        }\n\n        // 使用已购商品数据标记已经拥有商品\n        for (let i = 0; i < Global.titleData.length; i++) {\n            var index = Global.titleData[i];\n            this.arrItems[index].getComponent('TitleItem').setIsHave();\n            this.arrItems[index].getComponent('TitleItem').setDate(Global.titleDateData[i]);\n        }\n        this.updateLabelComplete();\n        //console.log('初始化列表数据');\n    },\n\n    // 初始化商店列表\n    initStoreList: function () {\n        var titleArray = [];\n        \n        titleArray.push({type : 1, name : \"分数小白\", description : \"单局得分达到\", price : 2000,   reward : 2});\n        titleArray.push({type : 1, name : \"分数菜鸟\", description : \"单局得分达到\", price : 5000,   reward : 4});\n        titleArray.push({type : 1, name : \"分数达人\", description : \"单局得分达到\", price : 8000,   reward : 8});\n        titleArray.push({type : 1, name : \"分数高手\", description : \"单局得分达到\", price : 10000,  reward : 16});\n        titleArray.push({type : 1, name : \"分数大师\", description : \"单局得分达到\", price : 15000,  reward : 32});\n        titleArray.push({type : 1, name : \"分数王者\", description : \"单局得分达到\", price : 20000,  reward : 64});\n\n        titleArray.push({type : 2, name : \"皮肤小白\", description : \"皮肤解锁达到\", price : 1,      reward : 1});\n        titleArray.push({type : 2, name : \"皮肤菜鸟\", description : \"皮肤解锁达到\", price : 3,      reward : 5});\n        titleArray.push({type : 2, name : \"皮肤达人\", description : \"皮肤解锁达到\", price : 8,      reward : 8});\n        titleArray.push({type : 2, name : \"皮肤高手\", description : \"皮肤解锁达到\", price : 10,     reward : 10});\n        titleArray.push({type : 2, name : \"皮肤大师\", description : \"皮肤解锁达到\", price : 15,     reward : 18});\n        titleArray.push({type : 2, name : \"皮肤王者\", description : \"皮肤解锁达到\", price : 20,     reward : 20});\n\n        titleArray.push({type : 3, name : \"成就小白\", description : \"成就解锁达到\", price : 1,      reward : 5});\n        titleArray.push({type : 3, name : \"成就达人\", description : \"成就解锁达到\", price : 5,      reward : 10});\n        titleArray.push({type : 3, name : \"成就王者\", description : \"成就解锁达到\", price : 15,     reward : 20});\n\n        /*\n        titleArray.push('分数菜鸟');\n        titleArray.push('分数达人');\n        titleArray.push('分数高手');\n        titleArray.push('分数大师');\n        titleArray.push('分数王者');\n\n        titleArray.push('皮肤小白');\n        titleArray.push('皮肤菜鸟');\n        titleArray.push('皮肤达人');\n        titleArray.push('皮肤高手');\n        titleArray.push('皮肤大师');\n        titleArray.push('皮肤王者');\n\n        titleArray.push('成就小白');\n        titleArray.push('成就达人');\n        titleArray.push('成就王者');*/\n\n        for (let index = 0; index < titleArray.length; index++) {\n            var item = cc.instantiate(this.titleitemPrefab);\n            /*\n            if (index <= 5) {\n                item.getComponent('TitleItem').setTitleType(1);\n                item.getComponent('TitleItem').setDescription('单局得分达到' + (index+1) * 1000);\n                item.getComponent('TitleItem').setPrice((index+1) * 1000);\n            }\n            else if (index <= 11) {\n                item.getComponent('TitleItem').setTitleType(2);\n                item.getComponent('TitleItem').setDescription('皮肤解锁达到' + (index-5));\n                item.getComponent('TitleItem').setPrice(index-5);\n            }\n            else if (index <= 17) {\n                item.getComponent('TitleItem').setTitleType(3);\n                item.getComponent('TitleItem').setDescription('成就解锁达到' + (index-11)*4);\n                item.getComponent('TitleItem').setPrice((index-11)*4);\n            }\n            */\n\n            item.getComponent('TitleItem').setTitle(titleArray[index].name);\n            item.getComponent('TitleItem').setTitleType(titleArray[index].type);\n            item.getComponent('TitleItem').setDescription(titleArray[index].description + titleArray[index].price);\n            item.getComponent('TitleItem').setPrice(titleArray[index].price);\n            item.getComponent('TitleItem').setReward(titleArray[index].reward);\n            item.getComponent('TitleItem').index = index;\n            item.setPosition(0, -1 * (index+0.5) * this.itemHeight);\n\n            this.content.addChild(item);\n            this.arrItems.push(item);\n        }\n        this.content.height = titleArray.length * this.itemHeight;\n    },\n\n    // 更新完成数量\n    updateLabelComplete: function() {\n        this.labelComplete.string = '完成数量' + Global.titleData.length + '/' + this.arrItems.length;\n    },\n\n    // 更新列表成就状态（是否可以解锁）\n    updateItemsState: function(titleType) {\n        //console.log('解锁通知');\n        var list = this.arrItems;\n        var updateCount = 0;\n        for (let index = 0; index < list.length; index++) {\n            if (list[index].getComponent('TitleItem').updateState(titleType)) {\n                updateCount++;\n\n                var repeat = false;\n                for (var i = 0; i < Global.titleUnlockData.length; i++) {\n                    if (index == Global.titleUnlockData[i]) {\n                        repeat = true;\n                        break;\n                    }\n                }\n                if (!repeat) {\n                    Global.titleUnlockData.push(index);\n                    ThirdAPI.saveInfo('title-unlock', Global.titleUnlockData);\n                }                \n            }\n        }\n\n        if (updateCount>0) {\n            // 通知有可以解锁的成就\n            //console.log('通知有可以解锁的成就', updateCount);\n            Global.uiScript.startUI.getComponent('startUI').showRedDot(true);\n        }\n        else {\n            Global.uiScript.startUI.getComponent('startUI').showRedDot(false);\n        }\n    },\n\n    // 按钮回调：关闭\n    onClose: function () {\n        Global.game.playSound('btn', 0.1);\n        //console.log(\"关闭成就\");\n\n        if (this.node.parent) {\n            this.node.parent.removeChild(this.node);\n        }\n    },\n\n    // update (dt) {},\n});\n"]}