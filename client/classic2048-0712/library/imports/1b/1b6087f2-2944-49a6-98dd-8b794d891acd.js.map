{"version":3,"sources":["../../../../../assets/Scripts/common/assets/Scripts/common/ThirdApi.js"],"names":["FBGlobal","require","WXGlobal","Platform","wx","FBInstant","initOnEnter","ThirdAPI","getRank","params","type","console","log","getFriendRank","getGroupRank","getDailyRank","getMyInfo","shakeShort","shakeLong","showGameClub","value","initFriendRank","getNextFriend","getNextFriendRank","saveGamePropgress","parma","data","list","score","cc","sys","localStorage","setItem","JSON","stringify","error","loadGameProgress","result","storage","getItem","parse","clearGameProgressInfo","removeItem","saveScore","maxscore","gold","saveFBScore","loadScore","callback","loadLocalScore","getFBScore","parseInt","saveReviveData","shareTimes","date","Date","toDateString","Global","reviveTodayTimes","clearReviveData","data2","loadReviveData","saveShareData","shareDate","loadShareData","clearShareData","clearRankData","unixTime","getTime","beforeClearTime","clearTime","oldTime","oldDay","getDay","todaySeconds","getHours","getMinutes","getSeconds","weekdayUnixTime","sundayUnixTime","currUnixTime","canClear","clearInfo","key","saveInfo","i","length","loadInfo","push","index","clearCurrentSkin","saveCurrentSkin","current","loadCurrentSkin","ret","currentSkin","isFromGroup","getHelpInfo","shareGame","imageurl","failcallback","sourcecode","shareManager","extraParam","sendTime","sharePoint","onShareGame","saveFriendGenStoneInfo","loadFriendGenStoneInfo","clearFriendGenStoneInfo","getShareUserInfo","exitGame","exit","getSystemInfo","module","exports"],"mappings":"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","file":"ThirdApi.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["let FBGlobal = require('./fbAPI')\nlet WXGlobal = require('./wxAPI')\nlet Platform = (typeof wx !== 'undefined') ? 1 : ((typeof FBInstant !== 'undefined') ? 2 : 0)\n\nif (Platform === 1) {\n\n    WXGlobal.initOnEnter();\n\n} else {\n\n}\n\n\nlet ThirdAPI = {\n\n    getRank: function (params, type) {\n        console.log('ThirdAPI getRank', params, type);\n\n        if (Platform === 1) {\n            if (type === 'Friend') {\n                return WXGlobal.getFriendRank(params);\n            } else if (type === 'Group') {\n                /* var shareManager = require('shareManager');\n                 var extraParam = {\n                     sendTime: (new Date()).getTime()\n                 };\n                 shareManager.sharePoint(\"229\", null, null, extraParam);*/\n\n                return WXGlobal.getGroupRank(params);\n            } else if (type === 'Daily') {\n                return WXGlobal.getDailyRank(params);\n            } else if (type === \"MyInfo\") {\n                return WXGlobal.getMyInfo(params);\n            }\n\n        } else if (Platform === 2) {\n            return FBGlobal.getRank(params);\n        }\n    },\n\n    shakeShort: function (params) {\n        if (Platform === 1) {\n            WXGlobal.shakeShort(params);\n        } else if (Platform === 2) {\n            console.log('FB 平台未实现震动');\n        }\n    },\n\n    shakeLong: function (params) {\n        if (Platform === 1) {\n            WXGlobal.shakeLong(params);\n        } else if (Platform === 2) {\n            console.log('FB 平台未实现震动');\n        }\n    },\n\n    showGameClub: function (value) {\n        if (Platform === 1) {\n            WXGlobal.showGameClub(value);\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    initFriendRank: function () {\n        console.log('ThirdAPI initFriendRank');\n\n        if (Platform === 1) {\n            return WXGlobal.initFriendRank();\n        } else if (Platform === 2) {}\n    },\n\n    getNextFriend: function (params) {\n        //console.log('ThirdAPI getNextFriend', params);\n\n        if (Platform === 1) {\n            return WXGlobal.getNextFriendRank(params);\n        } else if (Platform === 2) {\n            return FBGlobal.getRank(params);\n        }\n    },\n\n    //保存游戏进度\n    saveGamePropgress: function (parma) {\n        try {\n            let data = {\n                'list': parma.list,\n                'score': parma.score\n            };\n            cc.sys.localStorage.setItem(\"new2048-keep-data\", JSON.stringify(data));\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //加载存档数据\n    loadGameProgress: function () {\n        var result = {\n            'list': [],\n            'score': 0\n        };\n        try {\n            let storage = cc.sys.localStorage.getItem('new2048-keep-data');\n            console.log('keep storage data : ' + storage);\n            if (!storage) {\n                return result;\n            }\n            let data = JSON.parse(storage);\n            if (data) {\n                return data;\n            }\n            return result;\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    clearGameProgressInfo: function () {\n        try {\n            cc.sys.localStorage.removeItem('new2048-keep-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //保存分数\n    saveScore: function (maxscore, gold) {\n        console.log('ThirdAPI saveScore', maxscore, gold);\n\n        if (Platform === 1) {\n            WXGlobal.saveScore(maxscore, gold);\n        } else if (Platform === 2) {\n            FBGlobal.saveFBScore(maxscore, gold);\n        }\n        // 本地通过cocos再存储一份\n        try {\n            let data = \"{ \\\"maxscore\\\": \" + maxscore + \",\\n \\\"gold\\\": \" + gold + \"\" + \" }\"\n            console.log('try save local score', data);\n            cc.sys.localStorage.setItem(\"triline-data\", data);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //获取本地分数\n    loadScore: function (callback) {\n        if (Platform === 1) {\n            // return WXGlobal.loadScore(callback);\n            // 微信无法在主域获取用户托管数据,所以取通过cocos存储的本地数据\n            let result = this.loadLocalScore();\n            if (callback) {\n                callback(result.maxscore, result.gold);\n            }\n        } else if (Platform === 2) {\n            return FBGlobal.getFBScore(callback);\n        }\n    },\n\n    loadLocalScore: function () {\n        let result = {\n            maxscore: 0,\n            gold: 0\n        }\n        try {\n            let storage = cc.sys.localStorage.getItem('triline-data');\n            console.log('storage data : ' + storage);\n            let data = JSON.parse(storage);\n            if (data) {\n                result.maxscore = parseInt(data.maxscore);\n            }\n            if (data.gold) {\n                result.gold = parseInt(data.gold);\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    //存储复活次数\n    saveReviveData: function (shareTimes) {\n        try {\n            let storage = cc.sys.localStorage.getItem('2048-revive-data');\n            let data = JSON.parse(storage);\n            //如果本地数据\n            if (!data) {\n                data = {\n                    date: (new Date()).toDateString(),\n                    shareTimes: Global.reviveTodayTimes\n                };\n            } else {\n                if (data.date && data.date != (new Date()).toDateString()) {\n                    //删除无效数据\n                    console.log('重新保存数据：' + (new Date()).toDateString(), Global.reviveTodayTimes);\n                    this.clearReviveData();\n                    data = {\n                        date: (new Date()).toDateString(),\n                        shareTimes: Global.reviveTodayTimes\n                    };\n                } else {\n                    console.log('更新保存数据' + shareTimes);\n                    data = {\n                        date: (new Date()).toDateString(),\n                        shareTimes: shareTimes\n                    };\n                }\n            }\n            let data2 = JSON.stringify(data);\n            console.log('try save local revive', data2);\n            cc.sys.localStorage.setItem(\"2048-revive-data\", data2);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadReviveData: function () {\n        try {\n            let storage = cc.sys.localStorage.getItem('2048-revive-data');\n            console.log('revive storage data : ' + storage);\n            let data = JSON.parse(storage);\n            if (data) {\n                //判断是否是当天\n                if (data.date && data.date == (new Date()).toDateString()) {\n                    return parseInt(data.shareTimes);\n                } else {\n                    return Global.reviveTodayTimes;\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return Global.reviveTodayTimes;\n    },\n\n    //清除复活次数\n    clearReviveData: function () {\n        try {\n            cc.sys.localStorage.removeItem('2048-revive-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //复活次数存储\n    saveShareData: function (shareTimes, shareDate) {\n        try {\n            let data = {\n                shareDate: shareDate,\n                shareTimes: shareTimes\n            };\n            let data2 = JSON.stringify(data);\n            cc.sys.localStorage.setItem(\"2048-share-data\", data2);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadShareData: function () {\n        let result = {\n            shareTimes: 0,\n            shareDate: ''\n        }\n        try {\n            let storage = cc.sys.localStorage.getItem('2048-share-data');\n            if (storage) {\n                let data = JSON.parse(storage);\n                if (data) {\n                    if (data.shareDate) {\n                        result.shareDate = data.shareDate;\n                    }\n                    if (data.shareTimes) {\n                        result.shareTimes = data.shareTimes;\n                    }\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    //清除分享次数\n    clearShareData: function () {\n        try {\n            cc.sys.localStorage.removeItem('2048-share-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //清除排行榜数据\n    clearRankData: function () {\n        console.log('ThirdAPI ready clearRankData');\n        if (Platform === 1) {\n            let data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('clearRankData on ThirdAPI loadScore', score + \" :: \" + gold);\n            });\n\n            //先判断这一周是否有被清空过排行榜数据，没有数据则自动清空\n            try {\n                var unixTime = (new Date()).getTime();\n                let storage = cc.sys.localStorage.getItem('2048-rank-data');\n                if (storage) {\n                    // 有数据则判断这周是否清零过\n                    let data2 = JSON.parse(storage);\n                    var beforeClearTime = parseInt(data2.clearTime);\n                    if (beforeClearTime == 0) {\n                        console.log('清除排行的时间为0');\n                        //没有排行本地数据则分数清零\n                        cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                            clearTime: parseInt(unixTime)\n                        }));\n                        ThirdAPI.saveScore(0, gold);\n                    } else {\n                        var oldTime = new Date(beforeClearTime);\n                        var oldDay = (oldTime.getDay() == 0) ? 7 : oldTime.getDay();\n\n                        //计算当天从零点开始的秒数(小时、分钟、秒)\n                        var todaySeconds = oldTime.getHours() * 3600 + oldTime.getMinutes() * 60 + oldTime.getSeconds();\n\n                        var weekdayUnixTime = (beforeClearTime / 1000) - parseInt(oldDay - 1) * 86400 - todaySeconds;\n                        var sundayUnixTime = (beforeClearTime / 1000) + (7 - oldDay) * 86400 + (86400 - todaySeconds - 1);\n\n                        //如果这周没有清零则清一遍\n                        var currUnixTime = (new Date()).getTime();\n                        var canClear = ((parseInt(weekdayUnixTime * 1000) <= currUnixTime) && (currUnixTime <= parseInt(sundayUnixTime * 1000))) ? false : true;\n                        if (canClear) {\n                            //这一周排行榜数据没有清零\n                            console.log('新的一周可以清空排行榜数据');\n                            cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                                clearTime: parseInt(unixTime)\n                            }));\n                            ThirdAPI.saveScore(0, gold);\n                        }\n                    }\n                } else {\n                    //没有排行本地数据则分数清零\n                    cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                        clearTime: parseInt(unixTime)\n                    }));\n                    ThirdAPI.saveScore(0, gold);\n                }\n            } catch (error) {\n                console.error(error);\n            }\n        } else if (Platform === 2) {\n            //FB暂未清除排行榜\n        }\n    },\n\n    clearInfo: function (key) {\n        //console.log('ThirdAPI clearStoreInfo');\n        let list = []\n        try {\n            cc.sys.localStorage.removeItem('triline-data' + key);\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    saveInfo: function (key, list) {\n        //console.log('ThirdAPI saveStoreInfo');\n\n        // 本地通过cocos再存储一份\n        try {\n\n            let data = \"[\";\n            for (let i = 0; i < list.length; i++) {\n                if (i > 0) {\n                    data += \",\";\n                }\n                data += \"{\\\"index\\\":\\\"\" + list[i] + \"\\\"}\";\n            }\n            data += \"]\";\n            //let data = \"{ \\\"name\\\" : \\\"bob\\\", \\\"id\\\":\\\"10\\\"}\";\n            //console.log('try save local score',data);\n            cc.sys.localStorage.setItem('triline-data' + key, data);\n        } catch (error) {\n            //console.error(error);\n        }\n    },\n\n    loadInfo: function (key) {\n        //console.log('ThirdAPI loadStoreInfo');\n        let list = []\n        try {\n            let storage = cc.sys.localStorage.getItem('triline-data' + key);\n            //console.log('storage data : ' + storage);\n            let data = JSON.parse(storage);\n            //console.log('data : ', data);\n            if (data) {\n                for (let i = 0; i < data.length; i++) {\n                    list.push(data[i].index);\n                }\n                //console.log(\"the list of store data is :\", list);\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    clearCurrentSkin: function () {\n        //console.log('ThirdAPI clearStoreInfo');\n        let list = []\n        try {\n            cc.sys.localStorage.removeItem('triline-currentskin-data');\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    saveCurrentSkin: function (current) {\n        //console.log('ThirdAPI saveStoreInfo');\n\n        // 本地通过cocos再存储一份\n        try {\n            let data = \"{ \\\"currentSkin\\\": \" + current + \" }\"\n            //console.log('try save local score',data);\n            cc.sys.localStorage.setItem(\"triline-currentskin-data\", data);\n        } catch (error) {\n            //console.error(error);\n        }\n    },\n\n    loadCurrentSkin: function () {\n        //console.log('ThirdAPI loadStoreInfo');\n        let ret = 0;\n        try {\n            let storage = cc.sys.localStorage.getItem('triline-currentskin-data');\n            let data = JSON.parse(storage);\n            if (data) {\n                ret = parseInt(data.currentSkin);\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return ret;\n    },\n\n    isFromGroup: function () {\n        console.log('ThirdAPI isFromGroup');\n\n        if (Platform === 1) {\n            return WXGlobal.isFromGroup();\n        } else if (Platform === 2) {}\n    },\n\n    getHelpInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getHelpInfo();\n        } else if (Platform === 2) {}\n    },\n\n    shareGame: function (imageurl, callback, failcallback, sourcecode) {\n        if (Platform === 1) {\n            if (callback) {\n                console.log('wx has callback');\n\n            } else {\n                console.log('wx has no callback');\n            }\n            \n            //WXGlobal.shareGame(imageurl, callback, failcallback, sourcecode);\n\n            var shareManager = require('shareManager');\n            var extraParam = {\n                sendTime: (new Date()).getTime()\n            };\n            shareManager.sharePoint(sourcecode, callback, failcallback, extraParam);\n        } else if (Platform === 2) {\n            FBGlobal.onShareGame(imageurl, callback);\n        }\n    },\n\n    //加载好友索取钻石的信息\n    saveFriendGenStoneInfo: function (storage) {\n        console.log('ThirdAPI saveInfo');\n        try {\n            let data = JSON.stringify(storage);\n            console.log('try save local data', data);\n            cc.sys.localStorage.setItem('new2048-claimData', data);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadFriendGenStoneInfo: function () {\n        console.log('ThirdAPI loadInfo');\n        try {\n            let storage = cc.sys.localStorage.getItem('new2048-claimData');\n            console.log('storage data : ' + storage);\n            let data = JSON.parse(storage);\n            if (data) {\n                return data;\n            }\n            return null;\n        } catch (error) {\n            return null;\n        }\n        return null;\n    },\n\n    clearFriendGenStoneInfo: function () {\n        try {\n            cc.sys.localStorage.removeItem('new2048-claimData');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    getShareUserInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getShareUserInfo()\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    exitGame: function () {\n        if (Platform === 1) {\n            return WXGlobal.exit()\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    getSystemInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getSystemInfo()\n        } else if (Platform === 2) {\n\n        }\n    }\n}\n\nmodule.exports = ThirdAPI;"]}