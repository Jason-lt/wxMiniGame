{"version":3,"sources":["gridController.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","nextFriendNode","default","type","Node","nextFriendSp","Sprite","gridPrefab","Prefab","pauseNode","chooseNode","test_btnNode","itemPrefab","randomScore","soonGridNum","soonGridInstance","startX","startY","allGrids","bornGrid","startTouchPosition","deleteGrids","joinGrids","targetGrid","line","goldNode","prop","nodesGroup","clearPropBtn","clearLabel","Label","clearAdd","clearUseNumNode","clearUseNum","superPropBtn","superLabel","superAdd","superUseNumNode","superUseNum","doublePropBtn","doubleLabel","layoutNode","guideNode","bombNode","bombSurplus","blinkSpr","clearTips","fitOffsetY","propClearTime","score","downGrids","scoreScript","isClickBomming","clickGridNum","createItemIndex","moveItemIndex","startTime","addTimes","usePropTimes","useSuperTimes","useDoubleTimes","useProp","popDialogTimes","bombShareTimes","createItemNum","start","listenUtil","eventCtrl","addListen","cdnChange","bind","myUtil","isFitIphoneX","isIphoneX","setPosition","getComponent","Widget","top","console","log","setLocalZOrder","params","active","Global","cdnGameConfig","totalSwith","initGridData","listParma","allWidth","hNum","itemSize","itemSplit","allHeight","vNum","screenWidth","reset","createAllGrid","setTouchControl","node","setOpacity","string","bombRunAction","isDailyLimit","undefined","startInit","list","addScore","initForDailyLimit","process","updateGold","getNextFriend","director","getScheduler","schedule","setLine","canTest","label","getChildByName","testEnabled","wxBannerAd","createBannerAd","drawRect","x","y","width","height","rect","scoreNum","callback","entries","setTimeout","openDataContext","wx","getOpenDataContext","sharedCanvas","canvas","texture","Texture2D","initWithElement","handleLoadedTexture","sp","SpriteFrame","spriteFrame","error","unixTime","Date","getTime","today","getDayForYear","startDay","parseInt","dailyStartTime","day","Math","abs","data","self","dailyConfig","gameinfo","dailyTime","saveFriendGenStoneInfo","num","vIndex","hIndex","item","instantiate","pos","getPosition","p","initData","addChild","gridScript","gridNum","linePosY","lineHight","winSize","getWinSize","down","checkGridJoin","isDown","resetItemAction","curState","downNum","index","length","element","gridJoin","runAction","sequence","delayTime","callFunc","clearAllJoin","canJoin","findDownNum","startBianli","combineTimes","checkJoin","hightBornGrid","bornXgridNum","gameOver","createItem","isFind","actionJoin","joinComplete","isJoin","randomForArray","gridRandomScores","showChooseNum","createItem2","dropStone","hasGrid","push","targetPos","upGrid","upGridScript","itemScript","isStone","updateNumForProp","gridController","createGridNumForClear","historyMaxScore","histroyMaxScore","usePropStatus","createGridNumForSuper","updateNum","createDownGrid","onPauseGameForOther","isPropGuide","setSoonGrid","bornXgrid","posX","posY","position","useClear","useDouble","downSpeed","gridDownSpeed","getStopPosition","targetView","startDownForBorn","nextScore","randomScores","concat","joinRandomScores","parent","useClearProp","clearPropNum","game","showDialogPropText","parma","randomPropInfo","limitForGame","setPropSprite","biManager","bilog","useSuperProp","superPropNum","useDoubleProp","doublePropNum","showAddPropDialog","LoadAtlas","setVisible","clearParma","getSpriteFrameFromName","superParma","doubleParma","closeListen","off","EventType","TOUCH_START","nodeStart","TOUCH_MOVE","nodeMove","TOUCH_END","nodeEnd","createGrid","gridItem","gridView","setIndex","itemClick","event","clickGrid","getUserData","stopAllActions","scale1","scaleTo","scaleTime","clearItemToRemove","currHindex","currVindex","downtime","wxGold","costGold","loadLocalScore","maxscore","gold","loadScore","saveScore","goldLabel","clickProp","resetProp","scaleBy","scale2","repeat","xBorn","yBorn","addIndex","on","getLocation","moveStartX","ceil","canMove","isPaused","moveTemp","dist","downDist","xPadding","round","moveThreshold","isUpOrDown","moveDownThreshold","canMoveGrid","isTouchDown","canMoveQuickDown","priView","maxDownTime","startQuickDownForBorn","gridQuickDownSpeed","changeStateToWaitDown","yDist","hindex","_hIndex","_vIndex","endx","soonMoveGrid","floor","vindex","isClearGrid","gridviewScript","_curitem","gridCombineDownSpeed","curtime","onPauseOrResume","playSound","resumeAllActions","pauseAllActions","hideChooseNum","hidePropTipsNode","onRestart","removeChild","restart","onMainScene","startGame","resume","onShareGame","FBInstant","shareGame","getImgBase64","goldNum","addGold","showGold","rotation","repeatForever","rotateBy","onBombShare","useBomb","pauseInterval","onBombShareSuccess","EChannelPrefix","sendChannelPrefix","gift","onBombShareFail","openGId","bombShareSuccess","needBombIndex","grid","showDialogText","shareData1","arrOpenGId","indexOf","blinkPos","myAction","fadeTo","actions","time","itemViewScript","clearTime","currBornXGridNum","msg","clearGameProgressInfo","unschedule","destroyBannerAd","reviveShareTimes","loadReviveData","reviveTimes","reviveTotalTimes","showRevive","showShareUI","clearGridForRevive","clearVNum","toRevive","flyNumPools","finished","reviveSuccess","toRemove","randomForWeight","weightConfig","oneWeightRate","oneTotalWeight"],"mappings":"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","file":"gridController.js","sourceRoot":"../../../../../assets/Scripts/controller","sourcesContent":["let ThirdAPI = require('../common/ThirdAPI')\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //下一个好友的节点\n        nextFriendNode: {\n            default: null,\n            type: cc.Node,\n        },\n        //下一个好友的精灵\n        nextFriendSp: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        gridPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        pauseNode: {\n            default: null,\n            type: cc.Node\n        },\n        chooseNode: {\n            default: null,\n            type: cc.Node\n        },\n        test_btnNode: {\n            default: null,\n            type: cc.Node\n        },\n\n        //格子内的item\n        itemPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n\n        //右上角显示即将下落的格子分数\n        randomScore: 0,\n        //即将出现的格子\n        soonGridNum: {\n            default: null,\n            type: cc.Prefab,\n        },\n        soonGridInstance: null,\n\n        startX: 0,\n        startY: 0,\n        //所有格子节点坐标\n        allGrids: [],\n        //出生的格子\n        bornGrid: null,\n        //开始触摸的位置坐标\n        startTouchPosition: null,\n\n        //将要合并的数组\n        deleteGrids: [],\n        joinGrids: [],\n        //目标的格子\n        targetGrid: {\n            default: null,\n            type: cc.Node\n        },\n\n        line: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //金币节点\n        goldNode: {\n            default: null,\n            type: cc.Node\n        },\n        prop: {\n            default: null,\n            type: cc.Node\n        },\n        nodesGroup: {\n            default: null,\n            type: cc.Node,\n        },\n        //清除道具\n        clearPropBtn: {\n            default: null,\n            type: cc.Sprite,\n        },\n        clearLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        clearAdd: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //清除道具数量节点\n        clearUseNumNode: {\n            default: null,\n            type: cc.Node\n        },\n        clearUseNum: {\n            default: null,\n            type: cc.Label,\n        },\n        //万能道具\n        superPropBtn: {\n            default: null,\n            type: cc.Sprite,\n        },\n        superLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        superAdd: {\n            default: null,\n            type: cc.Sprite,\n        },\n        //万能道具数量节点\n        superUseNumNode: {\n            default: null,\n            type: cc.Node\n        },\n        superUseNum: {\n            default: null,\n            type: cc.Label,\n        },\n        //双倍道具\n        doublePropBtn: {\n            default: null,\n            type: cc.Sprite,\n        },\n        doubleLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        layoutNode: {\n            default: null,\n            type: cc.Node,\n        },\n        guideNode: {\n            default: null,\n            type: cc.Node,\n        },\n        bombNode: {\n            default: null,\n            type: cc.Node\n        },\n        bombSurplus: {\n            default: null,\n            type: cc.Label,\n        },\n        blinkSpr: {\n            default: null,\n            type: cc.Sprite,\n        },\n        clearTips: {\n            default: null,\n            type: cc.Node\n        },\n        fitOffsetY: 0,\n        propClearTime: 0, //使用道具消除点击格子的动画时间\n\n        //分数\n        score: {\n            default: null,\n            type: cc.Node,\n        },\n        //可下落格子\n        downGrids: [],\n\n        scoreScript: null,\n        isClickBomming: false,\n        clickGridNum: 0, //消除格子数量\n        createItemIndex: 0,\n        moveItemIndex: 0,\n\n        startTime: 0, //开始时间\n        addTimes: 0, //加速次数\n\n        usePropTimes: 0, //使用清除道具次数\n        useSuperTimes: 0, //使用万能道具的次数\n        useDoubleTimes: 0, //使用万能道具的次数\n        useProp: -1, //使用道具，生产下一个生效\n\n        //弹出道具分享的次数\n        popDialogTimes: 0,\n        bombShareTimes: 0, //爆炸可分享的次数\n\n        createItemNum: 0, //生产的第几个格子\n    },\n\n    start: function () {\n        listenUtil.eventCtrl.addListen('cdnchange', this.cdnChange.bind(this));\n        // 适配\n        //var isFitIphoneX = cc.winSize.width / cc.winSize.height < 0.50;\n        var myUtil = require('myUtil');\n        var isFitIphoneX = myUtil.isIphoneX();\n\n        this.fitOffsetY = 0;\n\n        if (isFitIphoneX) {\n            this.fitOffsetY = 40;\n            this.nodesGroup.setPosition(0, -this.fitOffsetY);\n            this.nodesGroup.getComponent(cc.Widget).top = this.fitOffsetY;\n            console.log('widght:', this.fitOffsetY);\n\n            // this.layoutNode.getPosition().y += 30;\n            // this.layoutNode.getComponent(cc.Widget).top += 30;\n\n            this.layoutNode.setLocalZOrder(1000);\n        }\n    },\n\n    cdnChange: function (params) {\n        console.log('cdn数据变化');\n        this.layoutNode.active = Global.cdnGameConfig.totalSwith;\n    },\n\n    initGridData: function (listParma) {\n        // 适配\n        //var isFitIphoneX = cc.winSize.width / cc.winSize.height < 0.50;\n        var myUtil = require('myUtil');\n        var isFitIphoneX = myUtil.isIphoneX();\n\n        this.fitOffsetY = 0;\n        if (isFitIphoneX) {\n            this.fitOffsetY = 40;\n            //this.nodesGroup.setPosition(0, -this.fitOffsetY);\n            //this.nodesGroup.getComponent(cc.Widget).top = this.fitOffsetY;\n        }\n\n        //设置位置坐标\n        var allWidth = Global.hNum * Global.itemSize + (Global.hNum - 1) * Global.itemSplit;\n        var allHeight = Global.vNum * Global.itemSize + (Global.vNum - 1) * Global.itemSplit;\n\n        this.startX = -(Global.screenWidth / 2) + (Global.screenWidth - allWidth) / 2 + Global.itemSize / 2;\n        this.startY = 328 - this.fitOffsetY; //-(Global.screenHeight / 2) + Global.paddingButtom + allHeight - Global.itemSize + 30 - this.fitOffsetY; \n\n        this.scoreScript = this.score.getComponent(\"score\");\n\n        //重置所有数据\n        this.reset();\n\n        //初始化棋盘\n        this.createAllGrid();\n        //添加触摸侦听\n        this.setTouchControl();\n        //引导节点\n        this.guideNode.active = true;\n        //炸弹\n        this.blinkSpr.node.setOpacity(0);\n        this.bombNode.active = (Global.cdnGameConfig.totalSwith && this.bombShareTimes < Global.cdnGameConfig.bombShareTimes) ? true : false;\n        this.bombSurplus.string = Global.cdnGameConfig.bombShareTimes - this.bombShareTimes;\n        this.bombRunAction();\n        //每日挑战\n        if (Global.isDailyLimit || listParma != undefined) {\n            if (listParma != undefined) {\n                this.startInit(listParma.list);\n                this.scoreScript.addScore(listParma.score);\n            } else {\n                this.initForDailyLimit();\n            }\n\n        } else {\n            //开始处理业务逻辑\n            this.process();\n        }\n\n        //显示星星\n        this.updateGold();\n        //下一个好友\n        this.nextFriendNode.active = !Global.isDailyLimit;\n        this.getNextFriend();\n        cc.director.getScheduler().schedule(this.getNextFriend, this, 1, false);\n\n        this.setLine(allWidth, allHeight);\n        this.pauseNode.active = false;\n        this.chooseNode.active = false;\n        this.clearTips.active = false;\n\n        this.layoutNode.active = Global.cdnGameConfig.totalSwith;\n        this.test_btnNode.active = Global.canTest;\n        if (Global.canTest) {\n            var label = this.test_btnNode.getChildByName('Label');\n            label.getComponent(cc.Label).string = '测试 ' + (Global.testEnabled ? '开' : '关');\n        }\n        //创建广告\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n    },\n\n    getNextFriend: function () {\n        //console.log(\"更新即将超越好友信息\", this.scoreScript.scoreNum);\n\n        this.drawRect = {\n            x: 0,\n            y: 0,\n            width: this.nextFriendSp.node.width,\n            height: this.nextFriendSp.node.height\n        };\n        ThirdAPI.getNextFriend({\n            rect: this.drawRect,\n            score: this.scoreScript.scoreNum,\n            callback: (entries) => {\n                //console.log('获取即将超越好友信息成功');\n\n                setTimeout(() => {\n                    try {\n                        let openDataContext = wx.getOpenDataContext();\n                        let sharedCanvas = openDataContext.canvas;\n\n                        let texture = new cc.Texture2D();\n                        texture.initWithElement(sharedCanvas);\n                        texture.handleLoadedTexture();\n                        let sp = new cc.SpriteFrame(texture);\n                        this.nextFriendSp.spriteFrame = sp;\n                    } catch (error) {\n\n                    }\n                }, 500);\n            }\n        });\n    },\n\n    //每日限时初始化格子\n    initForDailyLimit: function () {\n        //根据初始时间来计算到现在多少天\n        var myUtil = require('myUtil');\n        var unixTime = (new Date()).getTime();\n        var today = myUtil.getDayForYear(unixTime);\n        var startDay = myUtil.getDayForYear(parseInt(Global.cdnGameConfig.dailyStartTime) * 1000);\n        var day = Math.abs(today - startDay);\n        this.data = null;\n        var self = this;\n        console.log('today:' + today, \"startDay:\" + startDay);\n        if (Global.dailyConfig && !Global.dailyConfig[day]) {\n            console.log('没有json数据，取json的第一个');\n            self.data = Global.dailyConfig[0];\n        } else {\n            console.log('取json的第' + day + \"个\");\n            self.data = Global.dailyConfig[day];\n        }\n        Global.gameinfo.dailyTime = (new Date()).getTime();\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n\n        self.startInit(self.data);\n        console.log(self.data);\n    },\n\n    startInit: function (data) {\n        var num = 0;\n        for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n            for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                if (parseInt(data[num]) > 0) {\n                    let item = cc.instantiate(this.itemPrefab);\n                    //限时格子的初始位置\n                    var pos = this.allGrids[hIndex][vIndex].getPosition();\n                    item.setPosition(cc.p(pos.x, pos.y));\n                    item.getComponent('itemView').initData(data[num], false);\n                    this.node.addChild(item);\n                    var gridScript = this.allGrids[hIndex][vIndex].getComponent('gridView');\n                    gridScript.item = item.getComponent('itemView');\n                    gridScript.gridNum = data[num];\n                }\n                num++;\n            }\n        }\n        this.guideNode.active = false;\n        this.process();\n    },\n\n    //设置线的位置和大小\n    setLine: function (width, height) {\n        this.line.node.width = width + 20;\n        this.line.node.height = height + 20;\n        var linePosY = height / 2 - this.startY - Global.itemSize / 2;\n        this.line.node.setPosition(cc.p(0, -linePosY));\n\n\n        //Global.lineHight = 0 - 430 - this.fitOffsetY - Global.itemSize / 2 - height;\n        Global.lineHight = this.line.node.height;\n\n        //Global.lineHight = this.line.node.height;\n        Global.linePosY = -linePosY;\n        console.log('line:', -linePosY, this.line.node.height, cc.winSize.width, cc.winSize.height, cc.director.getWinSize());\n    },\n\n    process: function () {\n        //1.格子下落\n        this.down();\n        //格子合并\n        this.checkGridJoin();\n    },\n\n    //下落\n    down: function () {\n        this.isDown = false;\n        this.downGrids = [];\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                if (this.resetItemAction(hIndex, vIndex, false)) {\n                    this.isDown = true;\n                }\n            }\n        }\n\n        if (this.bornGrid && this.bornGrid.getComponent('itemView').curState > 0) {\n            this.isDown = true;\n        }\n    },\n\n    checkGridJoin: function () {\n        let self = this;\n        let downNum = 0;\n        // for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n        //     for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n        //         var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n        //         if (gridScript.item && gridScript.item.getComponent('itemView').curState > 0) {\n        //             downNum++;\n        //         }\n        //     }\n        // }\n        for (let index = 0; index < this.downGrids.length; index++) {\n            const element = this.downGrids[index];\n            if (element.curState > 0) {\n                downNum++;\n            }\n        }\n        if (this.bornGrid != null && this.bornGrid.getComponent('itemView').curState > 0) {\n            downNum++;\n        }\n        if ((this.bornGrid == null || this.bornGrid.getComponent('itemView').curState == 0) && downNum == 0) {\n            this.gridJoin();\n        } else {\n            this.node.runAction(cc.sequence(cc.delayTime(0.5), cc.callFunc(function () {\n                self.checkGridJoin();\n            })));\n        }\n\n        //this.gridJoin();\n    },\n\n    gridJoin: function () {\n        var self = this;\n        //2.格子合并\n        //self.bornGrid = null;\n\n        //是否有被删除的格子\n        if (self.clickGridNum > 0) {\n            self.process();\n            self.clickGridNum = 0;\n            return;\n        }\n\n        self.clearAllJoin();\n\n        let canJoin = false;\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n                if (!self.findDownNum() || (self.findDownNum() && gridScript.isDown)) {\n                    //执行合并\n                    if (gridScript.startBianli()) {\n                        canJoin = true;\n                    }\n                }\n            }\n        }\n\n        if (canJoin) {\n            Global.combineTimes++;\n            console.log('要开始合并啦,combineTimes:' + Global.combineTimes);\n            this.bornGrid = null;\n            this.checkJoin();\n        } else {\n            var hightBornGrid = self.allGrids[Global.bornXgridNum][0];\n            if (hightBornGrid.getComponent('gridView').item != null && !self.isDown) {\n                //gameover\n                let self = this;\n                self.node.runAction(cc.sequence(cc.delayTime(0.5), cc.callFunc(function () {\n                    self.gameOver();\n                })));\n                return;\n            }\n            if (!self.isDown) {\n                Global.combineTimes = 0;\n                self.bornGrid = null;\n                self.createItem();\n            } else {\n                self.process();\n            }\n        }\n    },\n\n    //合并判断\n    checkJoin: function () {\n        console.log('开始检查合并');\n        let self = this;\n        self.node.runAction(cc.sequence(cc.delayTime(0.1), cc.callFunc(function () {\n            let isFind = false;\n            for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                    var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n                    if (gridScript.actionJoin) {\n                        isFind = true;\n                        break;\n                    }\n                }\n            }\n            if (!isFind) {\n                console.log('合并结束');\n                self.joinComplete();\n            } else {\n                console.log('开始检查合并2222');\n                self.checkJoin();\n            }\n        })));\n    },\n\n    joinComplete: function () {\n        let self = this;\n        //最高点合并之后重新生产\n        var hightBornGrid = self.allGrids[Global.bornXgridNum][0];\n        if (hightBornGrid.getComponent('gridView').item != null) {\n            //因为在最开始创建的时候下方有物体，所以不能isDown，合并完之后需要重设isDown，\n            //再继续判断是否可以合并，如果没有则再生产一个item，\n            self.isDown = true;\n        }\n        self.gridJoin();\n    },\n\n    findDownNum: function () {\n        var self = this;\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var gridScript = self.allGrids[hIndex][vIndex].getComponent('gridView');\n                if (gridScript.isDown) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    //清除所有的可合并变量\n    clearAllJoin: function () {\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var gridScript = this.allGrids[hIndex][vIndex].getComponent('gridView');\n                gridScript.isJoin = false;\n            }\n        }\n    },\n\n    //生产下落的item\n    createItem: function () {\n        //判断是否可以生产钻石\n        //this.dropStone();\n\n        var myUtil = require(\"myUtil\");\n        if (this.randomScore == 0) {\n            this.randomScore = myUtil.randomForArray(Global.gridRandomScores);\n        }\n\n        if (Global.testEnabled) {\n            this.showChooseNum();\n        } else {\n            this.createItem2();\n        }\n    },\n\n    //概率掉落道具(星星)\n    dropStone: function () {\n        //第一次判断分数，之后判断时间\n\n\n        //判断每行是否有空余的格子,并且钻石在格子之上，概率一样\n        var list = []; //格式：[[0,1],[2,4],[hIndex,vIndex]]\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            var hasGrid = false;\n            for (let vIndex = Global.vNum - 1; vIndex >= 0; vIndex--) {\n                var gridScript = this.allGrids[hIndex][vIndex].getComponent('gridView');\n                if (gridScript.item != null) {\n                    hasGrid = true;\n                } else {\n                    if (hasGrid) {\n                        list.push([hIndex, vIndex]);\n                        break;\n                    }\n                }\n\n\n                /*\n                                if (hasGrid && gridScript.item == null) {\n                                    list.push([hIndex, vIndex]);\n                                    break;\n                                } else {\n                                    //再判断\n                                    hasGrid = true;\n                                }*/\n            }\n        }\n        console.log('list:', list);\n        if (list.length <= 0) return;\n\n        //随机产生一个\n        var myUtil = require('myUtil');\n        var targetPos = myUtil.randomForArray(list);\n        var hIndex = targetPos[0];\n        var vIndex = targetPos[1];\n\n\n\n        /*\n                //先判断上方是否有格子存在\n                if (vIndex >= Global.vNum) {\n                    return;\n                }\n                var upGrid = this.allGrids[hIndex][vIndex];\n                if (!upGrid) return;\n                var upGridScript = upGrid.getComponent(\"gridView\");\n\n                //判断是否有item\n                if (upGridScript.item !== null) {\n                    return;\n                }*/\n        var upGrid = this.allGrids[hIndex][vIndex];\n        var upGridScript = upGrid.getComponent(\"gridView\");\n        //开始创建item\n        let item = cc.instantiate(this.itemPrefab);\n        //出生的目标点\n        item.setPosition(upGrid.getPosition());\n        var itemScript = item.getComponent('itemView');\n        itemScript.isStone = true;\n\n        itemScript.initData(0, false);\n        itemScript.updateNumForProp();\n\n        Global.gridController.addChild(item);\n        upGridScript.item = itemScript;\n\n        //var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n\n        //itemScript.targetGrid = this.allGrids[hIndex][vIndex];\n        //Global.candropProp = false;\n    },\n\n    createItem2: function () {\n        this.createItemNum++;\n\n        if (this.useProp != -1 || (!Global.isDailyLimit && Global.cdnGameConfig.totalSwith && this.createItemNum == parseInt(Global.cdnGameConfig.createGridNumForClear) && Global.historyMaxScore <= parseInt(Global.cdnGameConfig.histroyMaxScore))) {\n            console.log('生产道具', this.useProp);\n            Global.usePropStatus = this.createItemNum == Global.cdnGameConfig.createGridNumForClear ? 0 : this.useProp;\n        } else {\n            Global.usePropStatus = -1;\n        }\n        this.useProp = -1;\n\n        //生产要下落的格子\n        if (!Global.isDailyLimit && Global.cdnGameConfig.totalSwith && Global.historyMaxScore <= parseInt(Global.cdnGameConfig.histroyMaxScore) &&\n            (this.createItemNum == (parseInt(Global.cdnGameConfig.createGridNumForClear) - 1) ||\n                this.createItemNum == parseInt(Global.cdnGameConfig.createGridNumForClear) ||\n                this.createItemNum == (parseInt(Global.cdnGameConfig.createGridNumForSuper) - 1) ||\n                this.createItemNum == parseInt(Global.cdnGameConfig.createGridNumForSuper))) {\n\n\n            if (this.createItemNum == (Global.cdnGameConfig.createGridNumForClear - 1)) {\n                this.soonGridInstance.getComponent(\"itemView\").updateNum(0);\n                this.createDownGrid();\n            } else if (this.createItemNum == Global.cdnGameConfig.createGridNumForClear) {\n                this.onPauseGameForOther();\n                this.clearTips.active = true;\n                this.clearTips.setLocalZOrder(20);\n            } else if (this.createItemNum == (Global.cdnGameConfig.createGridNumForSuper - 1)) {\n                this.soonGridInstance.getComponent(\"itemView\").updateNum(1);\n                this.createDownGrid();\n            } else if (this.createItemNum == Global.cdnGameConfig.createGridNumForSuper) {\n                Global.isPropGuide = true;\n                this.showChooseNum();\n            }\n        } else {\n            this.createDownGrid();\n            this.setSoonGrid();\n            this.process();\n            this.createItemIndex++;\n            Global.isPropGuide = false;\n        }\n    },\n\n    createDownGrid: function () {\n        let item = cc.instantiate(this.itemPrefab);\n        //出生的目标点\n        var bornXgrid = this.allGrids[Global.bornXgridNum][0];\n        var posX = 0;\n        var posY = this.startY;\n        if (bornXgrid) {\n            var position = bornXgrid.getPosition();\n            posX = position.x;\n            posY = position.y;\n        }\n        item.setPosition(cc.p(posX, posY + Global.itemSize));\n\n        item.getComponent('itemView').initData(this.randomScore, false);\n        item.getComponent('itemView').updateNumForProp();\n        if (Global.usePropStatus == 0) {\n            console.log('锤子道具');\n            item.getComponent('itemView').useClear = true;\n        } else if (Global.usePropStatus == 2) {\n            console.log('设置双倍标识');\n            item.getComponent('itemView').useDouble = true;\n        }\n        this.node.addChild(item);\n\n        this.bornGrid = item;\n\n        var downSpeed = Global.gridDownSpeed;\n        var downNum = this.getStopPosition(Global.bornXgridNum, 0);\n        var targetView = this.allGrids[Global.bornXgridNum][downNum];\n\n        this.bornGrid.getComponent('itemView').targetGrid = targetView;\n\n        item.getComponent('itemView').startDownForBorn(downSpeed);\n\n        //记录生产的第几个格子\n        // this.createItemNum++;\n\n        /* this.setSoonGrid();\n         this.process();\n         this.createItemIndex++;*/\n    },\n\n    //设置即将下落的格子分数\n    setSoonGrid: function (nextScore) {\n        if (nextScore !== undefined) {\n            this.randomScore = nextScore;\n        } else {\n            var myUtil = require(\"myUtil\");\n            var randomScores = Global.gridRandomScores.concat(Global.joinRandomScores);\n            this.randomScore = myUtil.randomForArray(randomScores);\n        }\n\n        if (!this.soonGridInstance || (this.soonGridInstance && !this.soonGridInstance.parent)) {\n            this.soonGridInstance = cc.instantiate(this.soonGridNum);\n            this.node.addChild(this.soonGridInstance);\n        }\n        this.soonGridInstance.setPosition(0, 430 - this.fitOffsetY);\n        this.soonGridInstance.getComponent(\"itemView\").initData(this.randomScore, true);\n    },\n\n    useClearProp: function () {\n        //使用清除道具\n        if (Global.gameinfo.clearPropNum <= 0) {\n            Global.game.showDialogPropText('道具不足！');\n            // console.log('调起道具分享界面');\n            // var parma = {\n            //     'parmaIndex': 0\n            // };\n            // Global.game.showAddPropDialog(parma);\n            //Global.game.showPropDialog(false, \"\", 0);\n            return;\n        }\n        var parma = Global.randomPropInfo[0];\n        if (parma && this.usePropTimes >= parma.limitForGame) {\n            Global.game.showDialogPropText('每局只能使用' + parma.limitForGame + '次道具哦');\n            return;\n        }\n        Global.gameinfo.clearPropNum--;\n        this.usePropTimes++;\n        this.useProp = 0;\n        //变灰\n        this.setPropSprite();\n        if (this.soonGridInstance) {\n            this.soonGridInstance.getComponent(\"itemView\").updateNum(0);\n        }\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n\n        //记载使用消除锤锤打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.useClearProp, null);\n    },\n\n    //使用万能道具\n    useSuperProp: function () {\n        console.log('aaa:', Global.usePropStatus, this.useProp);\n\n        if (this.useProp == 1) {\n            Global.game.showDialogPropText('这一次道具使用完才能再次使用！');\n            return;\n        }\n\n        if (Global.gameinfo.superPropNum <= 0) {\n            Global.game.showDialogPropText('道具不足！');\n            //console.log('调起道具分享界面');\n            // Global.game.showAddPropDialog({\n            //     'parmaIndex': 1\n            // });\n            //Global.game.showPropDialog(false, \"\", 1);\n            return;\n        }\n        var parma = Global.randomPropInfo[1];\n        if (parma && this.useSuperTimes >= parma.limitForGame) {\n            Global.game.showDialogPropText('每局只能使用' + parma.limitForGame + '次道具哦');\n            return;\n        }\n        this.showChooseNum();\n        // this.useSuperTimes++;\n        // Global.gameinfo.superPropNum--;\n        //this.useProp = 1;\n        // this.setPropSprite();\n        // this.soonGridInstance.getComponent(\"itemView\").updateNum(1);\n        // ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n    },\n\n    //使用双倍道具\n    useDoubleProp: function () {\n        Global.game.showDialogPropText('正在努力开发中...');\n        return;\n        //使用清除道具\n        if (Global.gameinfo.doublePropNum <= 0) {\n            Global.game.showAddPropDialog({\n                'parmaIndex': 2\n            });\n            return;\n        }\n        var parma = Global.randomPropInfo[2];\n        if (parma && this.useDoubleTimes >= parma.limitForGame) {\n            Global.game.showDialogPropText('每局只能使用' + parma.limitForGame + '次道具哦');\n            return;\n        }\n        this.useDoubleTimes++;\n        Global.gameinfo.doublePropNum--;\n        this.useProp = 2;\n        this.setPropSprite();\n        if (this.soonGridInstance) {\n            this.soonGridInstance.getComponent(\"itemView\").updateNum(2);\n        }\n        ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n    },\n\n    setPropSprite: function () {\n        var LoadAtlas = require(\"LoadAtlas\");\n        //清除\n        this.clearAdd.setVisible(false);\n        this.clearUseNumNode.active = false;\n        var clearParma = Global.randomPropInfo[0];\n        if (clearParma && this.usePropTimes >= clearParma.limitForGame) {\n            this.clearPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'clear_spr1');\n            //this.clearUseNumNode.active = false;\n        } else {\n            this.clearPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'clear_spr');\n            //剩余可使用道具显示\n            //this.clearUseNumNode.active = true;\n            if (clearParma) {\n                this.clearUseNum.string = clearParma.limitForGame - this.usePropTimes;\n            }\n        }\n        if (Global.gameinfo.clearPropNum > 0) {\n            this.clearLabel.string = Global.gameinfo.clearPropNum;\n            //this.clearAdd.setVisible(false);\n        } else {\n            this.clearLabel.string = '0';\n            //this.clearAdd.setVisible(true);\n        }\n\n        //万能\n        this.superUseNumNode.active = false;\n        var superParma = Global.randomPropInfo[1];\n        if (superParma && this.useSuperTimes >= superParma.limitForGame) {\n            this.superPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'super_spr1');\n            //this.superUseNumNode.active = false;\n        } else {\n            this.superPropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'super_spr');\n            //this.superUseNumNode.active = true;\n            if (superParma) {\n                this.superUseNum.string = superParma.limitForGame - this.useSuperTimes;\n            }\n        }\n        this.superAdd.setVisible(false);\n        if (Global.gameinfo.superPropNum > 0) {\n            this.superLabel.string = Global.gameinfo.superPropNum;\n            //this.superAdd.setVisible(false);\n        } else {\n            this.superLabel.string = '0';\n            //this.superAdd.setVisible(true);\n        }\n        //this.superLabel.string = '万能方块 x' + Global.gameinfo.superPropNum;\n\n        //双倍\n        var doubleParma = Global.randomPropInfo[2];\n        if (doubleParma && this.useDoubleTimes >= doubleParma.limitForGame) {\n            this.doublePropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'double_spr1');\n        } else {\n            this.doublePropBtn.spriteFrame = LoadAtlas.getSpriteFrameFromName('textures/gridItem/items', 'double_spr');\n        }\n        this.doubleLabel.string = '双倍方块';\n    },\n\n    //测试开关是否开启\n    testEnabled: function () {\n        /* Global.testEnabled = !Global.testEnabled;\n         var btn_node = this.node.getChildByName('test_btn');\n         if (btn_node) {\n             var label = btn_node.getChildByName('Label');\n             label.getComponent(cc.Label).string = '测试 ' + (Global.testEnabled ? '开' : '关');\n         }*/\n\n    },\n\n    //关闭监听\n    closeListen: function () {\n        //关闭触摸\n        this.node.off(cc.Node.EventType.TOUCH_START, this.nodeStart, this);\n        //关闭移动\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.nodeMove, this);\n        //关闭结束\n        this.node.off(cc.Node.EventType.TOUCH_END, this.nodeEnd, this);\n    },\n\n    createAllGrid: function () {\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var parma = {\n                    hIndex: hIndex,\n                    vIndex: vIndex,\n                };\n                if (!this.allGrids[hIndex]) {\n                    this.allGrids[hIndex] = [];\n                }\n                this.allGrids[hIndex][vIndex] = this.createGrid(parma);\n            }\n        }\n    },\n\n    //创建格子\n    createGrid: function (parma) {\n        //参数\n        var hIndex = parma.hIndex;\n        var vIndex = parma.vIndex;\n        var posX = this.startX + hIndex * Global.itemSize + hIndex * Global.itemSplit;\n        var posY = this.startY - vIndex * Global.itemSize - vIndex * Global.itemSplit;\n\n        //设置格子的坐标\n        var gridItem = cc.instantiate(this.gridPrefab);\n        gridItem.setPosition(cc.p(posX, posY));\n\n        gridItem.setLocalZOrder(20);\n\n        //设置索引和位置\n        var gridView = gridItem.getComponent(\"gridView\");\n        gridView.node.setPosition(posX, posY);\n        gridView.setIndex(hIndex, vIndex, this);\n        this.node.addChild(gridItem);\n        return gridItem;\n    },\n\n    itemClick: function (event) {\n        var self = this;\n        if (!self.isClickBomming) {\n            return;\n        }\n        if (this.clickGridNum >= 1) {\n            return;\n        }\n        var clickGrid = event.getUserData();\n        self.clickGrid = clickGrid;\n\n        //道具缩放动画停止\n        this.prop.stopAllActions();\n        var scale1 = cc.scaleTo(0.1, 1, 1);\n        this.prop.runAction(scale1);\n\n        //停止生产下落的格子\n        // if (this.bornGrid) {\n        //     this.bornGrid.pauseAllActions();\n        // }\n        //this.node.stopAllActions();\n\n        //消除格子\n        var scaleTime = this.clickGrid.getComponent('gridView').item.getComponent(\"itemView\").clearItemToRemove();\n        this.clickGrid.getComponent('gridView').item = null;\n        //将上方的格子下落\n        var currHindex = this.clickGrid.getComponent('gridView').hIndex;\n        var currVindex = this.clickGrid.getComponent('gridView').vIndex;\n        for (let vIndex = currVindex - 1; vIndex > 0; vIndex--) {\n            var downtime = this.resetItemAction(currHindex, vIndex, true);\n        }\n\n        this.clickGridNum++;\n        this.isClickBomming = false;\n        //消耗金币\n        Global.wxGold -= Global.costGold;\n        //更新金币并存储\n        if (typeof wx !== 'undefined') {\n            let data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('gridController on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n            });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n        //更新分数\n        var goldLabel = this.goldNode.getChildByName('label');\n        goldLabel.getComponent(cc.Label).string = Global.wxGold;\n\n\n        //console.log('scaleTime:' + scaleTime);\n        //缩放动画播完后再继续下落合并的逻辑(马上按下暂停这里时间就会出现问题)\n        // this.node.stopAllActions();\n        // this.node.runAction(cc.sequence(cc.delayTime(scaleTime / 1000), cc.callFunc(self.process, self)));\n    },\n\n    //点击道具\n    clickProp: function () {\n        if (Global.wxGold < Global.costGold) {\n            console.log('my costGold is ' + Global.costGold);\n            return;\n        }\n\n        if (this.isClickBomming) {\n            this.resetProp();\n        } else {\n            var scale1 = cc.scaleBy(0.4, 1.1, 1.1);\n            var scale2 = cc.scaleBy(0.4, 1 / 1.1, 1 / 1.1);\n            var repeat = cc.repeat(cc.sequence(scale1, scale2), 99999);\n            this.prop.stopAllActions();\n            this.prop.runAction(repeat);\n            // if (this.bornGrid) {\n            //     this.bornGrid.pauseAllActions();\n            // }\n            // this.node.stopAllActions();\n            this.isClickBomming = true;\n            this.clickGridNum = 0;\n        }\n    },\n\n    resetProp: function () {\n        this.isClickBomming = false;\n        this.prop.stopAllActions();\n        var scale1 = cc.scaleTo(0.1, 1, 1);\n        this.prop.runAction(scale1);\n\n\n        // if (this.bornGrid) {\n        //恢复下落格子的动作，将当前格子的item置为下落格子item\n        // var bornGridhIndex = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n        // var bornGridvIndex = Math.ceil(Math.abs((this.bornGrid.y - this.startY) / Global.itemSize));\n        // this.allGrids[bornGridhIndex][bornGridvIndex].getComponent('gridView').item = this.bornGrid;\n        // this.isClickBomming = false;\n        //this.propClearTime = 0;\n        // this.process();\n        //     console.log('还可以继续下落');\n        // } else {\n        //     console.log('没有下落的格子');\n        // }\n    },\n\n    //先获取出生点那一列最终的目标点\n    getStopPosition: function (xBorn, yBorn) {\n        var addIndex = 0;\n        for (let index = Global.vNum - 1; index >= 0; index--) {\n            var node = this.allGrids[xBorn][index];\n            var gridView = node.getComponent(\"gridView\");\n            if (gridView && gridView.item == null && gridView.vIndex > yBorn) {\n                addIndex++;\n            }\n        }\n        return addIndex;\n    },\n\n    //设置鼠标或者手势操作动作\n    setTouchControl: function () {\n        var self = this;\n        if (self.node.parent) {\n            //开始触摸\n            self.node.on(cc.Node.EventType.TOUCH_START, this.nodeStart, this);\n            //触摸移动\n            self.node.on(cc.Node.EventType.TOUCH_MOVE, this.nodeMove, this);\n            //结束\n            self.node.on(cc.Node.EventType.TOUCH_END, this.nodeEnd, this);\n        }\n    },\n\n    nodeStart: function (event) {\n        if (!this.bornGrid) return;\n        this.startTouchPosition = event.getLocation();\n        this.moveItemIndex = this.createItemIndex;\n        this.moveStartX = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n    },\n\n    nodeMove: function (event) {\n        if (!this.bornGrid) return;\n        if (this.moveItemIndex != this.createItemIndex) {\n            return;\n        }\n        var self = this;\n        if (this.bornGrid && this.bornGrid.getComponent('itemView').canMove && !cc.game.isPaused() && !this.isClickBomming) {\n            var moveTemp = event.getLocation();\n            var dist = moveTemp.x - self.startTouchPosition.x;\n            var downDist = moveTemp.y - self.startTouchPosition.y;\n\n            //左右移动\n            var xPadding = Math.round(dist / Global.moveThreshold);\n            var isUpOrDown = Math.abs(downDist) > Global.moveDownThreshold ? true : false;\n\n            //self.startTouchPosition = moveTemp;\n            var targetGrid = self.canMoveGrid(this.moveStartX + xPadding);\n            if (isUpOrDown) {\n                console.log('xPadding---', xPadding);\n                //上下移动\n                var isTouchDown = moveTemp.y <= self.startTouchPosition.y ? true : false;\n                //self.startTouchPosition = moveTemp;\n                var targetGrid = self.canMoveQuickDown(isTouchDown);\n                if (targetGrid) {\n                    this.bornGrid.x = targetGrid.getPosition().x;\n                    var downNum = self.getStopPosition(targetGrid.getComponent('gridView').hIndex, targetGrid.getComponent('gridView').vIndex);\n                    var targetView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex + downNum];\n                    var priView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex];\n                    priView.getComponent('gridView').isDown = false;\n                    targetView.getComponent('gridView').isDown = true;\n\n                    this.bornGrid.getComponent('itemView').targetGrid = targetView;\n                    //快速开始进行从出生点到最终位置的动作\n                    //cc.log('quick down:' + downNum);\n                    if (this.bornGrid.getComponent('itemView').curState == 2 || this.bornGrid.getComponent('itemView').curState == 1) {\n                        self.maxDownTime = this.bornGrid.getComponent('itemView').startQuickDownForBorn(Global.gridQuickDownSpeed);\n                    }\n                    self.node.stopAllActions();\n                    self.checkGridJoin();\n                }\n            } else if (targetGrid) {\n                this.bornGrid.x = targetGrid.getPosition().x;\n                cc.log('change bornGridx:' + this.bornGrid.x);\n                var downNum = self.getStopPosition(targetGrid.getComponent('gridView').hIndex, targetGrid.getComponent('gridView').vIndex);\n                var targetView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex + downNum];\n                var priView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex];\n                priView.getComponent('gridView').isDown = false;\n                targetView.getComponent('gridView').isDown = true;\n\n                this.bornGrid.getComponent('itemView').targetGrid = targetView;\n                this.bornGrid.getComponent('itemView').changeStateToWaitDown(Global.gridDownSpeed);\n                self.node.stopAllActions();\n                self.checkGridJoin();\n            }\n        }\n    },\n\n    nodeEnd: function (event) {\n        if (!this.bornGrid) return;\n        /* if (this.moveItemIndex != this.createItemIndex) {\n             console.log('同一个格子');\n             return;\n         }*/\n\n        var yDist = Math.abs(event.getLocation().y - this.startTouchPosition.y);\n\n        if (yDist == 0) {\n            var self = this;\n            /*  console.log(\"currStatus:\", this.bornGrid.getComponent('itemView').curState, this.bornGrid.getComponent('itemView').canMove);\n              if (this.bornGrid.getComponent('itemView').curState == 3 || this.bornGrid.getComponent('itemView').curState == 4 || this.bornGrid.getComponent('itemView').curState == 5) {\n                  console.log('到达格子最顶部');\n                  return;\n              }\n\n              console.log('actionJoin', this.bornGrid);*/\n\n\n\n            var targetGrid = self.canMoveQuickDown(true);\n            if (targetGrid) {\n                this.bornGrid.x = targetGrid.getPosition().x;\n                var downNum = self.getStopPosition(targetGrid.getComponent('gridView').hIndex, targetGrid.getComponent('gridView').vIndex);\n                var targetView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex + downNum];\n                var priView = self.allGrids[targetGrid.getComponent('gridView').hIndex][targetGrid.getComponent('gridView').vIndex];\n                priView.getComponent('gridView').isDown = false;\n                targetView.getComponent('gridView').isDown = true;\n\n                this.bornGrid.getComponent('itemView').targetGrid = targetView;\n\n                cc.log('quick down:' + downNum);\n                //快速开始进行从出生点到最终位置的动作\n                if (this.bornGrid.getComponent('itemView').curState == 2 || this.bornGrid.getComponent('itemView').curState == 1) {\n                    self.maxDownTime = this.bornGrid.getComponent('itemView').startQuickDownForBorn(Global.gridQuickDownSpeed);\n                }\n                self.node.stopAllActions();\n                self.checkGridJoin();\n            }\n        }\n    },\n\n    /*是否可左右移动 */\n    canMoveGrid: function (hindex) {\n        //横、纵坐标的索引,向下取整\n        var _hIndex = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n        var _vIndex = Math.ceil(Math.abs((this.bornGrid.y - this.startY) / Global.itemSize));\n\n        if (hindex == _hIndex) {\n            return null;\n        }\n\n        if (hindex < 0 || hindex >= Global.hNum) {\n            return null;\n        }\n        //即将移动到的gird位置\b\n        //中间元素是否可以移动\n        let startX = hindex + 1;\n        let endx = _hIndex - 1;\n        if (hindex > _hIndex) {\n            startX = _hIndex + 1;\n            endx = hindex - 1;\n        }\n        while (startX <= endx) {\n            var soonMoveGrid = this.allGrids[startX][_vIndex];\n            if (soonMoveGrid && soonMoveGrid.getComponent(\"gridView\").item == null) {\n                startX++;\n                continue;\n            }\n            return null;\n        }\n        var soonMoveGrid = this.allGrids[hindex][_vIndex];\n\n        if (soonMoveGrid && soonMoveGrid.getComponent(\"gridView\").item == null) {\n            return soonMoveGrid;\n        }\n        return null;\n    },\n\n    /*是否可以向下移动 */\n    canMoveQuickDown: function (isTouchDown) {\n        //横、纵坐标的索引,向上取整\n        var hIndex = Math.ceil(Math.abs((this.bornGrid.x - this.startX) / Global.itemSize));\n        var vIndex = Math.floor(Math.abs((this.bornGrid.y - this.startY) / Global.itemSize));\n\n        if (!isTouchDown) {\n            return null;\n        }\n        if (vIndex >= (Global.vNum - 1)) {\n            return null;\n        }\n\n        var soonMoveGrid = this.allGrids[hIndex][vIndex + 1];\n        if (soonMoveGrid && soonMoveGrid.getComponent(\"gridView\").item == null) {\n            return soonMoveGrid;\n        }\n        return null;\n    },\n\n    //重设动作目标\n    resetItemAction: function (hindex, vindex, isClearGrid) {\n        var gridviewScript = this.allGrids[hindex][vindex].getComponent('gridView');\n        if (gridviewScript.item == null) {\n            return false;\n        }\n        var downNum;\n        if (isClearGrid) {\n            downNum = 1;\n        } else {\n            downNum = this.getStopPosition(hindex, vindex);\n        }\n        //设置索引\n        if (downNum == 0) {\n            return false;\n        }\n\n        var targetView = this.allGrids[hindex][vindex + downNum];\n        targetView.getComponent('gridView').isDown = true;\n        var _curitem = gridviewScript.item.getComponent('itemView');\n        _curitem.targetGrid = targetView;\n\n        var downSpeed = (this.isDown || Global.combineTimes > 0) ? Global.gridCombineDownSpeed : Global.gridDownSpeed;\n        console.log('速度：' + downSpeed, Global.combineTimes);\n        var curtime = _curitem.startDownForBorn(downSpeed);\n\n        gridviewScript.item = null;\n        //targetView.getComponent('gridView').item = _curitem;\n        gridviewScript.gridNum = 0;\n        //加入下落格子数组\n        this.downGrids.push(_curitem);\n\n        return true;\n    },\n\n    //游戏中暂停游戏\n    onPauseOrResume: function () {\n        Global.game.playSound('btn', 0.1);\n        if (Global.isPaused) {\n            if (this.bornGrid) {\n                this.bornGrid.resumeAllActions();\n            }\n            this.node.resumeAllActions();\n            this.pauseNode.active = false;\n            Global.isPaused = false;\n        } else {\n            if (this.isClickBomming) {\n                this.resetProp();\n            }\n            if (this.bornGrid) {\n                this.bornGrid.pauseAllActions();\n            }\n            this.node.pauseAllActions();\n\n            Global.isPaused = true;\n            this.pauseNode.active = true;\n            this.pauseNode.setLocalZOrder(10);\n        }\n    },\n\n    //游戏其他功能需要暂停游戏\n    onPauseGameForOther: function () {\n        if (Global.isPaused) {\n            if (this.bornGrid) {\n                this.bornGrid.resumeAllActions();\n            }\n            this.node.resumeAllActions();\n            Global.isPaused = false;\n        } else {\n            if (this.isClickBomming) {\n                this.resetProp();\n            }\n            if (this.bornGrid) {\n                this.bornGrid.pauseAllActions();\n            }\n            this.node.pauseAllActions();\n\n            Global.isPaused = true;\n        }\n    },\n\n    //显示数字选择\n    showChooseNum: function () {\n        Global.game.playSound('btn', 0.1);\n        this.chooseNode.active = true;\n        this.chooseNode.setLocalZOrder(1);\n        this.onPauseGameForOther();\n    },\n\n    //隐藏数字选择\n    hideChooseNum: function () {\n        Global.game.playSound('btn', 0.1);\n        this.chooseNode.active = false;\n        this.onPauseGameForOther();\n    },\n\n    //隐藏消除锤锤提示界面\n    hidePropTipsNode: function () {\n        Global.game.playSound('btn', 0.1);\n        this.clearTips.active = false;\n        this.onPauseGameForOther();\n        this.createDownGrid();\n        this.setSoonGrid();\n        this.process();\n        this.createItemIndex++;\n    },\n\n    //重新开始\n    onRestart: function () {\n        Global.game.playSound('btn', 0.1);\n        this.closeListen();\n        this.reset();\n\n        if (this.bornGrid && this.bornGrid.parent) {\n            this.bornGrid.parent.removeChild(this.bornGrid);\n        }\n        Global.game.restart();\n    },\n\n    //返回主界面\n    onMainScene: function () {\n        Global.game.playSound('btn', 0.1);\n        this.closeListen();\n        this.reset();\n\n        if (this.bornGrid && this.bornGrid.parent) {\n            this.bornGrid.parent.removeChild(this.bornGrid);\n        }\n        Global.game.startGame();\n        //返回主界面的时间如果是暂停状态那就恢复游戏\n        if (cc.game.isPaused()) {\n            cc.game.resume();\n        }\n    },\n\n    //分享\n    onShareGame: function () {\n        Global.game.playSound('btn', 0.1);\n        if (typeof FBInstant !== 'undefined') {\n            ThirdAPI.shareGame(this.getImgBase64(), null);\n        } else {\n            ThirdAPI.shareGame('screenshotForDown', null, null, '244');\n        }\n    },\n\n    //更新星星的数量\n    updateGold: function (goldNum) {\n        var goldLabel = this.goldNode.getChildByName('label');\n        goldLabel.getComponent(cc.Label).string = Global.wxGold;\n        //判断是否可以存储和飞入\n        if (Global.addGold[goldNum] === undefined) {\n            cc.log('update gold ');\n            return;\n        }\n        if (parseInt(Global.addGold[goldNum]) <= 0) {\n            return;\n        }\n        Global.wxGold += parseInt(Global.addGold[goldNum]);\n        console.log('1 :' + Global.addGold[goldNum] + \"goldNum :\" + goldNum);\n        //更新并存储\n        if (typeof wx !== 'undefined') {\n            let data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore((maxscore, gold) => {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('gridController on ThirdAPI loadScore', score, parseInt(gold), Global.wxGold);\n            });\n            ThirdAPI.saveScore(score, Global.wxGold);\n        }\n        this.showGold();\n    },\n\n    showGold: function () {\n        var goldLabel = this.goldNode.getChildByName('label');\n        goldLabel.getComponent(cc.Label).string = Global.wxGold;\n    },\n\n    bombRunAction: function () {\n        if (this.bombNode.active) {\n            this.bombNode.rotation = 0;\n            this.bombNode.stopAllActions();\n            this.bombNode.runAction(\n                cc.repeatForever(\n                    cc.sequence(cc.rotateBy(0.1, 10), cc.rotateBy(0.2, -20), cc.rotateBy(0.2, 20), cc.rotateBy(0.2, -20), cc.rotateBy(0.1, 10), cc.delayTime(2)))\n            );\n        }\n    },\n\n    //拉起分享炸最上面的一行\n    onBombShare() {\n        Global.game.playSound('btn', 0.1);\n        //记载点击'炸'按钮打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.useBomb, null);\n\n        this.pauseInterval = true;\n        if (typeof FBInstant !== 'undefined') {\n            var myUtil = require('myUtil');\n            ThirdAPI.shareGame(myUtil.getImgBase64(), this.onBombShareSuccess.bind(this));\n        } else if (typeof wx !== 'undefined') {\n            let EChannelPrefix = require(\"EChannelPrefix\");\n            ThirdAPI.sendChannelPrefix(EChannelPrefix.gift);\n            ThirdAPI.shareGame('randomImg', this.onBombShareSuccess.bind(this), this.onBombShareFail.bind(this), '253');\n        } else {\n            this.onBombShareSuccess();\n        }\n    },\n\n    //使用炸弹炸一行\n    onBombShareSuccess: function (openGId) {\n        //炸分享成功打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.bombShareSuccess, null);\n\n        //查找出需要炸掉的哪一行\n        var needBombIndex = -1;\n        for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n            for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    needBombIndex = vIndex;\n                    break;\n                }\n            }\n            if (needBombIndex > -1) {\n                break;\n            }\n        }\n\n        if (needBombIndex < 0) return;\n        console.log('needBombIndex:', needBombIndex);\n\n        if (typeof wx !== 'undefined') {\n            if (!openGId) {\n                Global.game.showDialogText('分享失败，分享到群才有效');\n                console.log('分享失败，分享到群才有效');\n                return;\n            }\n        }\n        if (Global.gameinfo.shareData1.arrOpenGId.indexOf(openGId) != -1) {\n            console.log('该群今日已经分享过', openGId);\n            Global.game.showDialogText('分享失败，请分享到不同群');\n            return;\n        } else {\n            console.log('该群未分享过', openGId);\n            Global.gameinfo.shareData1.arrOpenGId.push(openGId);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        this.bombShareTimes++;\n        this.bombSurplus.string = Global.cdnGameConfig.bombShareTimes - this.bombShareTimes;\n        this.bombNode.active = this.bombShareTimes < Global.cdnGameConfig.bombShareTimes ? true : false;\n        if (!this.bombNode.active) {\n            this.bombNode.stopAllActions();\n        }\n\n        this.onPauseGameForOther();\n        this.node.stopAllActions();\n        this.closeListen();\n\n        if (this.bornGrid) {\n            this.bornGrid.stopAllActions();\n        }\n\n        //暂停所有的格子动作\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    gridView.node.stopAllActions();\n                    gridView.item.getComponent(\"itemView\").node.stopAllActions();\n                }\n            }\n        }\n\n        //闪烁效果\n        var blinkPos = this.allGrids[Global.bornXgridNum][needBombIndex].getPosition();\n        this.blinkSpr.node.setPosition(blinkPos);\n        this.blinkSpr.node.width = Global.hNum * Global.itemSize;\n\n        this.blinkSpr.node.stopAllActions();\n        this.blinkSpr.node.setLocalZOrder(2000);\n        var myAction = cc.sequence(cc.fadeTo(0.3, 255), cc.fadeTo(0.3, 0), cc.fadeTo(0.3, 255), cc.fadeTo(0.3, 0), cc.fadeTo(0.3, 255), cc.fadeTo(0.3, 0));\n        this.blinkSpr.node.runAction(myAction);\n\n        var actions = [];\n        var time = 1.8;\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            var grid = this.allGrids[hIndex][needBombIndex];\n            var gridView = grid.getComponent(\"gridView\");\n            if (gridView && gridView.item != null) {\n                var itemViewScript = gridView.item.getComponent(\"itemView\");\n                var clearTime = itemViewScript.clearItemToRemove(time);\n                time += clearTime;\n                gridView.gridNum = 0;\n                gridView.item = null;\n            }\n        }\n\n        this.clearAllJoin();\n\n        var self = this;\n        self.node.runAction(cc.sequence(cc.delayTime(time + 0.1), cc.callFunc(function () {\n            self.onPauseGameForOther();\n            //添加触摸侦听\n            self.setTouchControl();\n            if (self.bornGrid) {\n                var targetGrid = self.bornGrid.getComponent('itemView').targetGrid;\n                var currBornXGridNum = targetGrid.getComponent('gridView').hIndex;\n\n                var downNum = self.getStopPosition(currBornXGridNum, 0);\n                var targetView = self.allGrids[currBornXGridNum][downNum];\n                self.bornGrid.getComponent('itemView').targetGrid = targetView;\n                self.bornGrid.getComponent('itemView').startDownForBorn(Global.gridDownSpeed);\n            }\n            //开始处理业务逻辑\n            self.process();\n        })));\n    },\n\n    onBombShareFail: function (msg) {\n        console.log('分享失败！');\n        if (msg === undefined) {\n            Global.game.showDialogText('分享失败！');\n        } else if (msg == 'fail') {\n            Global.game.showDialogText('分享失败，分享到群才有效');\n        } else if (msg == 'cancel') {\n            Global.game.showDialogText('分享失败！');\n        } else {\n            Global.game.showDialogText('分享失败！');\n        }\n    },\n\n    //游戏结束\n    gameOver: function () {\n        this.node.stopAllActions();\n        this.closeListen();\n        ThirdAPI.clearGameProgressInfo();\n        //取消定时器\n        cc.director.getScheduler().unschedule(this.getNextFriend, this);\n        //销毁banner广告\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n\n        //获取复活次数\n        Global.reviveShareTimes = ThirdAPI.loadReviveData();\n\n        //判断当局的次数和当天的复活次数\n        if (Global.reviveTimes < Global.reviveTotalTimes && Global.reviveShareTimes > 0) {\n            Global.game.showRevive();\n            // Global.reviveUI.setScore(this.scoreScript.scoreNum);\n        } else {\n            Global.game.showShareUI();\n            //Global.shareUI.updateMaxLabel(this.scoreScript.scoreNum);\n        }\n    },\n\n    //复活消除几行\n    clearGridForRevive: function () {\n        this.node.stopAllActions();\n        //取消定时器\n        cc.director.getScheduler().unschedule(this.getNextFriend, this);\n\n        //暂停所有的格子动作\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    gridView.node.stopAllActions();\n                    gridView.item.getComponent(\"itemView\").node.stopAllActions();\n                }\n            }\n        }\n\n        //开始销毁行数\n        var time = 0;\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.clearVNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null) {\n                    var itemViewScript = gridView.item.getComponent(\"itemView\");\n                    var clearTime = itemViewScript.toRevive();\n                    if (clearTime > time) {\n                        time = clearTime;\n                    }\n                    gridView.gridNum = 0;\n                    gridView.item = null;\n                }\n            }\n        }\n\n        //开始销毁小于64的格子\n        /*var time = 0;\n        for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n            for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                var grid = this.allGrids[hIndex][vIndex];\n                var gridView = grid.getComponent(\"gridView\");\n                if (gridView && gridView.item != null && gridView.gridNum < 64) {\n                    var itemViewScript = gridView.item.getComponent(\"itemView\");\n                    var clearTime = itemViewScript.toRevive();\n                    if (clearTime > time) {\n                        time = clearTime;\n                    }\n                    gridView.gridNum = 0;\n                    gridView.item = null;\n                }\n            }\n        }*/\n\n        this.clearAllJoin();\n\n        //销毁所有数字\n        for (let index = 0; index < Global.flyNumPools.length; index++) {\n            const element = Global.flyNumPools[index];\n            if (element && element.parent) {\n                element.getComponent('flynum').finished();\n            }\n        }\n\n        //添加触摸侦听\n        console.log('clear time:' + time);\n        var self = this;\n        self.node.runAction(cc.sequence(cc.delayTime(time + 0.1), cc.callFunc(function () {\n            //记载复活成功打点\n            var biManager = require('biManager');\n            biManager.bilog(biManager.reviveSuccess, null);\n\n            if (self.bornGrid) {\n                self.bornGrid.stopAllActions();\n                if (self.bornGrid.parent) {\n                    self.bornGrid.parent.removeChild(self.bornGrid);\n                }\n            }\n            self.bornGrid = null;\n\n            //重置所有数据\n            //self.reset();\n            //初始化棋盘\n            //self.createAllGrid();\n            //添加触摸侦听\n            self.setTouchControl();\n            //开始处理业务逻辑\n            self.process();\n        })));\n    },\n\n    /*\n    //时间判断加速\n    update: function () {\n        var unixTime = (new Date()).getTime();\n        if (unixTime > (this.startTime + Global.accessTime) && this.addTimes < Global.addTimes) {\n            this.addTimes++;\n            this.startTime = (new Date()).getTime();\n\n            Global.gridDownSpeed *= 1.2;\n            Global.gridDownSpeed = parseInt(Global.gridDownSpeed * 100) / 100;\n            Global.waitToDown *= 0.8;\n            Global.waitToDown = parseInt(Global.waitToDown * 100) / 100;\n            console.log('加速', Global.gridDownSpeed, Global.waitToDown);\n        }\n    },*/\n\n    //重置\n    reset: function () {\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n\n        this.node.stopAllActions();\n        cc.director.getScheduler().unschedule(this.getNextFriend, this);\n\n        this.popDialogTimes = 0;\n        this.bombShareTimes = 0;\n        //初始时间\n        this.startTime = (new Date()).getTime();\n        this.usePropTimes = 0;\n        this.useSuperTimes = 0;\n        this.useDoubleTimes = 0;\n        this.useProp = -1;\n        this.setPropSprite();\n        Global.usePropStatus = -1;\n        this.addTimes = 0;\n        Global.reviveTimes = 0;\n        Global.combineTimes = 0;\n        Global.testEnabled = false;\n        this.randomScore = 0;\n        Global.joinRandomScores = [];\n        Global.isPaused = false;\n        this.isClickBomming = false;\n        this.propClearTime = 0;\n        this.clickGridNum = 0;\n        this.createItemIndex = 0;\n        this.moveItemIndex = 0;\n        this.createItemNum = 0;\n        Global.isPropGuide = false;\n        //销毁所有数字\n        for (let index = 0; index < Global.flyNumPools.length; index++) {\n            const element = Global.flyNumPools[index];\n            if (element && element.parent) {\n                element.getComponent('flynum').finished();\n            }\n        }\n\n        if (this.bornGrid) {\n            this.bornGrid.stopAllActions();\n            if (this.bornGrid.parent) {\n                this.bornGrid.parent.removeChild(this.bornGrid);\n            }\n        }\n        //销毁所有格子\n        if (this.allGrids.length > 0) {\n            for (let hIndex = 0; hIndex < Global.hNum; hIndex++) {\n                for (let vIndex = 0; vIndex < Global.vNum; vIndex++) {\n                    var grid = this.allGrids[hIndex][vIndex];\n                    var gridView = grid.getComponent(\"gridView\");\n                    grid.stopAllActions();\n                    if (gridView && gridView.item != null) {\n                        gridView.item.getComponent(\"itemView\").toRemove();\n                    }\n\n                    //销毁grid\n                    if (grid.parent) {\n                        grid.parent.removeChild(grid);\n                    }\n                }\n            }\n            this.clearAllJoin();\n        }\n        this.allGrids = [];\n        this.scoreScript.reset();\n        this.bornGrid = null;\n        if (this.soonGridInstance && this.soonGridInstance.parent) {\n            this.soonGridInstance.parent.removeChild(this.soonGridInstance);\n        }\n        //重置道具数量\n        if (Global.gameinfo && (Global.gameinfo.clearPropNum > 1 || Global.gameinfo.superPropNum > 1)) {\n            if (Global.gameinfo.clearPropNum > 1) {\n                Global.gameinfo.clearPropNum = 1;\n            }\n            if (Global.gameinfo.superPropNum > 1) {\n                Global.gameinfo.superPropNum = 1;\n            }\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        //设置概率\n        var myUtil = require('myUtil');\n        myUtil.randomForWeight(Global.weightConfig.oneWeightRate, Global.weightConfig.oneTotalWeight);\n    },\n});"]}