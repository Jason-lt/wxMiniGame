{"version":3,"sources":["reviveUI.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","sLabel","default","type","Label","lbl_countdown","tip","shareLabel","rewardAdBtn","Node","shareBtn","shareNotReviveBtn","scoreNum","start","initData","showBannerAd","startContinueConutDown","setShowButton","gridControllerScript","Global","gridController","getComponent","setScore","scoreScript","node","active","console","log","wxBannerAd","createBannerAd","wx","cdnGameConfig","totalSwith","reviveScoreSwith","reviveScoreLimit","wxScore","canRevive","FBInstant","times","string","pauseInterval","countDownInterval","setInterval","giveUpShare","clearInterval","score","rewardVideoAdShare","game","playSound","destroyBannerAd","wxRewardVideoAd","initCreateReward","onWxRewardVideoSuccess","bind","onWxRewardVideoFailed","parent","removeChild","reviveShareTimes","saveReviveData","reviveTimes","clearGridForRevive","shareGame","myUtil","getImgBase64","onShareSuccess","EChannelPrefix","sendChannelPrefix","resurrection","onShareFailed","openGId","biManager","bilog","reviveShare","showDialogText","gameinfo","shareData2","arrOpenGId","indexOf","push","saveFriendGenStoneInfo","shareNotRevive","onShareNotReviveSuccess","dead2","showShareUI"],"mappings":"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","file":"reviveUI.js","sourceRoot":"../../../../../assets/Scripts/ui","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\nlet ThirdAPI = require('../common/ThirdAPI')\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        sLabel: {\n            default: null,\n            type: cc.Label\n        },\n        lbl_countdown: {\n            default: null,\n            type: cc.Label\n        },\n        tip: {\n            default: null,\n            type: cc.Label\n        },\n        shareLabel: {\n            default: null,\n            type: cc.Label\n        },\n\n        rewardAdBtn: {\n            default: null,\n            type: cc.Node\n        },\n        shareBtn: {\n            default: null,\n            type: cc.Node\n        },\n        shareNotReviveBtn: {\n            default: null,\n            type: cc.Node\n        },\n\n        scoreNum: 0,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start() {\n\n    },\n\n    initData: function () {\n        this.showBannerAd();\n\n        this.startContinueConutDown();\n        this.setShowButton();\n        var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n        if (gridControllerScript) {\n            this.setScore(gridControllerScript.scoreScript.scoreNum);\n        }\n        this.tip.node.active = false;\n    },\n\n    //显示banner广告\n    showBannerAd: function () {\n        console.log('reviveUI show bannerAd');\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n    },\n\n    //设置显示按钮\n    setShowButton: function () {\n        this.rewardAdBtn.active = false;\n        this.shareBtn.active = false;\n\n        if (typeof wx !== 'undefined') {\n            if (Global.cdnGameConfig.totalSwith) {\n                if (Global.cdnGameConfig.reviveScoreSwith) {\n                    //判断分数\n                    console.log('判断分数：', Global.cdnGameConfig.reviveScoreLimit, Global.wxScore);\n                    var canRevive = Global.wxScore > Global.cdnGameConfig.reviveScoreLimit ? true : false;\n                    if (canRevive) {\n                        console.log('是否可以复活');\n                        this.shareBtn.active = true;\n                    } else {\n                        this.rewardAdBtn.active = true;\n                    }\n                } else {\n                    console.log('复活分数开关已经关闭', Global.cdnGameConfig.reviveScoreSwith);\n                    this.shareBtn.active = true;\n                }\n            } else {\n                this.rewardAdBtn.active = true;\n            }\n        } else if (typeof FBInstant !== 'undefined') {\n            this.shareBtn.active = true;\n        } else {\n            this.shareBtn.active = true;\n        }\n    },\n    /*\n        //设置分享按钮文本\n        setShareLabel: function () {\n            if (typeof wx !== 'undefined') {\n                if (Global.cdnGameConfig.totalSwith) {\n                    this.shareLabel.string = \"看视频消\" + Global.clearVNum + \"行\"; //'分享也不能复活';\n                    //this.shareNotRevive.active = true;\n                } else {\n                    if (Global.cdnGameConfig.reviveScoreSwith) {\n                        //判断分数\n                        console.log('判断分数：', Global.cdnGameConfig.reviveScoreLimit, Global.wxScore);\n                        var canRevive = Global.wxScore > Global.cdnGameConfig.reviveScoreLimit ? true : false;\n                        if (canRevive) {\n                            console.log('是否可以复活');\n                            this.shareLabel.string = '分享到群继续玩';\n                        } else {\n                            this.shareLabel.string = \"分享也不能复活\"; //'分享也不能复活';\n                            //this.shareNotRevive.active = true;\n                        }\n                    } else {\n                        console.log('分享开关已经关闭', Global.cdnGameConfig.reviveScoreSwith);\n                        this.shareLabel.string = '分享到群继续玩';\n                    }\n                }\n            } else if (typeof FBInstant !== 'undefined') {\n                this.shareLabel.string = 'share game';\n            } else {\n                this.shareLabel.string = '分享复活';\n            }\n        },*/\n\n    //设置倒计时\n    startContinueConutDown: function () {\n        let times = 10;\n        this.lbl_countdown.string = times;\n        this.pauseInterval = false;\n        this.countDownInterval = setInterval(() => {\n            if (!this.pauseInterval) {\n                times--;\n                if (times >= 0) {\n                    this.lbl_countdown.string = times;\n                } else {\n                    this.giveUpShare();\n                    clearInterval(this.countDownInterval);\n                }\n            }\n        }, 1000);\n    },\n\n    //设置分数\n    setScore: function (score) {\n        this.scoreNum = score;\n        if (typeof wx !== 'undefined') {\n            this.sLabel.string = '当前分数：' + this.scoreNum;\n        } else if (typeof FBInstant !== 'undefined') {\n            this.sLabel.string = 'current score:' + this.scoreNum;\n        } else {\n            this.sLabel.string = '当前分数:' + this.scoreNum;\n        }\n    },\n\n    //看视频分享游戏   \n    rewardVideoAdShare: function () {\n        Global.game.playSound('btn', 0.1);\n\n        this.tip.node.active = false;\n        this.pauseInterval = true;\n\n        //删除banner广告\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.destroyBannerAd();\n\n        var wxRewardVideoAd = require('wxRewardVideoAd');\n        wxRewardVideoAd.initCreateReward(this.onWxRewardVideoSuccess.bind(this), this.onWxRewardVideoFailed.bind(this));\n    },\n\n    //看视频成功\n    onWxRewardVideoSuccess: function () {\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n\n        if (this.node.parent) {\n            this.node.parent.removeChild(this.node);\n        }\n        this.pauseInterval = false;\n        clearInterval(this.countDownInterval);\n\n        //可以复活\n        Global.reviveShareTimes--;\n        //保存本地\n        if (Global.reviveShareTimes > -1) {\n            ThirdAPI.saveReviveData(Global.reviveShareTimes);\n        }\n        //当局复活次数加1\n        Global.reviveTimes++;\n\n        //开始消除格子，继续游戏\n        var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n        gridControllerScript.clearGridForRevive();\n    },\n\n    //看视频失败\n    onWxRewardVideoFailed: function () {\n        this.pauseInterval = false;\n        console.log('onWxRewardVideoFailed');\n    },\n\n\n    //分享\n    shareGame: function () {\n        Global.game.playSound('btn', 0.1);\n\n        this.tip.node.active = false;\n        this.pauseInterval = true;\n\n\n        if (typeof FBInstant !== 'undefined') {\n            var myUtil = require('myUtil');\n            ThirdAPI.shareGame(myUtil.getImgBase64(), this.onShareSuccess.bind(this));\n        } else if (typeof wx !== 'undefined') {\n            console.log('----------------复活分享-----------------');\n            let EChannelPrefix = require(\"EChannelPrefix\");\n            ThirdAPI.sendChannelPrefix(EChannelPrefix.resurrection);\n            ThirdAPI.shareGame('randomImg', this.onShareSuccess.bind(this), this.onShareFailed.bind(this), '250');\n        } else {\n            this.onShareSuccess();\n        }\n\n        /*\n                //删除banner广告\n                var wxBannerAd = require('wxBannerAd');\n                wxBannerAd.destroyBannerAd();\n\n                var wxRewardVideoAd = require('wxRewardVideoAd');\n                wxRewardVideoAd.initCreateReward(this.onShareSuccess.bind(this), this.onWxRewardVideoFailed.bind(this));*/\n\n\n        /* //星星复活\n         if (Global.wxGold < Global.reviveConfig.costNum) {\n             Global.game.showDialogPropText('星星数量不足！');\n             this.pauseInterval = false;\n             return;\n         }\n         Global.wxGold -= parseInt(Global.reviveConfig.costNum);\n         var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n         gridControllerScript.showGold();\n         Global.game.saveScore();\n         this.onShareSuccess();*/\n    },\n\n    //分享成功\n    onShareSuccess: function (openGId) {\n        //游戏过程中复活分享并分享成功\n        var biManager = require('biManager');\n        biManager.bilog(biManager.reviveShare, null);\n\n        /*\n        //总开关判断\n        if (Global.cdnGameConfig.totalSwith) {\n            this.giveUpShare();\n            clearInterval(this.countDownInterval);\n            console.log('功能开关已打开1');\n            return;\n        } else {\n            //分数开关判断\n            if (Global.cdnGameConfig.reviveScoreSwith) {\n                //判断分数\n                console.log('判断分数：', Global.cdnGameConfig.reviveScoreLimit, Global.wxScore);\n                var canRevive = Global.wxScore > Global.cdnGameConfig.reviveScoreLimit ? true : false;\n\n                if (!canRevive) {\n                    this.giveUpShare();\n                    clearInterval(this.countDownInterval);\n                    console.log('revive复活界面--分数开关已打开2');\n                    return;\n                }\n            }\n        }*/\n\n        //是否分享到群\n        if (typeof wx !== 'undefined') {\n            if (!openGId) {\n                this.pauseInterval = false;\n                Global.game.showDialogText('分享失败，分享到群才能复活');\n                console.log('分享失败，分享到群才能复活');\n                return;\n            }\n        }\n        if (Global.gameinfo.shareData2.arrOpenGId.indexOf(openGId) != -1) {\n            console.log('该群今日已经分享过', openGId);\n            this.pauseInterval = false;\n            Global.game.showDialogText('该群今日已经分享过无法复活');\n            return;\n        } else {\n            console.log('该群未分享过', openGId);\n            Global.gameinfo.shareData2.arrOpenGId.push(openGId);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n\n        var wxBannerAd = require('wxBannerAd');\n        wxBannerAd.createBannerAd();\n\n        if (this.node.parent) {\n            this.node.parent.removeChild(this.node);\n        }\n        this.pauseInterval = false;\n        clearInterval(this.countDownInterval);\n\n        //可以复活\n        Global.reviveShareTimes--;\n        //保存本地\n        if (Global.reviveShareTimes > -1) {\n            ThirdAPI.saveReviveData(Global.reviveShareTimes);\n        }\n        //当局复活次数加1\n        Global.reviveTimes++;\n\n        //开始消除格子，继续游戏\n        var gridControllerScript = Global.gridController.getComponent(\"gridController\");\n        gridControllerScript.clearGridForRevive();\n    },\n\n    //分享失败\n    onShareFailed: function () {\n        this.pauseInterval = false;\n        console.log('分享失败');\n        Global.game.showDialogText('分享失败');\n    },\n\n    //分享也不能复活\n    shareNotRevive: function () {\n        Global.game.playSound('btn', 0.1);\n\n        this.tip.node.active = false;\n        this.pauseInterval = true;\n\n        if (typeof FBInstant !== 'undefined') {\n            var myUtil = require('myUtil');\n            ThirdAPI.shareGame(myUtil.getImgBase64(), this.onShareSuccess.bind(this));\n        } else if (typeof wx !== 'undefined') {\n            console.log('----分享也不能复活的分享----');\n            let EChannelPrefix = require(\"EChannelPrefix\");\n            ThirdAPI.sendChannelPrefix(EChannelPrefix.resurrection);\n            ThirdAPI.shareGame('randomImg', this.onShareNotReviveSuccess.bind(this), this.onShareFailed.bind(this), '250');\n        } else {\n            this.onShareNotReviveSuccess();\n        }\n    },\n\n    //分享也不能复活（分享成功）\n    onShareNotReviveSuccess: function () {\n        this.giveUpShare();\n        clearInterval(this.countDownInterval);\n        console.log('revive复活界面--分数开关已打开，分数未达到，也不能复活');\n    },\n\n    //放弃分享\n    giveUpShare: function () {\n        Global.game.playSound('btn', 0.1);\n        //记载死亡后跳过打点\n        var biManager = require('biManager');\n        biManager.bilog(biManager.dead2, null);\n\n        if (this.node.parent) {\n            this.node.parent.removeChild(this.node);\n        }\n        this.pauseInterval = false;\n        clearInterval(this.countDownInterval);\n        Global.game.showShareUI();\n        //Global.shareUI.updateMaxLabel(this.scoreNum);\n    },\n});"]}