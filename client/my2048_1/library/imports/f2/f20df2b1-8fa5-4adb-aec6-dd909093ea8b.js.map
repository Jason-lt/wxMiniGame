{"version":3,"sources":["../../../../../assets/Scripts/ui/assets/Scripts/ui/rewardItem.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","shareBtn","default","type","Node","canTakeBtn","takedBtn","descLabel","Label","rewardLabel","parma","targetUserId","start","setInfo","desc","inviteNum","inviteTotalNum","str","replace","progress","Global","tcpData","clickItems","parseInt","length","string","rewardNum","active","index","id","targetUser","isGet","userId","onShareGame","game","playSound","FBInstant","shareGame","getImgBase64","wx","onShareSuccess","bind","biManager","bilog","rewardShare","takeReward","showDialogPropText","inviteFriend"],"mappings":"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","file":"rewardItem.js","sourceRoot":"../../../../../assets/Scripts/ui","sourcesContent":["let ThirdAPI = require('../common/ThirdAPI')\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //分享按钮\n        shareBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        //可领取按钮\n        canTakeBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        //已领取按钮\n        takedBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        descLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        rewardLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        parma: null,\n        targetUserId: 0, //领取自己链接被点之后的用户id\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start() {\n\n    },\n\n    setInfo: function (parma) {\n        this.targetUserId = 0;\n        this.parma = parma;\n        //格式化字符串\n        var desc = parma.desc;\n        var inviteNum = parma.inviteTotalNum;\n        var str = desc.replace('{0}', inviteNum);\n        var progress = 0;\n        if (Global.tcpData.clickItems) {\n            progress = parseInt(Global.tcpData.clickItems.length) > parseInt(this.parma.inviteTotalNum) ? parseInt(this.parma.inviteTotalNum) : parseInt(Global.tcpData.clickItems.length);\n        }\n        str += '(' + progress + '/' + parseInt(this.parma.inviteTotalNum) + ')';\n\n        this.descLabel.string = str;\n        this.rewardLabel.string = parseInt(parma.rewardNum);\n\n        this.shareBtn.active = false;\n        this.canTakeBtn.active = false;\n        this.takedBtn.active = false;\n\n        //按钮显示状态\n        if (Global.tcpData.clickItems) {\n            //\n            var index = parseInt(this.parma.id) - 1;\n            var targetUser = Global.tcpData.clickItems[index];\n            if (targetUser) {\n                if (parseInt(targetUser.isGet) > 0) {\n                    this.takedBtn.active = true;\n                } else {\n                    this.canTakeBtn.active = true;\n                    this.targetUserId = parseInt(targetUser.userId);\n                }\n            } else {\n                this.shareBtn.active = true;\n            }\n        } else {\n            this.shareBtn.active = true;\n        }\n    },\n\n    //分享\n    onShareGame: function () {\n        Global.game.playSound('btn', 0.1);\n\n        if (typeof FBInstant !== 'undefined') {\n            ThirdAPI.shareGame(this.getImgBase64(), null);\n        } else if (typeof wx !== 'undefined') {\n            ThirdAPI.shareGame('randomImg', this.onShareSuccess.bind(this), null, '244');\n        }\n    },\n\n    onShareSuccess: function () {\n        //游戏好友互助分享成功\n        var biManager = require('biManager');\n        biManager.bilog(biManager.rewardShare, null);\n    },\n\n    //领取\n    takeReward: function () {\n        if (this.targetUserId <= 0 || !Global.tcpData.clickItems) {\n            Global.game.showDialogPropText('不能领取奖励');\n            return;\n        }\n        //tcpManager.sendCmd.sendFetchClickReward(this.targetUserId);\n    },\n\n    //邀请按钮触发\n    inviteFriend: function () {\n\n    },\n\n\n\n});"]}