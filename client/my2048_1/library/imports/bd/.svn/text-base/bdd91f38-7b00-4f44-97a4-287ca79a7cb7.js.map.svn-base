{"version":3,"sources":["../../../../../assets/Scripts/ui/assets/Scripts/ui/rewardUI.js"],"names":["ThirdAPI","require","cc","Class","extends","Component","properties","content","default","type","Node","rewardItem","Prefab","drwaSprite","dailyLabel","Label","stoneNum","dailyCanTakeBtn","dailyTakedBtn","dailyTime","dailyRewardLabel","itemHeight","list","initData","resetData","setMyStoneNum","drawMyInfo","createItem","setDailyInfo","setShowTime","index","Global","rewardConfig","items","length","item","instantiate","setPosition","p","rewardScript","getComponent","parma","setInfo","addChild","push","height","refreshList","console","log","tcpData","drawRect","x","y","width","cleanDrwaSprite","getRank","rect","callback","entries","updateWxRank","Sprite","spriteFrame","num","string","wxGold","progress","isAmGet","undefined","parseInt","isPmGet","dailyRewardNum","active","myUtil","time1","time2","str","getFormatTime","startTime","endTime","onShareGame","game","playSound","FBInstant","shareGame","getImgBase64","wx","onShareSuccess","bind","biManager","bilog","rewardShare","onFetchDailyReward","showDialogPropText","myDate","Date","currSecondes","getHours","getMinutes","getSeconds","onAm","onPm","takeAllDailyReward","refreshDailyInfo","msg","startUI","updateGold","onClose","node","parent","removeChild","showGameClub","update","dt","openDataContext","getOpenDataContext","sharedCanvas","canvas","texture","Texture2D","initWithElement","handleLoadedTexture","sp","SpriteFrame","error"],"mappings":";;;;;;;;AAAI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,WAAWC,QAAQ,oBAAR,CAAf;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,iBAAS;AACLC,qBAAS,IADJ;AAELC,kBAAMP,GAAGQ;AAFJ,SADD;AAKRC,oBAAY;AACRH,qBAAS,IADD;AAERC,kBAAMP,GAAGU;AAFD,SALJ;AASRC,oBAAY;AACRL,qBAAS,IADD;AAERC,kBAAMP,GAAGQ;AAFD,SATJ;AAaRI,oBAAY;AACRN,qBAAS,IADD;AAERC,kBAAMP,GAAGa;AAFD,SAbJ;AAiBRC,kBAAU;AACNR,qBAAS,IADH;AAENC,kBAAMP,GAAGa;AAFH,SAjBF;AAqBRE,yBAAiB;AACbT,qBAAS,IADI;AAEbC,kBAAMP,GAAGQ;AAFI,SArBT;AAyBRQ,uBAAe;AACXV,qBAAS,IADE;AAEXC,kBAAMP,GAAGQ;AAFE,SAzBP;AA6BRS,mBAAW;AACPX,qBAAS,IADF;AAEPC,kBAAMP,GAAGa;AAFF,SA7BH;AAiCRK,0BAAkB;AACdZ,qBAAS,IADK;AAEdC,kBAAMP,GAAGa;AAFK,SAjCV;AAqCRM,oBAAY,GArCJ;AAsCRC,cAAM;AAtCE,KAHP;;AA4CL;AACAC,cAAU,oBAAY;AAClB,aAAKC,SAAL;AACA,aAAKC,aAAL,CAAmB,CAAnB;AACA,aAAKC,UAAL;AACA,aAAKC,UAAL;AACA,aAAKC,YAAL;AACA,aAAKC,WAAL;AACH,KApDI;;AAsDL;AACAF,gBAAY,sBAAY;AACpB,aAAKL,IAAL,GAAY,EAAZ;AACA,aAAK,IAAIQ,QAAQ,CAAjB,EAAoBA,QAAQC,OAAOC,YAAP,CAAoBC,KAApB,CAA0BC,MAAtD,EAA8DJ,OAA9D,EAAuE;AACnE,gBAAIK,OAAOjC,GAAGkC,WAAH,CAAe,KAAKzB,UAApB,CAAX;AACAwB,iBAAKE,WAAL,CAAiBnC,GAAGoC,CAAH,CAAK,CAAL,EAAQ,CAAC,IAAI,CAAJ,GAAQR,KAAT,IAAkB,CAAC,KAAKT,UAAhC,CAAjB;AACA,gBAAIkB,eAAeJ,KAAKK,YAAL,CAAkB,YAAlB,CAAnB;AACA,gBAAIC,QAAQV,OAAOC,YAAP,CAAoBC,KAApB,CAA0BH,KAA1B,CAAZ;AACAS,yBAAaG,OAAb,CAAqBD,KAArB;AACA,iBAAKlC,OAAL,CAAaoC,QAAb,CAAsBR,IAAtB;AACA,iBAAKb,IAAL,CAAUsB,IAAV,CAAeT,IAAf;AACH;AACD,aAAK5B,OAAL,CAAasC,MAAb,GAAsBd,OAAOC,YAAP,CAAoBC,KAApB,CAA0BC,MAA1B,GAAmC,KAAKb,UAA9D;AACH,KAnEI;;AAqEL;AACAyB,iBAAa,uBAAY;AACrBC,gBAAQC,GAAR,CAAY,MAAZ,EAAoBjB,OAAOkB,OAA3B;AACA,aAAK,IAAInB,QAAQ,CAAjB,EAAoBA,QAAQ,KAAKR,IAAL,CAAUY,MAAtC,EAA8CJ,OAA9C,EAAuD;AACnD,gBAAIK,OAAO,KAAKb,IAAL,CAAUQ,KAAV,CAAX;AACA,gBAAIK,IAAJ,EAAU;AACN,oBAAII,eAAeJ,KAAKK,YAAL,CAAkB,YAAlB,CAAnB;AACA,oBAAIC,QAAQV,OAAOC,YAAP,CAAoBC,KAApB,CAA0BH,KAA1B,CAAZ;AACAS,6BAAaG,OAAb,CAAqBD,KAArB;AACH;AACJ;AACJ,KAhFI;;AAkFL;AACAf,gBAAY,sBAAY;AAAA;;AACpB,aAAKwB,QAAL,GAAgB;AACZC,eAAG,CADS;AAEZC,eAAG,CAFS;AAGZC,mBAAO,KAAKxC,UAAL,CAAgBwC,KAHX;AAIZR,oBAAQ,KAAKhC,UAAL,CAAgBgC;AAJZ,SAAhB;;AAOA,aAAKS,eAAL;AACAtD,iBAASuD,OAAT,CAAiB;AACbC,kBAAM,KAAKN,QADE;AAEbO,sBAAU,kBAACC,OAAD,EAAa;AACnB,oBAAI,QAAOA,OAAP,yCAAOA,OAAP,OAAmB,QAAvB,EAAiC;AAC7B;AACA;AACH,iBAHD,MAGO,IAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AACpC,0BAAKC,YAAL,GAAoB,EAApB;AACH;AACJ;AATY,SAAjB,EAUG,QAVH;AAWH,KAvGI;;AAyGLL,qBAAiB,2BAAY;AACzB,aAAKzC,UAAL,CAAgB2B,YAAhB,CAA6BtC,GAAG0D,MAAhC,EAAwCC,WAAxC,GAAsD,IAAtD;AACH,KA3GI;AA4GL;AACApC,mBAAe,uBAAUqC,GAAV,EAAe;AAC1B,aAAK9C,QAAL,CAAc+C,MAAd,GAAuBhC,OAAOiC,MAAP,GAAgBF,GAAvC;AACH,KA/GI;;AAiHL;AACAlC,kBAAc,wBAAY;AACtB,YAAIqC,WAAW,CAAf;AACA,YAAIlC,OAAOkB,OAAX,EAAoB;AAChBF,oBAAQC,GAAR,CAAY,YAAZ,EAA0BjB,OAAOkB,OAAP,CAAeiB,OAAzC;AACA,gBAAInC,OAAOkB,OAAP,CAAeiB,OAAf,KAA2BC,SAA/B,EAA0C;AACtCF,4BAAYG,SAASrC,OAAOkB,OAAP,CAAeiB,OAAxB,CAAZ;AACH;AACD,gBAAInC,OAAOkB,OAAP,CAAeoB,OAAf,KAA2BF,SAA/B,EAA0C;AACtCF,4BAAYG,SAASrC,OAAOkB,OAAP,CAAeoB,OAAxB,CAAZ;AACH;AACJ;AACD,aAAKvD,UAAL,CAAgBiD,MAAhB,GAAyB,UAAUE,QAAV,GAAqB,KAA9C;AACA,aAAK7C,gBAAL,CAAsB2C,MAAtB,GAA+BhC,OAAOC,YAAP,CAAoBsC,cAApB,GAAqC,EAApE;;AAEA;AACA,YAAIL,YAAY,CAAhB,EAAmB;AACf,iBAAKhD,eAAL,CAAqBsD,MAArB,GAA8B,KAA9B;AACA,iBAAKrD,aAAL,CAAmBqD,MAAnB,GAA4B,IAA5B;AACH,SAHD,MAGO;AACH,iBAAKtD,eAAL,CAAqBsD,MAArB,GAA8B,IAA9B;AACA,iBAAKrD,aAAL,CAAmBqD,MAAnB,GAA4B,KAA5B;AACH;AACJ,KAxII;;AA0IL;AACA1C,iBAAa,uBAAY;AACrB,YAAI2C,SAASvE,QAAQ,QAAR,CAAb;AACA,YAAIwE,QAAQ1C,OAAOC,YAAP,CAAoBb,SAApB,CAA8B,CAA9B,CAAZ;AACA,YAAIuD,QAAQ3C,OAAOC,YAAP,CAAoBb,SAApB,CAA8B,CAA9B,CAAZ;AACA,YAAIwD,MAAMH,OAAOI,aAAP,CAAqBR,SAASK,MAAMI,SAAf,CAArB,IAAkD,IAAlD,GAAyDL,OAAOI,aAAP,CAAqBR,SAASK,MAAMK,OAAf,CAArB,CAAnE;AACAH,eAAO,OAAOH,OAAOI,aAAP,CAAqBR,SAASM,MAAMG,SAAf,CAArB,CAAP,GAAyD,IAAzD,GAAgEL,OAAOI,aAAP,CAAqBR,SAASM,MAAMI,OAAf,CAArB,CAAvE;AACA,aAAK3D,SAAL,CAAe4C,MAAf,GAAwBY,GAAxB;AACH,KAlJI;;AAoJL;AACAI,iBAAa,uBAAY;AACrBhD,eAAOiD,IAAP,CAAYC,SAAZ,CAAsB,KAAtB,EAA6B,GAA7B;;AAEA,YAAI,OAAOC,SAAP,KAAqB,WAAzB,EAAsC;AAClClF,qBAASmF,SAAT,CAAmB,KAAKC,YAAL,EAAnB,EAAwC,IAAxC;AACH,SAFD,MAEO,IAAI,OAAOC,EAAP,KAAc,WAAlB,EAA+B;AAClCrF,qBAASmF,SAAT,CAAmB,WAAnB,EAAgC,KAAKG,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAhC,EAAgE,IAAhE,EAAsE,KAAtE;AACH;AACJ,KA7JI;;AA+JLD,oBAAgB,0BAAY;AACxB;AACA,YAAIE,YAAYvF,QAAQ,WAAR,CAAhB;AACAuF,kBAAUC,KAAV,CAAgBD,UAAUE,WAA1B,EAAuC,IAAvC;AACH,KAnKI;;AAqKL;AACAC,wBAAoB,8BAAY;AAC5B,YAAI1B,WAAWG,SAASrC,OAAOkB,OAAP,CAAeiB,OAAxB,IAAmCE,SAASrC,OAAOkB,OAAP,CAAeoB,OAAxB,CAAlD;AACA,YAAIJ,YAAY,CAAhB,EAAmB;AACflC,mBAAOiD,IAAP,CAAYY,kBAAZ,CAA+B,aAA/B;AACA;AACH;;AAED,YAAIC,SAAS,IAAIC,IAAJ,EAAb;AACA,YAAIC,eAAeF,OAAOG,QAAP,KAAoB,IAApB,GAA2BH,OAAOI,UAAP,KAAsB,EAAjD,GAAsDJ,OAAOK,UAAP,EAAzE;AACAnD,gBAAQC,GAAR,CAAY,eAAZ,EAA6B+C,YAA7B;AACA;AACA,YAAItB,QAAQ1C,OAAOC,YAAP,CAAoBb,SAApB,CAA8B,CAA9B,CAAZ;AACA,YAAIuD,QAAQ3C,OAAOC,YAAP,CAAoBb,SAApB,CAA8B,CAA9B,CAAZ;AACA,YAAIgF,OAAQ1B,MAAMI,SAAN,IAAmBkB,YAAnB,IAAmCA,gBAAgBtB,MAAMK,OAA1D,GAAqE,IAArE,GAA4E,KAAvF;AACA,YAAIsB,OAAQ1B,MAAMG,SAAN,IAAmBkB,YAAnB,IAAmCA,gBAAgBrB,MAAMI,OAA1D,GAAqE,IAArE,GAA4E,KAAvF;AACA,YAAIqB,QAAQC,IAAZ,EAAkB;AACd,gBAAID,QAAQ/B,SAASrC,OAAOkB,OAAP,CAAeiB,OAAxB,IAAmC,CAA/C,EAAkD;AAC9CnB,wBAAQC,GAAR,CAAY,YAAZ;AACAjB,uBAAOiD,IAAP,CAAYY,kBAAZ,CAA+B,gBAA/B;AACA;AACH;AACD,gBAAIQ,QAAQhC,SAASrC,OAAOkB,OAAP,CAAeoB,OAAxB,IAAmC,CAA/C,EAAkD;AAC9CtB,wBAAQC,GAAR,CAAY,YAAZ;AACAjB,uBAAOiD,IAAP,CAAYY,kBAAZ,CAA+B,gBAA/B;AACA;AACH;AACJ,SAXD,MAWO;AACH7D,mBAAOiD,IAAP,CAAYY,kBAAZ,CAA+B,SAA/B;AACA;AACH;AACD;AACH,KArMI;;AAuML;AACAS,wBAAoB,8BAAY;AAC5B,YAAIpC,WAAWG,SAASrC,OAAOkB,OAAP,CAAeiB,OAAxB,IAAmCE,SAASrC,OAAOkB,OAAP,CAAeoB,OAAxB,CAAlD;AACA,YAAIJ,YAAY,CAAhB,EAAmB;AACflC,mBAAOiD,IAAP,CAAYY,kBAAZ,CAA+B,aAA/B;AACH;AACJ,KA7MI;;AA+ML;AACAU,sBAAkB,4BAAY;AAC1B,YAAIC,MAAM,gBAAgBxE,OAAOC,YAAP,CAAoBsC,cAApC,GAAqD,GAA/D;AACAvC,eAAOiD,IAAP,CAAYY,kBAAZ,CAA+BW,GAA/B;AACAxE,eAAOyE,OAAP,CAAeC,UAAf,CAA0B1E,OAAOC,YAAP,CAAoBsC,cAA9C;;AAEA,aAAK1C,YAAL;AACA,aAAKH,aAAL,CAAmB,CAAnB;AACH,KAvNI;;AAyNL;AACAiF,aAAS,mBAAY;AACjB3E,eAAOiD,IAAP,CAAYC,SAAZ,CAAsB,KAAtB,EAA6B,GAA7B;AACA,YAAI,KAAK0B,IAAL,CAAUC,MAAd,EAAsB;AAClB,iBAAKD,IAAL,CAAUC,MAAV,CAAiBC,WAAjB,CAA6B,KAAKF,IAAlC;AACH;AACD3G,iBAAS8G,YAAT,CAAsB,IAAtB;AACH,KAhOI;;AAkOLtF,eAAW,qBAAY;AACnB,aAAK,IAAIM,QAAQ,CAAjB,EAAoBA,QAAQ,KAAKR,IAAL,CAAUY,MAAtC,EAA8CJ,OAA9C,EAAuD;AACnD,gBAAIK,OAAO,KAAKb,IAAL,CAAUQ,KAAV,CAAX;AACA,gBAAIK,KAAKyE,MAAT,EAAiB;AACbzE,qBAAKyE,MAAL,CAAYC,WAAZ,CAAwB1E,IAAxB;AACH;AACJ;AACJ,KAzOI;;AA2OL4E,UA3OK,kBA2OEC,EA3OF,EA2OM;AACP,YAAI,KAAKrD,YAAL,IAAqB,KAAKA,YAAL,GAAoB,GAA7C,EAAkD;AAC9C,iBAAKA,YAAL,GAAoB,CAApB;AACA,gBAAI;AACA,oBAAIsD,kBAAkB5B,GAAG6B,kBAAH,EAAtB;AACA,oBAAIC,eAAeF,gBAAgBG,MAAnC;;AAEA,oBAAIC,UAAU,IAAInH,GAAGoH,SAAP,EAAd;AACAD,wBAAQE,eAAR,CAAwBJ,YAAxB;AACAE,wBAAQG,mBAAR;AACA,oBAAIC,KAAK,IAAIvH,GAAGwH,WAAP,CAAmBL,OAAnB,CAAT;;AAEA,qBAAKxG,UAAL,CAAgBwC,KAAhB,GAAwBgE,QAAQhE,KAAhC;AACA,qBAAKxC,UAAL,CAAgBgC,MAAhB,GAAyBwE,QAAQxE,MAAjC;AACA,qBAAKhC,UAAL,CAAgB2B,YAAhB,CAA6BtC,GAAG0D,MAAhC,EAAwCC,WAAxC,GAAsD4D,EAAtD;AACH,aAZD,CAYE,OAAOE,KAAP,EAAc,CAEf;AACJ,SAjBD,MAiBO;AACH,iBAAKhE,YAAL;AACH;AACJ;AAhQI,CAAT","file":"rewardUI.js","sourceRoot":"../../../../../assets/Scripts/ui","sourcesContent":["    // Learn cc.Class:\n    //  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n    //  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n    // Learn Attribute:\n    //  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n    //  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n    // Learn life-cycle callbacks:\n    //  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n    //  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\n    let ThirdAPI = require('../common/ThirdAPI')\n    cc.Class({\n        extends: cc.Component,\n\n        properties: {\n            content: {\n                default: null,\n                type: cc.Node\n            },\n            rewardItem: {\n                default: null,\n                type: cc.Prefab\n            },\n            drwaSprite: {\n                default: null,\n                type: cc.Node\n            },\n            dailyLabel: {\n                default: null,\n                type: cc.Label\n            },\n            stoneNum: {\n                default: null,\n                type: cc.Label\n            },\n            dailyCanTakeBtn: {\n                default: null,\n                type: cc.Node\n            },\n            dailyTakedBtn: {\n                default: null,\n                type: cc.Node\n            },\n            dailyTime: {\n                default: null,\n                type: cc.Label\n            },\n            dailyRewardLabel: {\n                default: null,\n                type: cc.Label\n            },\n            itemHeight: 105,\n            list: [],\n        },\n\n        //奖励界面初始化\n        initData: function () {\n            this.resetData();\n            this.setMyStoneNum(0);\n            this.drawMyInfo();\n            this.createItem();\n            this.setDailyInfo();\n            this.setShowTime();\n        },\n\n        //创建奖励列表\n        createItem: function () {\n            this.list = [];\n            for (let index = 0; index < Global.rewardConfig.items.length; index++) {\n                var item = cc.instantiate(this.rewardItem);\n                item.setPosition(cc.p(0, (1 / 2 + index) * -this.itemHeight));\n                var rewardScript = item.getComponent('rewardItem');\n                var parma = Global.rewardConfig.items[index];\n                rewardScript.setInfo(parma);\n                this.content.addChild(item);\n                this.list.push(item);\n            }\n            this.content.height = Global.rewardConfig.items.length * this.itemHeight;\n        },\n\n        //服务器回调数据，刷新列表显示\n        refreshList: function () {\n            console.log('开始刷新', Global.tcpData);\n            for (let index = 0; index < this.list.length; index++) {\n                var item = this.list[index];\n                if (item) {\n                    var rewardScript = item.getComponent('rewardItem');\n                    var parma = Global.rewardConfig.items[index];\n                    rewardScript.setInfo(parma);\n                }\n            }\n        },\n\n        //绘制头像和名称\n        drawMyInfo: function () {\n            this.drawRect = {\n                x: 0,\n                y: 0,\n                width: this.drwaSprite.width,\n                height: this.drwaSprite.height\n            };\n\n            this.cleanDrwaSprite();\n            ThirdAPI.getRank({\n                rect: this.drawRect,\n                callback: (entries) => {\n                    if (typeof entries === 'object') {\n                        //this.updateContent(entries);\n                        // this.getMyRank();\n                    } else if (typeof entries === 'string') {\n                        this.updateWxRank = 50;\n                    }\n                }\n            }, 'MyInfo')\n        },\n\n        cleanDrwaSprite: function () {\n            this.drwaSprite.getComponent(cc.Sprite).spriteFrame = null;\n        },\n        //设置星星数量\n        setMyStoneNum: function (num) {\n            this.stoneNum.string = Global.wxGold + num;\n        },\n\n        //设置每日领取的信息\n        setDailyInfo: function () {\n            var progress = 0;\n            if (Global.tcpData) {\n                console.log('dailyInfo:', Global.tcpData.isAmGet);\n                if (Global.tcpData.isAmGet !== undefined) {\n                    progress += parseInt(Global.tcpData.isAmGet);\n                }\n                if (Global.tcpData.isPmGet !== undefined) {\n                    progress += parseInt(Global.tcpData.isPmGet);\n                }\n            }\n            this.dailyLabel.string = '每日领奖(' + progress + \"/2)\";\n            this.dailyRewardLabel.string = Global.rewardConfig.dailyRewardNum + \"\";\n\n            //更新按钮状态\n            if (progress >= 2) {\n                this.dailyCanTakeBtn.active = false;\n                this.dailyTakedBtn.active = true;\n            } else {\n                this.dailyCanTakeBtn.active = true;\n                this.dailyTakedBtn.active = false;\n            }\n        },\n\n        //设置每日领取的时间段\n        setShowTime: function () {\n            var myUtil = require('myUtil');\n            var time1 = Global.rewardConfig.dailyTime[0];\n            var time2 = Global.rewardConfig.dailyTime[1];\n            var str = myUtil.getFormatTime(parseInt(time1.startTime)) + '--' + myUtil.getFormatTime(parseInt(time1.endTime));\n            str += '\\n' + myUtil.getFormatTime(parseInt(time2.startTime)) + '--' + myUtil.getFormatTime(parseInt(time2.endTime));\n            this.dailyTime.string = str;\n        },\n\n        // 分享功能  intent(\"INVITE\" | \"REQUEST\" | \"CHALLENGE\" | \"SHARE\") 表示分享的意图\n        onShareGame: function () {\n            Global.game.playSound('btn', 0.1);\n\n            if (typeof FBInstant !== 'undefined') {\n                ThirdAPI.shareGame(this.getImgBase64(), null);\n            } else if (typeof wx !== 'undefined') {\n                ThirdAPI.shareGame('randomImg', this.onShareSuccess.bind(this), null, '244');\n            }\n        },\n\n        onShareSuccess: function () {\n            //游戏好友互助分享成功\n            var biManager = require('biManager');\n            biManager.bilog(biManager.rewardShare, null);\n        },\n\n        //领取每日奖励\n        onFetchDailyReward: function () {\n            var progress = parseInt(Global.tcpData.isAmGet) + parseInt(Global.tcpData.isPmGet);\n            if (progress >= 2) {\n                Global.game.showDialogPropText('你已经领取过今日奖励了');\n                return;\n            }\n\n            var myDate = new Date();\n            var currSecondes = myDate.getHours() * 3600 + myDate.getMinutes() * 60 + myDate.getSeconds();\n            console.log('currSecondes:', currSecondes);\n            //判断上午时间和下午时间\n            var time1 = Global.rewardConfig.dailyTime[0];\n            var time2 = Global.rewardConfig.dailyTime[1];\n            var onAm = (time1.startTime <= currSecondes && currSecondes <= time1.endTime) ? true : false;\n            var onPm = (time2.startTime <= currSecondes && currSecondes <= time2.endTime) ? true : false;\n            if (onAm || onPm) {\n                if (onAm && parseInt(Global.tcpData.isAmGet) > 0) {\n                    console.log('上午奖励已经领取过了');\n                    Global.game.showDialogPropText('当前时间段的奖励已经领取过了');\n                    return;\n                }\n                if (onPm && parseInt(Global.tcpData.isPmGet) > 0) {\n                    console.log('下午奖励已经领取过了');\n                    Global.game.showDialogPropText('当前时间段的奖励已经领取过了');\n                    return;\n                }\n            } else {\n                Global.game.showDialogPropText('领取时间还没到');\n                return;\n            }\n            //tcpManager.sendCmd.sendFetchDailyReward();\n        },\n\n        //已经领取过两次奖励\n        takeAllDailyReward: function () {\n            var progress = parseInt(Global.tcpData.isAmGet) + parseInt(Global.tcpData.isPmGet);\n            if (progress >= 2) {\n                Global.game.showDialogPropText('你已经领取过今日奖励了');\n            }\n        },\n\n        //刷新星星信息\n        refreshDailyInfo: function () {\n            var msg = '领取每日奖励成功,获得' + Global.rewardConfig.dailyRewardNum + '钻';\n            Global.game.showDialogPropText(msg);\n            Global.startUI.updateGold(Global.rewardConfig.dailyRewardNum);\n\n            this.setDailyInfo();\n            this.setMyStoneNum(0);\n        },\n\n        // 按钮回调：关闭\n        onClose: function () {\n            Global.game.playSound('btn', 0.1);\n            if (this.node.parent) {\n                this.node.parent.removeChild(this.node);\n            }\n            ThirdAPI.showGameClub(true);\n        },\n\n        resetData: function () {\n            for (let index = 0; index < this.list.length; index++) {\n                var item = this.list[index];\n                if (item.parent) {\n                    item.parent.removeChild(item);\n                }\n            }\n        },\n\n        update(dt) {\n            if (this.updateWxRank && this.updateWxRank > 100) {\n                this.updateWxRank = 1;\n                try {\n                    let openDataContext = wx.getOpenDataContext();\n                    let sharedCanvas = openDataContext.canvas;\n\n                    let texture = new cc.Texture2D();\n                    texture.initWithElement(sharedCanvas);\n                    texture.handleLoadedTexture();\n                    let sp = new cc.SpriteFrame(texture);\n\n                    this.drwaSprite.width = texture.width;\n                    this.drwaSprite.height = texture.height;\n                    this.drwaSprite.getComponent(cc.Sprite).spriteFrame = sp;\n                } catch (error) {\n\n                }\n            } else {\n                this.updateWxRank++;\n            }\n        },\n    });"]}