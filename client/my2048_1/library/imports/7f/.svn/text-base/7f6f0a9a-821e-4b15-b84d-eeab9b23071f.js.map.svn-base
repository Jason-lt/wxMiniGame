{"version":3,"sources":["../../../../../assets/Scripts/common/assets/Scripts/common/wxAPI.js"],"names":["WXGlobal","initOnEnter","console","log","options","getLaunchOptionsSync","shareTicket","scene","query","isSticky","queryString","setShareTicketEnabled","showShareMenu","registShare","registOnShow","registOnError","userInfo","nickName","maxscore","gold","iv","signature","gender","avatarUrl","sysInfo","wx","getSystemInfoSync","SDKVersion","replace","slice","GameClubButton","createGameClubButton","icon","style","left","top","width","height","showGameClub","error","value","show","hide","onError","res","message","stack","getAuth","callback","getUserInfo","success","setUserCloudStorage","KVDataList","key","fail","errMsg","indexOf","complete","self","myUtil","require","onShareAppMessage","imageurl","Global","cdnShareImages","length","randomForArray","image","shareImages","text","cdnTexts","shareTexts","EChannelPrefix","regular","channelPrefix","getShareInfo","shareObj","title","imageUrl","info","shareType","shareSuccess","complet","onShareAppMsg","sendChannelPrefix","imgUrl","data","err","code","isFromGroup","ThirdAPI","helpInfo","gameinfo","inviteUserList","inviteDate","Date","now","toDateString","userList","saveFriendGenStoneInfo","inviteCode","parseInt","extraParam","getTime","sendTime","cdnGameConfig","validTime","sourceCode","push","getHelpInfo","onShow","onShowInfo","res1","msg","registOnHide","onHide","onHideInfo","shareGame","imageTag","failcallback","sourcecode","getShareScreenShot","setQueryInfo","getShareScreenShotForDown","propShareImages","img","propShareTexts","shareAppMessage","shareTickets","shareTicketEnabled","result","encryptedData","tywx","UserInfo","wxgame_session_key","resultString","decrypt","JSON","parse","openid","openGId","crypted","crypto","Buffer","decipher","createDecipheriv","decoded","update","final","login","setMaxScore","isEnabled","updateShareMenu","withShareTicket","obj","getShareUserInfo","hideShareMenu","params","canvas","toTempFilePathSync","x","y","destWidth","destHeight","getScreenShot","initFriendRank","openDataContext","getOpenDataContext","type","postMessage","getNextFriendRank","score","rect","getFriendRank","getGroupRank","undefined","getDailyRank","getMyInfo","userId","SystemInfo","gameId","saveScore","resetInitData","dailyScore","dailyTime","loadScore","shakeShort","vibrateShort","shakeLong","vibrateLong","exit","exitMiniProgram","getSystemInfo","module","exports"],"mappings":"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","file":"wxAPI.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["import dataStatistics from '../lib_dataStatistics/dataStatistics.js';\n\nlet WXGlobal = {\n\n\n    initOnEnter: function () {\n        console.log('get launch options')\n        let options = this.getLaunchOptionsSync();\n        console.log('launch options', options);\n        this.shareTicket = options.shareTicket;\n        this.scene = options.scene;\n        this.query = options.query;\n        this.isSticky = options.isSticky;\n        this.queryString = '';\n\n        this.setShareTicketEnabled(true);\n        this.showShareMenu();\n        // this.getAuth();\n        this.registShare();\n        this.registOnShow();\n        this.registOnError();\n\n        this.userInfo = {\n            nickName: '不愿透露姓名的老王',\n            maxscore: 0,\n            gold: 0,\n            iv: '',\n            signature: '',\n            gender: 1,\n            avatarUrl: 'res/raw-assets/resources/textures/gridItem/rank_1.png'\n        }\n\n        try {\n            var sysInfo = wx.getSystemInfoSync();\n            console.log('sysinfo: ', sysInfo, sysInfo.SDKVersion.replace(/\\./g, \"\"));\n            if (sysInfo.SDKVersion.slice(0, 5).replace(/\\./g, \"\") >= 203) {\n                this.GameClubButton = wx.createGameClubButton({\n                    icon: 'green',\n                    style: {\n                        left: 8,\n                        top: 60,\n                        width: 40,\n                        height: 40\n                    }\n                })\n\n                this.showGameClub(false);\n            } \n        } catch (error) {\n            \n        }\n\n        /*\n        var sysInfo = wx.getSystemInfoSync();\n        console.log('sysinfo: ', sysInfo, sysInfo.SDKVersion.replace(/\\./g, \"\"));\n        if (sysInfo.SDKVersion.slice(0, 5).replace(/\\./g, \"\") >= 203) {\n            this.GameClubButton = wx.createGameClubButton({\n                icon: 'green',\n                style: {\n                    left: 20,\n                    top: 20,\n                    width: 40,\n                    height: 40\n                }\n            })\n        }*/\n\n        //this.showGameClub();\n    },\n\n    showGameClub: function (value) {\n        if (!this.GameClubButton) return;\n\n        if (value) {\n            console.log('显示游戏圈按钮');\n            this.GameClubButton.show()\n        } else {\n            console.log('隐藏游戏圈按钮');\n            this.GameClubButton.hide()\n        }\n    },\n\n    registOnError: function () {\n        wx.onError((res) => {\n            console.log('wx error:' + res.message + '\\nstack:\\n' + res.stack);\n        })\n    },\n\n    getAuth: function (callback) {\n        wx.getUserInfo({\n            success: function (res) {\n                // iOS 和 Android 对于拒绝授权的回调 errMsg 没有统一，需要做一下兼容处理\n                console.log(res);\n                WXGlobal.userInfo = res.userInfo\n                WXGlobal.setUserCloudStorage({\n                    KVDataList: [{\n                            key: 'name',\n                            value: res.userInfo.nickName\n                        },\n                        {\n                            key: 'gender',\n                            value: res.userInfo.gender + ''\n                        },\n                        {\n                            key: 'avatarUrl',\n                            value: res.userInfo.avatarUrl\n                        },\n                        {\n                            key: 'iv',\n                            value: res.iv\n                        },\n                        {\n                            key: 'signature',\n                            value: res.signature\n                        },\n                    ],\n                    success: function () {\n                        console.log('set User Cloud Storage success');\n                    }\n                })\n            },\n            fail: function (res) {\n                // iOS 和 Android 对于拒绝授权的回调 errMsg 没有统一，需要做一下兼容处理\n                if (res.errMsg.indexOf('auth deny') > -1 || res.errMsg.indexOf('auth denied') > -1) {\n                    // 处理用户拒绝授权的情况\n                    console.log(res);\n                    WXGlobal.userInfo = {\n                        nickName: '不愿透露姓名的老王',\n                        maxscore: 0,\n                        gold: 0,\n                        iv: '',\n                        signature: '',\n                        gender: 1,\n                        avatarUrl: 'res/raw-assets/resources/textures/gridItem/rank_1.png'\n                    }\n                    console.log('set UserInfo default');\n                }\n            },\n            complete: function () {\n                if (callback) {\n                    callback();\n                }\n            }\n        })\n    },\n\n    registShare: function () {\n        var self = this;\n        var myUtil = require(\"myUtil\");\n        this.onShareAppMessage(() => {\n            //self.shareGame('randomImg', null, null, '001');\n\n            //分享图片\n            var imageurl;\n            if (Global.cdnShareImages && Global.cdnShareImages.length > 0) {\n                imageurl = myUtil.randomForArray(Global.cdnShareImages);\n                console.log('从cdn请求分享图：', imageurl);\n            } else {\n                var image = myUtil.randomForArray(Global.shareImages);\n                imageurl = 'res/raw-assets/resources/textures/gridItem/' + image;\n                console.log('从本地请求分享图：', imageurl);\n            }\n\n            //分享文字\n            var text;\n            if (Global.cdnTexts && Global.cdnTexts.length > 0) {\n                text = myUtil.randomForArray(Global.cdnTexts);\n                console.log('从cdn请求分享文字：', text);\n            } else {\n                text = myUtil.randomForArray(Global.shareTexts);\n                console.log('从本地读取分享文字：', text);\n            }\n\n            //let dataStatistics = require(\"dataStatistics\");\n\n            //当分享信息需要常规右上角信息的时候 \n            let EChannelPrefix = require(\"EChannelPrefix\");\n            console.log('*********************分享场景值: ', EChannelPrefix.regular);\n            this.channelPrefix = EChannelPrefix.regular;\n            dataStatistics.getShareInfo(EChannelPrefix.regular);\n\n            console.log(\"被动转发\");\n            let shareObj = {\n                title: text,\n                imageUrl: imageurl,\n                query: '',\n                success: (info) => {\n                    console.log(\"被动转发 成功:\", info);\n                    //代码在这里!!!\n                    //需要传的参数:shareType \n                    //passive为右上角分享,initiative为主动分享 \n                    let shareType = 'passive';\n                    dataStatistics.shareSuccess(shareType);\n                },\n                complet: info => {\n                    console.log(\"被动转发完成:\", info);\n                }\n            }\n\n            shareObj = dataStatistics.onShareAppMsg(shareObj)\n            console.log(shareObj)\n            return shareObj\n\n\n            /*\n                        var myUtil = require(\"myUtil\");\n                        var text = myUtil.randomForArray(Global.shareTexts);\n                        console.log('用户点击了右上按钮并分享,query:', WXGlobal.queryString, ' text:' + text);\n                        var img = WXGlobal.getShareScreenShot();\n\n                        self.setQueryInfo(sourcecode, imageurl);\n\n                        WXGlobal.shareAppMessage({\n                            title: text,\n                            imageUrl: img,\n                            query: WXGlobal.queryString\n                        });*/\n        })\n    },\n\n    sendChannelPrefix: function (key) {\n        //let dataStatistics = require(\"dataStatistics\");\n\n        //当分享信息需要常规右上角信息的时候 \n        console.log('*********************分享场景值: ', key);\n        this.channelPrefix = key;\n        dataStatistics.getShareInfo(key,res=>{\n            console.log('======================getShareInfo success!',res)\n            let imgUrl = res.data.data.image; // 分享图片路径 let title = res.data.data.title; // 分享文字信息\n            },err=>{\n                \n            console.log('======================getShareInfo failed!',err)\n            //注意:当小游戏处于断网时,或者其他错误时 console.log(err)\n            let code = err.code; // 错误码10110\n            let data = err.data; // {errMsg: \"request:fail \"} let msg = err.msg; // \"request fail\"\n            })\n    },\n\n    isFromGroup: function () {\n        let ThirdAPI = require('../common/ThirdAPI');\n        console.log('global shareticket', WXGlobal.shareTicket);\n        console.log('WXGlobal helpInfo', WXGlobal.helpInfo);\n        //console.log('比较分享点是否为送宝箱点：', parseInt(WXGlobal.helpInfo.sourceCode), parseInt(WXGlobal.helpInfo.sourceCode) == parseInt(\"3010000400\"));\n\n        if (!WXGlobal.shareTicket) {\n            return -1;\n        }\n        if (!WXGlobal.helpInfo) {\n            return -1;\n        }\n\n        //凌晨兼容判断\n        if (!Global.gameinfo.inviteUserList || Global.gameinfo.inviteUserList.inviteDate != (new Date(Date.now())).toDateString()) {\n            Global.gameinfo.inviteUserList = {\n                inviteDate: (new Date(Date.now())).toDateString(),\n                userList: [],\n            };\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n        }\n        //分享到同一群只能获得一次\n        var inviteCode = parseInt(WXGlobal.helpInfo.inviteCode);\n        if (Global.gameinfo && Global.gameinfo.inviteUserList) {\n            console.log('领取群小卡片判断是否今日领取过');\n            if (Global.gameinfo.inviteUserList.userList.indexOf(inviteCode) != -1) {\n                console.log('该群已经领取过奖励', inviteCode);\n                return -1;\n            }\n        }\n        //额外参数\n        if (Global.helpInfo.extraParam) {\n            console.log('额外参数：', Global.helpInfo.extraParam);\n            if ((new Date()).getTime() - parseInt(Global.helpInfo.extraParam.sendTime) > Global.cdnGameConfig.validTime) {\n                console.log('奖励失效,超过了一小时不能领取奖励');\n                return -1;\n            }\n        }\n\n        if (parseInt(WXGlobal.helpInfo.sourceCode) === parseInt(\"248\")) {\n            console.log('获得清除道具');\n            console.log('该群未领取过奖励', inviteCode);\n            Global.gameinfo.inviteUserList.userList.push(inviteCode);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n            return 1;\n        }\n        if (parseInt(WXGlobal.helpInfo.sourceCode) === parseInt(\"249\")) {\n            console.log('获得万能道具');\n            console.log('该群未领取过奖励', inviteCode);\n            Global.gameinfo.inviteUserList.userList.push(inviteCode);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n            return 2;\n        }\n        if (parseInt(WXGlobal.helpInfo.sourceCode) === parseInt(\"3010000300\")) {\n            console.log('获得双倍道具');\n            console.log('该群未领取过奖励', inviteCode);\n            Global.gameinfo.inviteUserList.userList.push(inviteCode);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n            return 3;\n        }\n        if (parseInt(WXGlobal.helpInfo.sourceCode) === parseInt(\"137\")) {\n            console.log('获得钻石');\n            console.log('该群未领取过奖励', inviteCode);\n            Global.gameinfo.inviteUserList.userList.push(inviteCode);\n            ThirdAPI.saveFriendGenStoneInfo(Global.gameinfo);\n            return 4;\n        }\n        return -1;\n    },\n\n    getHelpInfo: function () {\n        return WXGlobal.helpInfo;\n    },\n\n    registOnShow: function () {\n        wx.onShow((res) => {\n            console.log('wx onShow+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++', res);\n            if (res.shareTicket) {\n                WXGlobal.shareTicket = res.shareTicket;\n            }\n\n            Global.helpInfo = null;\n            if (res.query) {\n                WXGlobal.helpInfo = res.query;\n                Global.helpInfo = WXGlobal.helpInfo;\n                console.log('registOnShow----', Global.helpInfo);\n            }\n\n            //let dataStatistics = require(\"dataStatistics\");\n            dataStatistics.onShowInfo(res, res1 => {\n                console.log('dataStatistics onShowInfo success: ', res1)\n                let msg = res1.data; // 'success';\n                if (msg == 'success') {\n                    //注意，部分接口需要等待onShowInfo回调成功，如下:\n                    //setKVUserData,getKVUserData,onShareAppMsg,onHideInfo,shareAppMsg,shareSuccess //以下不需要等待:getShareInfo,getGameConfigByAppkey\n\n                    //this.gameSdkLogin(info);\n                }\n            }, err => {\n                console.log(err)\n            });\n\n        });\n    },\n\n    registOnHide: function () {\n        wx.onHide((res) => {\n            console.log('wx onHide<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<', res);\n            dataStatistics.onHideInfo();\n        });\n    },\n\n    //分享  001点击转发   002点击群排行    003分享界面点击分享  004 复活界面\n    shareGame: function (imageTag, callback, failcallback, sourcecode) {\n        var myUtil = require(\"myUtil\");\n        var imageurl;\n        if (imageTag == \"screenshot\") {\n            imageurl = WXGlobal.getShareScreenShot();\n            this.setQueryInfo(sourcecode, 'screenshot');\n        } else if (imageTag == \"screenshotForDown\") {\n            imageurl = WXGlobal.getShareScreenShotForDown();\n            this.setQueryInfo(sourcecode, 'screenshot');\n        } else if ((imageTag == \"01\" || imageTag == \"02\" || imageTag == \"03\") && Global.propShareImages) {\n            console.log('imageTag:', Global.propShareImages, imageTag);\n            imageurl = Global.propShareImages[imageTag];\n            this.setQueryInfo(sourcecode, imageurl);\n        } else {\n            if (Global.cdnShareImages && Global.cdnShareImages.length > 0) {\n                imageurl = myUtil.randomForArray(Global.cdnShareImages);\n                console.log('从cdn请求分享图：', imageurl);\n            } else {\n                var img = myUtil.randomForArray(Global.shareImages);\n                imageurl = 'res/raw-assets/resources/textures/gridItem/' + img;\n                console.log('从本地请求分享图：', imageurl);\n            }\n            this.setQueryInfo(sourcecode, imageurl);\n        }\n\n        //分享文字\n        var text;\n        if (imageTag == \"01\" || imageTag == \"02\" || imageTag == \"03\") {\n            text = Global.propShareTexts[imageTag];\n            console.log('道具分享文字', text);\n        } else if (Global.cdnTexts && Global.cdnTexts.length > 0) {\n            text = myUtil.randomForArray(Global.cdnTexts);\n            console.log('从cdn请求分享文字：', text);\n        } else {\n            text = myUtil.randomForArray(Global.shareTexts);\n            console.log('从本地读取分享文字：', text);\n        }\n        console.log('用户点击分享,query:', WXGlobal.queryString);\n\n        /*\n                tywx.PropagateInterface.getShareConfigInfo();\n                console.log('all ConfigInfo:' + tywx.PropagateInterface.ShareConfig);\n                var config = tywx.PropagateInterface.getShareConfigInfo({\n                    share_type: sourcecode + \"\"\n                });\n                console.log('config1:' + config);\n                if (!config) {\n                    config = tywx.ShareInterface.getRandomOnShareAppMessageInfo();\n                }\n                tywx.ShareInterface.setOnShareAppMessageInfo(config.title, config.imageUrl, config.sharePointId, config.shareSchemeId);\n                console.log('config:', config);\n\n                tywx.ShareInterface.share(\n                    config.title,\n                    config.imageUrl,\n                    config.sharePointId,\n                    config.shareSchemeId,\n                    (res) => {\n                        console.log('wx分享成功', res);\n                        if (res.shareTickets) {\n                            WXGlobal.shareTicketEnabled = true;\n                            WXGlobal.shareTicket = res.shareTickets[0];\n\n                            wx.getShareInfo({\n                                shareTicket: res.shareTickets[0],\n                                success: function (result) {\n                                    console.log('获取分享信息成功', result);\n                                    if (result) {\n                                        //判断秘钥是否有用\n                                        var iv = result.iv;\n                                        var encryptedData = result.encryptedData;\n                                        console.log('解析分享信息', tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n                                        var resultString = WXGlobal.decrypt(tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n                                        console.log(resultString);\n                                        if (resultString) {\n                                            resultString = JSON.parse(resultString);\n                                            let openid = '';\n                                            // 分享\n                                            if (resultString.openGId) {\n                                                openid = resultString.openGId;\n                                            }\n                                            console.log('分享群ID:', openid);\n                                            if (callback != null) {\n                                                callback(openid, WXGlobal.shareTicket);\n                                            }\n                                        } else {\n                                            if (failcallback) {\n                                                failcallback();\n                                            }\n                                        }\n                                    }\n                                },\n                                fail: () => {\n                                    console.log('获取分享信息失败');\n                                    if (failcallback) {\n                                        failcallback();\n                                    }\n                                },\n                                complete: () => {\n\n                                },\n                            })\n                        } else {\n                            console.log('wx分享到群失败', failcallback);\n                            if (failcallback) {\n                                failcallback();\n                            }\n                        }\n                    },\n                    () => {\n                        console.log('wx分享失败', failcallback);\n                        if (failcallback) {\n                            failcallback();\n                        }\n                    }\n                );*/\n\n        WXGlobal.shareAppMessage({\n            title: text,\n            imageUrl: imageurl,\n            query: WXGlobal.queryString,\n            success: (res) => {\n                console.log('wx分享成功', res);\n                if (res.shareTickets) {\n                    WXGlobal.shareTicketEnabled = true;\n                    WXGlobal.shareTicket = res.shareTickets[0];\n\n                    wx.getShareInfo({\n                        shareTicket: res.shareTickets[0],\n                        success: function (result) {\n                            console.log('获取分享信息成功', result);\n                            if (result) {\n                                //判断秘钥是否有用\n                                var iv = result.iv;\n                                var encryptedData = result.encryptedData;\n                                console.log('解析分享信息', tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n                                try {\n                                    var resultString = WXGlobal.decrypt(tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n                                    console.log(resultString);\n                                    if (resultString) {\n                                        resultString = JSON.parse(resultString);\n                                        let openid = '';\n                                        // 分享\n                                        if (resultString.openGId) {\n                                            openid = resultString.openGId;\n                                        }\n                                        console.log('分享群ID:', openid);\n                                        if (callback != null) {\n                                            callback(openid, WXGlobal.shareTicket);\n                                        }\n                                    } else {\n                                        if (failcallback) {\n                                            failcallback();\n                                        }\n                                    }\n                                } catch (error) {\n                                    if (callback != null) {\n                                        callback(res.shareTickets[0], WXGlobal.shareTicket);\n                                    }\n                                }\n                            }\n                        },\n                        fail: () => {\n                            console.log('获取分享信息失败');\n                            if (failcallback) {\n                                failcallback();\n                            }\n                        },\n                        complete: () => {\n\n                        },\n                    })\n                } else {\n                    console.log('wx分享到群失败', failcallback);\n                    if (failcallback) {\n                        failcallback(\"fail\");\n                    }\n                }\n            },\n            fail: () => {\n                console.log('wx分享失败', failcallback);\n                if (failcallback) {\n                    failcallback(\"cancel\");\n                }\n            }\n        });\n\n\n\n        // WXGlobal.shareAppMessage({\n        //     title: text,\n        //     imageUrl: imageurl,\n        //     query: WXGlobal.queryString,\n        //     /*success: (res) => {\n        //         console.log('wx分享成功', res);\n        //         if (res.shareTickets) {\n        //             WXGlobal.shareTicketEnabled = true;\n        //             WXGlobal.shareTicket = res.shareTickets[0];\n        //         }\n        //         if (callback) {\n        //             callback(res.shareTickets);\n        //         }\n        //     },*/\n\n        //     success: function (result) {\n        //         wx.getShareInfo({\n        //             shareTicket: result.shareTickets[0],\n        //             success: function (result) {\n        //                 console.log('获取分享信息成功', result);\n        //                 if (result) {\n        //                     //判断秘钥是否有用\n        //                     var iv = result.iv;\n        //                     var encryptedData = result.encryptedData;\n        //                     console.log('解析分享信息', tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n        //                     var resultString = WXGlobal.decrypt(tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n        //                     console.log(resultString);\n        //                     if (resultString) {\n        //                         resultString = JSON.parse(resultString);\n        //                         let openid = '';\n        //                         // 分享\n        //                         if (resultString.openGId) {\n        //                             openid = resultString.openGId;\n        //                         }\n        //                         console.log('分享群ID:', openid);\n        //                         if (callback != null) {\n        //                             callback(openid, result.);\n        //                         }\n        //                     } else {\n        //                         if (failcallback) {\n        //                             failcallback();\n        //                         }\n        //                     }\n        //                 }\n        //             },\n        //             fail: () => {\n        //                 console.log('获取分享信息失败');\n        //                 if (failcallback) {\n        //                     failcallback();\n        //                 }\n        //             },\n        //             complete: () => {\n\n        //             },\n        //         });\n\n        //     },\n        //     fail: () => {\n        //         console.log('wx分享失败', failcallback);\n        //         if (failcallback) {\n        //             failcallback();\n        //         }\n        //     },\n        // })\n    },\n\n    decrypt: function (key, iv, crypted) {\n        var crypto = require('crypto');\n\n        crypted = new Buffer(crypted, 'base64');\n        iv = new Buffer(iv, 'base64');\n        key = new Buffer(key, 'base64');\n        var decipher = crypto.createDecipheriv('aes-128-cbc', key, iv);\n        var decoded = decipher.update(crypted, 'binary', 'utf8');\n        decoded += decipher.final('utf8');\n        return decoded;\n    },\n\n    login: function (callback) {\n        wx.login(callback);\n    },\n\n    setMaxScore: function (maxscore, gold) {\n\n        WXGlobal.queryString =\n            'nickName=' + WXGlobal.userInfo.nickName + '&' +\n            'maxscore=' + maxscore + '&' +\n            'gold=' + gold + '&' +\n            'gender=' + WXGlobal.userInfo.gender + '&' +\n            'avatarUrl=' + WXGlobal.userInfo.avatarUrl;\n\n        console.log('wx setMaxScore, query:', WXGlobal.queryString);\n    },\n\n    // 返回小程序启动参数\n    getLaunchOptionsSync: function () {\n        return wx.getLaunchOptionsSync()\n    },\n\n    setShareTicketEnabled: function (isEnabled) {\n        wx.updateShareMenu({\n            withShareTicket: isEnabled,\n            success: () => {\n                WXGlobal.shareTicketEnabled = isEnabled;\n            }\n        })\n    },\n\n    getShareInfo: function (obj) {\n        return wx.getShareInfo(obj)\n    },\n\n    getShareUserInfo: function () {\n        return this.query\n    },\n\n    showShareMenu: function () {\n        console.log('显示右上菜单的转发按钮');\n        wx.showShareMenu();\n    },\n    hideShareMenu: function () {\n        console.log('隐藏右上菜单的转发按钮');\n        wx.hideShareMenu();\n    },\n    onShareAppMessage: function (callback) {\n        console.log('注册点击转发按钮事件');\n        wx.onShareAppMessage(callback);\n    },\n    shareAppMessage: function (params) {\n        console.log('转发:', params);\n        wx.shareAppMessage(params);\n    },\n\n    getShareScreenShot: function () {\n        return canvas.toTempFilePathSync({\n            x: 0,\n            y: 0.5 * canvas.height - 0.8 * 0.8 * canvas.width,\n            width: canvas.width,\n            height: 0.8 * canvas.width,\n            destWidth: 500,\n            destHeight: 400,\n        })\n    },\n\n    getShareScreenShotForDown: function () {\n        return canvas.toTempFilePathSync({\n            x: 0,\n            y: 0.5 * canvas.height + 0 * canvas.width,\n            width: canvas.width,\n            height: 0.8 * canvas.width,\n            destWidth: 500,\n            destHeight: 400,\n        })\n    },\n\n    getScreenShot: function () {\n        return canvas.toTempFilePathSync({})\n    },\n\n\n    initFriendRank: function () {\n        try {\n            let openDataContext = wx.getOpenDataContext()\n            let msg = {\n                type: 'initFriendRank',\n            }\n            if (WXGlobal.shareTicketEnabled) {\n                msg.shareTicket = WXGlobal.shareTicket;\n            }\n            console.log(msg);\n\n            openDataContext.postMessage(msg);\n        } catch (error) {\n\n        }\n    },\n\n    getNextFriendRank: function (params) {\n        try {\n            let openDataContext = wx.getOpenDataContext()\n            let msg = {\n                type: 'getNextFriend',\n                score: params.score,\n                width: params.rect.width,\n                height: params.rect.height,\n            }\n            if (WXGlobal.shareTicketEnabled) {\n                msg.shareTicket = WXGlobal.shareTicket;\n            }\n            //console.log(msg);\n\n            openDataContext.postMessage(msg);\n            if (params.callback) {\n                params.callback('wx');\n            }\n        } catch (error) {\n\n        }\n    },\n\n    getFriendRank: function (params) {\n        try {\n            let openDataContext = wx.getOpenDataContext()\n            let msg = {\n                type: 'getFriendRank',\n                width: params.rect.width,\n                height: params.rect.height,\n            }\n            if (WXGlobal.shareTicketEnabled) {\n                msg.shareTicket = WXGlobal.shareTicket;\n            }\n            console.log(msg);\n\n            openDataContext.postMessage(msg);\n            if (params.callback) {\n                params.callback('wx');\n            }\n        } catch (error) {\n\n        }\n    },\n\n    getGroupRank: function (params) {\n\n        var myUtil = require(\"myUtil\");\n        //if (!WXGlobal.shareTicketEnabled || typeof this.shareTicket === 'undefined') {\n        var image = myUtil.randomForArray(Global.shareImages);\n        this.shareGame('res/raw-assets/resources/textures/gridItem/' + image, (openGId, shareTicket) => {\n                console.log('on get group rank pre share', shareTicket);\n                //分享给个人\n                if (!shareTicket) {\n                    if (params.callback) {\n                        params.callback('failed');\n                    }\n                } else {\n                    //分享给群\n                    try {\n                        let openDataContext = wx.getOpenDataContext()\n                        let msg = {\n                            type: 'getGroupRank',\n                            width: params.rect.width,\n                            height: params.rect.height,\n                            shareTicket: shareTicket\n                        }\n                        console.log(msg);\n                        openDataContext.postMessage(msg);\n                        if (params.callback) {\n                            params.callback(shareTicket);\n                            this.shareTicket = undefined;\n                        }\n                    } catch (error) {\n\n                    }\n                }\n            },\n            () => {\n                //分享失败\n                if (params.callback) {\n                    params.callback('failed');\n                }\n            }, '002');\n        return;\n        //} \n        /*else {\n            let openDataContext = wx.getOpenDataContext()\n            let msg = {\n                type: 'getGroupRank',\n                width: params.rect.width,\n                height: params.rect.height,\n                shareTicket: this.shareTicket\n            }\n            console.log(msg);\n            openDataContext.postMessage(msg);\n            if (params.callback) {\n                params.callback('success');\n            }\n        }*/\n    },\n\n    //每日挑战排行榜\n    getDailyRank: function (params) {\n        try {\n            let openDataContext = wx.getOpenDataContext()\n            let msg = {\n                type: 'getDailyRank',\n                width: params.rect.width,\n                height: params.rect.height,\n            }\n            if (WXGlobal.shareTicketEnabled) {\n                msg.shareTicket = WXGlobal.shareTicket;\n            }\n            console.log(msg);\n\n            openDataContext.postMessage(msg);\n            if (params.callback) {\n                params.callback('wx');\n            }\n        } catch (error) {}\n    },\n\n\n    //好友互助奖励信息\n    getMyInfo: function (params) {\n        try {\n            let openDataContext = wx.getOpenDataContext()\n            let msg = {\n                type: 'getMyInfo',\n                width: params.rect.width,\n                height: params.rect.height,\n            }\n            if (WXGlobal.shareTicketEnabled) {\n                msg.shareTicket = WXGlobal.shareTicket;\n            }\n            console.log('getMyInfo:', msg);\n\n            openDataContext.postMessage(msg);\n            if (params.callback) {\n                params.callback('wx');\n            }\n        } catch (error) {}\n    },\n\n    setQueryInfo: function (sourcecode, imageUrl) {\n        WXGlobal.queryString =\n            'nickName=' + WXGlobal.userInfo.nickName + '&' +\n            'inviteCode=' + tywx.UserInfo.userId + '&' +\n            'sourceCode=' + tywx.SystemInfo.gameId * 10000 + sourcecode + '&' +\n            'imageType=' + imageUrl;\n        console.log(WXGlobal.queryString);\n    },\n\n    /*\n    params:\n    {\n        KVDataList: [\n            { key: 'maxscore', value: score + '' },\n            { key: 'name', value: res.userInfo.nickName },\n        ],\n        success: function () {},\n        failed: function () {},\n        comlete: function () {},\n    }\n    kvdata的key和value必须为string\n    */\n    setUserCloudStorage: function (params) {\n        console.log('setUserCloudStorage:', params);\n        try {\n            wx.setUserCloudStorage(params);\n        } catch (error) {\n\n        }\n    },\n\n    /*\n    params:\n    {\n        maxscore: int,\n        crystal: int,\n        callback: function () {},\n    }\n    */\n    saveScore: function (maxscore, gold, callback) {\n        if (typeof wx === 'undefined') return;\n        //兼容dailyScore\n        if (!Global.gameinfo) {\n            var myUtil = require('myUtil');\n            myUtil.resetInitData();\n        }\n        if (Global.gameinfo && !Global.gameinfo.dailyScore) {\n            Global.gameinfo.dailyScore = 0;\n        }\n\n        let obj = {\n            KVDataList: [{\n                    key: 'maxscore',\n                    value: maxscore + ''\n                },\n                {\n                    key: 'gold',\n                    value: gold + ''\n                },\n                {\n                    key: 'dailyTime',\n                    value: Global.gameinfo.dailyTime + ''\n                },\n                {\n                    key: 'dailyScore',\n                    value: Global.gameinfo.dailyScore + ''\n                },\n            ],\n            success: callback\n        }\n        console.log('wx saveScore:', obj);\n        this.setUserCloudStorage(obj);\n        this.setMaxScore(maxscore, gold);\n    },\n    loadScore: function (params) {\n        // 微信无法在主域获取用户托管数据\n        // if (typeof wx !== 'undefined') {\n        //     console.log('wx loadScore:', params);\n        //     this.getUserCloudStorage(params);\n        // }\n    },\n    /*\n参数格式:\n{\n    success: function () {},\n    failed: function () {},\n    comlete: function () {},\n}\n*/\n    shakeShort: function (params) {\n        wx.vibrateShort(params);\n    },\n\n    /*\n    参数格式:\n    {\n        success: function () {},\n        failed: function () {},\n        comlete: function () {},\n    }\n    */\n    shakeLong: function (params) {\n        wx.vibrateLong(params);\n    },\n    exit: function () {\n        wx.exitMiniProgram({\n            success: (res) => {\n                console.log('exit game:', res)\n            }\n        })\n    },\n\n    getSystemInfo: function () {\n        return wx.getSystemInfoSync()\n    },\n\n}\n\nmodule.exports = WXGlobal;"]}