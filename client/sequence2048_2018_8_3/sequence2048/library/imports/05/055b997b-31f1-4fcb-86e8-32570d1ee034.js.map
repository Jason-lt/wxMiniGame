{"version":3,"sources":["../../../../../assets/Scripts/common/assets/Scripts/common/receiveCmd.js"],"names":["tcpManager","receiveCmd","boot","cmdMap","cmdType","MSG_USER_INFO","onReceiveUserInfo","MSG_GAME","onGame","MSG_DATA_CHANGED","onUpdateChangedData","HALL_SHARE2","onShare2","MSG_BAG_INFO","onReceiveBagInfo","tywx","NotificationCenter","listen","EventType","GET_USER_FEATURE_SUCCESS","_userFeature","process","params","msgCmd","cmd","result","func","call","wxGame","trigger","LOGD","_TAG","val","retmsg","Global","featureInfo","isInBSGS","GlobalFuncs","checkBSGS","last_login_city","ip","last_login_ip","isBringVersion","shareManager","load","sendCmd","getUserInfoForShot","funList","geBringConfig","getShareConfig","geResurgenceConfig","getGameConfig","getBagInfo","beginGame","runOneFun","length","shift","requestAnimationFrame","gameId","isOnShare","UPDATE_SHARE_STATE","sharePoint","action","gameInfo","history_score","playinfo","max_score","UPDATE_USER_INFO","saveGameInfo","USE_PROP","parseCommonConfig","value","configKey","config","version","resurgenceConfig","bsgsCity","otherCity","GameConfig","shareConfig","argument","i","curValue","msg","GET_REWARD","rewards","count","itemId","getCardProp","bagList","changeProp","bagInfo","bagID","UPDATE_CHANGE_PROP","formatData","data","tcpData","firstLogin","date","isClick","isAmGet","isPmGet","clickUserDict","remainCount","throwError","ok","parseInt","console","log","clickLinkLogin","sendLoginData","shut","ignoreScope"],"mappings":"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","file":"receiveCmd.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["tcpManager.receiveCmd = {\n    boot: function(){\n        \n        this.cmdMap = {};\n        this.cmdMap[tcpManager.cmdType.MSG_USER_INFO] = this.onReceiveUserInfo;\n        this.cmdMap[tcpManager.cmdType.MSG_GAME] = this.onGame;\n        this.cmdMap[tcpManager.cmdType.MSG_DATA_CHANGED] = this.onUpdateChangedData;\n        this.cmdMap[tcpManager.cmdType.HALL_SHARE2] = this.onShare2;\n        this.cmdMap[tcpManager.cmdType.MSG_BAG_INFO] = this.onReceiveBagInfo;\n\n        tywx.NotificationCenter.listen(tywx.EventType.GET_USER_FEATURE_SUCCESS, this._userFeature, this);\n    },\n    \n    \n    //收到服务器下发的协议处理\n    process: function (params) {\n        var msgCmd = params.cmd;\n        var result = params.result;\n        if (result){\n            var func = this.cmdMap[msgCmd];\n            if (func){\n                func.call(this, params);\n            }\n            else{\n                wxGame.NotificationCenter.trigger(msgCmd, params);\n                wxGame.LOGD(this._TAG, \"未注册关于消息 ： \" + msgCmd + \" 的监听！\");\n            }\n        }\n    },\n\n    _userFeature:function (val) {\n        // var ={\n        //     \"_id\":\"1490806\",\n        //         \"bind_wx\":\"wx:om67ov41A6awFwQ0rQB0RtWFA8NA\",\n        //         \"last_login_time\":\"2018-05-25 16:44:22\",\n        //         \"last_login_ip\":\"183.212.187.255\",\n        //         \"last_login_province\":\"江苏\",\n        //         \"last_login_city\":\"南京\",\n        //         \"last_login_clientid\":\"H5_5.1_weixin.weixin.0-hall6.weixin.rich\",\n        //         \"login_counts\": {\n        //             \"2018-05-25\":1\n        //         },\n        //     \"create_platform_id\":\"3\",\n        //         \"create_clientid\":\"H5_5.1_weixin.weixin.0-hall6.weixin.rich\",\n        //         \"create_subplatform_id\":\"5\",\n        //         \"create_city\":\"南京\",\n        //         \"create_channel_id\":\"104\",\n        //         \"create_ip\":\"183.212.187.255\",\n        //         \"create_time\":\"2018-05-25 16:44:22\",\n        //         \"create_province\":\"江苏\",\n        //         \"create_product_id\":\"6\",\n        //         \"login_detail\": {\n        //         \"2018-05-25\": [\n        //             \"16:44:22\"\n        //         ]\n        //     }\n        // };\n        //TODO:TEST\n        // if(debugMode){\n        //     window.Global.isInBSGS = !debugMode;\n        // }\n        if (!val.retmsg) {\n            return\n        }\n        wxGame.Global.featureInfo = val.retmsg;\n        wxGame.Global.isInBSGS = wxGame.GlobalFuncs.checkBSGS(wxGame.Global.featureInfo.last_login_city); //是否在北上广深\n        wxGame.Global.ip = wxGame.Global.featureInfo.last_login_ip; //上一次登录的IP\n        if (wxGame.Global.isBringVersion) {\n            wxGame.Global.isInBSGS = true;\n        }\n    },\n\n    onReceiveUserInfo:function(params){\n        wxGame.shareManager.load();\n        tcpManager.sendCmd.getUserInfoForShot();\n\n        /*****  通用配置  *****/\n\n        var funList = [\n            tcpManager.sendCmd.geBringConfig,\n            tcpManager.sendCmd.getShareConfig,\n            tcpManager.sendCmd.geResurgenceConfig,\n            tcpManager.sendCmd.getGameConfig,\n            tcpManager.sendCmd.getBagInfo,\n            tcpManager.sendCmd.beginGame,\n        ];\n\n        var runOneFun = function () {\n            if (funList.length > 0){\n                var func = funList.shift();\n                func();\n                requestAnimationFrame(runOneFun);\n            }\n        };\n\n        runOneFun();\n        \n        if (params.result && params.result.gameId == 9999) {\n            if(wxGame.Global.isOnShare){\n                wxGame.NotificationCenter.trigger(wxGame.EventType.UPDATE_SHARE_STATE);\n            }\n            wxGame.Global.isOnShare = false;\n            wxGame.Global.sharePoint = 0;\n        }\n    },\n\n    onGame:function(params){\n        switch (params.result.action){\n            case \"get_user_info\" : {\n                wxGame.Global.gameInfo.history_score = params.result.playinfo.history_score;\n                wxGame.Global.gameInfo.max_score = params.result.playinfo.max_score;\n\n                wxGame.NotificationCenter.trigger(wxGame.EventType.UPDATE_USER_INFO);\n                break;\n            }\n            case \"save_score\" : {\n                wxGame.Global.gameInfo.history_score = params.result.playinfo.history_score;\n                wxGame.Global.gameInfo.max_score = params.result.playinfo.max_score;\n                break;\n            }\n            case \"game_begin\" : {\n                wxGame.saveGameInfo = params.result.gameInfo;\n                break;\n            }\n            case \"save_game\" : {\n                wxGame.saveGameInfo = params.result.gameInfo;\n                break;\n            }\n            case \"consume_assets\" : {\n                // {\"cmd\":\"game\",\"result\":{\"action\":\"consume_assets\",\"gameId\":98,\"userId\":10184,\"success\":0}}\n                if(params.result){\n                    wxGame.NotificationCenter.trigger(wxGame.EventType.USE_PROP,params.result);\n                }\n                break;\n            }\n            case \"common_config\" : {\n                // {\"cmd\":\"game\",\"result\":{\"action\":\"consume_assets\",\"gameId\":98,\"userId\":10184,\"success\":0}}\n                this.parseCommonConfig(params.result);\n                break;\n            }\n        }\n    },\n\n    parseCommonConfig:function(value){\n        switch (value.configKey){\n            case \"bringConfig\": {\n                // this.saveNormalConfigJson(value.config);\n                if (value && value.config.version == wxGame.Global.version) {\n                    wxGame.Global.isBringVersion = true;\n                    wxGame.Global.isInBSGS = true;\n                }else {\n                    wxGame.Global.isBringVersion = false;\n                }\n                break;\n            }\n            case \"resurgenceConfig\": {\n                if (wxGame.Global.isInBSGS){\n                    wxGame.resurgenceConfig = value.config.bsgsCity;\n                }else {\n                    wxGame.resurgenceConfig = value.config.otherCity;\n                }\n\n                break;\n            }\n            case \"gameConfig\": {\n                wxGame.GameConfig = value.config;\n                break;\n            }\n            case \"shareConfig\": {\n                if (wxGame.Global.isInBSGS){\n                    wxGame.shareConfig = value.config.bsgsCity;\n                }else {\n                    wxGame.shareConfig = value.config.otherCity;\n                }\n                break;\n            }\n        }\n    },\n\n    onUpdateChangedData:function(argument){\n        //解析数据\n        if (typeof(argument) != 'undefined') {\n            //hall.ME.parseUserInfo(argument[0]);\n            var result = argument[\"result\"];\n            if (typeof(result) != 'undefined' && typeof(result['changes']) != 'undefined') {\n                for (var i = 0; i < result['changes'].length; i++) {\n                    var curValue = result[\"changes\"][i];\n                    if (typeof(curValue) == 'undefined') {\n                        continue;\n                    }\n                    if (curValue == 'item') {\n                        wxGame.LOGD(\"update_notify,更新道具\");\n                        tcpManager.sendCmd.getBagInfo();\n                    }\n                }\n            }\n        }\n    },\n\n    onShare2:function(msg){\n        if (msg.result.action == tcpManager.cmdType.GET_REWARD){\n            // {\"cmd\":\"hall_share2\",\"result\":{\"action\":\"get_reward\",\"gameId\":6,\"userId\":10008,\"rewards\":[]}}\n            //获得奖励回调\n            if(msg.result.rewards.length > 0) {\n                if (msg.result.rewards[0].count) {\n                    if (msg.result.rewards[0].itemId == \"item:1415\") {\n                        wxGame.GlobalFuncs.getCardProp(2);\n                    }\n                }\n            }\n        }\n    },\n\n    onReceiveBagInfo:function(value){\n        if (value) {\n            var result = value['result'];\n            var bagList = result[\"normal_list\"];\n\n            if (!bagList || typeof(bagList) == \"undefined\"){\n                return;\n            }\n            wxGame.Global.gameInfo.changeProp = 0;\n            for (var  i = 0 ; i < bagList.length ; i ++){\n                var bagInfo = bagList[i];\n                var bagID = bagInfo[\"id\"];\n                // 互换牌道具\n                if (bagID == 1415){\n                    wxGame.Global.gameInfo.changeProp = bagInfo[\"num\"];\n                }\n            }\n            wxGame.NotificationCenter.trigger(wxGame.EventType.UPDATE_CHANGE_PROP);\n            // ty.NotificationCenter.trigger(ddz.EventType.UPDATE_BAG_INFO);\n        }\n    },\n\n\n    formatData: function (data) {\n        Global.tcpData.firstLogin = data.firstLogin;\n        Global.tcpData.date = data.date;\n        Global.tcpData.isClick = data.isClick;\n        Global.tcpData.isAmGet = data.isAmGet;\n        Global.tcpData.isPmGet = data.isPmGet;\n        Global.tcpData.clickUserDict = data.clickUserDict;\n        Global.tcpData.remainCount = data.remainCount;\n    },\n\n    throwError: function (result) {\n        //处理异常报错\n        if (result.ok && parseInt(result.ok) <= 0) {\n            console.log('处理异常报错');\n            if (result.action == tcpManager.cmdType.clickLinkLogin) {\n                console.log('点击自己发送的小卡片需要请求normalLogin协议');\n                tcpManager.sendCmd.sendLoginData();\n                return;\n            }\n            // Global.game.showDialogPropText('账号数据异常');\n            return;\n        }\n    },\n\n    shut : function(){\n        this.cmdMap = {};\n        tywx.NotificationCenter.ignoreScope(this);\n    },\n};\ntcpManager.receiveCmd.boot();"]}