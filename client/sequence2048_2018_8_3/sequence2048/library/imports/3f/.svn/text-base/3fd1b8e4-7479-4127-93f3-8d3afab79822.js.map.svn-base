{"version":3,"sources":["../../../../../assets/Scripts/CommonFrame/assets/Scripts/CommonFrame/NotificationCenter.js"],"names":["console","log","tywx","NotificationCenter","events","listen","eName","handler","scope","push","ignore","fns","filter","fn","ignoreScope","msg","obs","LOGD","trigger","eventName","params","length","i","call"],"mappings":";;;;;;AAAA;AACAA,QAAQC,GAAR,CAAY,2BAAZ;AACAC,KAAKC,kBAAL,GAA0B;AACtBC,YAAS,EADa;AAEtBC,YAAS,gBAASC,KAAT,EAAgBC,OAAhB,EAAyBC,KAAzB,EAA+B;AACpC,aAAKJ,MAAL,CAAYE,KAAZ,IAAqB,KAAKF,MAAL,CAAYE,KAAZ,KAAsB,EAA3C;AACA,aAAKF,MAAL,CAAYE,KAAZ,EAAmBG,IAAnB,CAAwB;AACpBD,mBAAOA,SAAS,IADI;AAEpBD,qBAASA;AAFW,SAAxB;AAIH,KARqB;;AAUtBG,YAAS,gBAASJ,KAAT,EAAgBC,OAAhB,EAAyBC,KAAzB,EAA+B;AACpCA,gBAAQA,SAAS,IAAjB;AACA,YAAIG,MAAM,KAAKP,MAAL,CAAYE,KAAZ,CAAV;;AAEA,YAAG,CAACK,GAAJ,EACI;;AAEJ,aAAKP,MAAL,CAAYE,KAAZ,IAAqBK,IAAIC,MAAJ,CAAW,UAASC,EAAT,EAAY;AACxC,mBAAOA,GAAGL,KAAH,IAAUA,KAAV,IAAmBK,GAAGN,OAAH,IAAYA,OAAtC;AACH,SAFoB,CAArB;AAGH,KApBqB;;AAsBtBO,iBAAc,qBAAUN,KAAV,EAAiB;AAC3B,aAAI,IAAIO,GAAR,IAAe,KAAKX,MAApB,EAA2B;AACvB,gBAAIY,MAAM,KAAKZ,MAAL,CAAYW,GAAZ,CAAV;AACA,gBAAGC,GAAH,EAAO;AACH,qBAAKZ,MAAL,CAAYW,GAAZ,IAAmBC,IAAIJ,MAAJ,CAAW,UAASC,EAAT,EAAY;AACtC,wBAAGA,GAAGL,KAAH,IAAYA,KAAf,EAAqB;AACjB,+BAAO,IAAP;AACH,qBAFD,MAEM;AACFN,6BAAKe,IAAL,CAAU,yBAAV,EAAqC,uDAAuDF,GAA5F;AACA,+BAAO,KAAP;AACH;AACJ,iBAPkB,CAAnB;AAQH;AACJ;AACJ,KApCqB;;AAsCtBG,aAAU,iBAASC,SAAT,EAAoBC,MAApB,EAA2B;AACjClB,aAAKe,IAAL,CAAU,cAAV,EAA0BE,SAA1B;AACA,YAAIR,MAAM,KAAKP,MAAL,CAAYe,SAAZ,CAAV;AACA,YAAG,CAACR,GAAJ,EAAQ;AACJT,iBAAKe,IAAL,CAAU,qBAAV,EAAiCE,SAAjC;AACF;AACD;AACDjB,aAAKe,IAAL,CAAU,yBAAV,EAAqCN,IAAIU,MAAzC;AACA,YAAIR,EAAJ;;AAEA,aAAI,IAAIS,IAAI,CAAZ,EAAeA,IAAIX,IAAIU,MAAvB,EAA+BC,GAA/B,EAAmC;;AAE/BT,iBAAKF,IAAIW,CAAJ,CAAL;AACA;AACA;AACAT,eAAGN,OAAH,CAAWgB,IAAX,CAAgBV,GAAGL,KAAnB,EAA0BY,MAA1B;AACH;AACJ;AAvDqB,CAA1B","file":"NotificationCenter.js","sourceRoot":"../../../../../assets/Scripts/CommonFrame","sourcesContent":["//全局的事件监听模块，可用于对象之间的消息传递，所以没有提供构造函数\nconsole.log(\"NotificationCenter loaded\");\ntywx.NotificationCenter = {\n    events : {},\n    listen : function(eName, handler, scope){\n        this.events[eName] = this.events[eName] || [];\n        this.events[eName].push({\n            scope: scope || this,\n            handler: handler\n        });\n    },\n\n    ignore : function(eName, handler, scope){\n        scope = scope || this;\n        var fns = this.events[eName];\n\n        if(!fns) \n            return;\n\n        this.events[eName] = fns.filter(function(fn){\n            return fn.scope!=scope || fn.handler!=handler\n        });\n    },\n\n    ignoreScope : function (scope) {\n        for(var msg in this.events){\n            var obs = this.events[msg];\n            if(obs){\n                this.events[msg] = obs.filter(function(fn){\n                    if(fn.scope != scope){\n                        return true;\n                    } else{\n                        tywx.LOGD('tywx.NotificationCenter', 'ty.NotificationCenter : remove listener by Scope: ' + msg);\n                        return false;\n                    }\n                })\n            }\n        }\n    },\n\n    trigger : function(eventName, params){\n        tywx.LOGD(\"EventTrigger\", eventName);\n        var fns = this.events[eventName];\n        if(!fns){\n            tywx.LOGD(\"EventTrigger return\", eventName);\n          return;\n        }\n        tywx.LOGD(\"EventTrigger fns.length\", fns.length);\n        var fn;\n    \n        for(var i = 0; i < fns.length; i++){\n            \n            fn = fns[i];\n            // fn.handler.apply(fns.scope, params||[]);\n            // 用call直接把各个参数回调出去\n            fn.handler.call(fn.scope, params)\n        }\n    }\n};"]}