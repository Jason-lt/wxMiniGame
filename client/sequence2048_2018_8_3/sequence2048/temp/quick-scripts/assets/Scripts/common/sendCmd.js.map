{"version":3,"sources":["sendCmd.js"],"names":["tcpManager","sendCmd","lisiner","console","log","tywx","UserInfo","wxgame_session_key","initLogin","NotificationCenter","listen","gameEvent","BIND_USER_SUCCESS","sendMsg","params","websocket","sendData","Global","helpInfo","parseInt","inviteCode","sendClickLinkLogin","sendLoginData","cmd","cmdType","wx","normalLogin","userId","SystemInfo","gameId","intClientId","loginDateStr","Date","toDateString","geBringConfig","geResurgenceConfig","getGameConfig","getShareConfig","sendSaveScore","wxGame","gameInfo","score","getUserInfoForShot","shareToGetreward","sharePoint","pars","getBagInfo","beginGame","saveRecord","consumeAssets","count","item"],"mappings":"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","file":"sendCmd.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["//var ThirdAPI = require('./common/ThirdAPI')\n//发送协议\ntcpManager.sendCmd = {\n    lisiner: function () {\n        console.log('监听成功');\n        if (tywx.UserInfo.wxgame_session_key != '') {\n            tcpManager.sendCmd.initLogin();\n        }\n        tywx.NotificationCenter.listen(tcpManager.gameEvent.BIND_USER_SUCCESS, tcpManager.sendCmd.initLogin, null);\n    },\n\n    //发送协议\n    sendMsg: function (params) {\n        tcpManager.websocket.sendData(params);\n    },\n\n    //初始化登录\n    initLogin: function () {\n        console.log('Global.helpInfo:', Global.helpInfo);\n        if (Global.helpInfo && parseInt(Global.helpInfo.inviteCode) > 0) {\n            tcpManager.sendCmd.sendClickLinkLogin();\n        } else {\n            tcpManager.sendCmd.sendLoginData();\n        }\n    },\n\n    //不是点链接发送登录协议\n    sendLoginData: function () {\n        var cmd = {\n            'apiVersion': '5.0',\n            'namespace': \"wx\",\n            'cmd': tcpManager.cmdType.wx,\n            'params': {\n                'action': tcpManager.cmdType.normalLogin,\n                'userId': tywx.UserInfo.userId,\n                'gameId': 9997,\n                'sxGameId': tywx.SystemInfo.gameId,\n                'intClientId': tywx.SystemInfo.intClientId\n            }\n        };\n        tcpManager.sendCmd.sendMsg(cmd);\n         //记录登录时的时间\n         Global.loginDateStr = (new Date()).toDateString();\n    },\n\n    geBringConfig: function() {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action' : 'common_config',\n                'gameId' : tywx.SystemInfo.gameId,\n                'configKey' : 'bringConfig'\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    //\n    geResurgenceConfig: function() {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action' : 'common_config',\n                'gameId' : tywx.SystemInfo.gameId,\n                'configKey' : 'resurgenceConfig'\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    getGameConfig: function() {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action' : 'common_config',\n                'gameId' : tywx.SystemInfo.gameId,\n                'configKey' : 'gameConfig'\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    getShareConfig: function() {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action' : 'common_config',\n                'gameId' : tywx.SystemInfo.gameId,\n                'configKey' : 'shareConfig'\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    sendSaveScore:function(){\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action' : 'save_score',\n                'gameId' : tywx.SystemInfo.gameId,\n                \"score\": wxGame.Global.gameInfo.score,\n                \"itemId\": \"\",\n                \"propertyName\": \"\"\n            }\n        };\n\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    //获取用户信息\n    getUserInfoForShot: function() {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action' : 'get_user_info',\n                'gameId' : tywx.SystemInfo.gameId\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n    /**\n     *\n     * @param sharePoint 分享点\n     */\n    shareToGetreward:function (sharePoint) {\n        if(!sharePoint || sharePoint == 0){\n            return;\n        }\n        var pars = {\n            \"cmd\":'hall_share2',\n            \"params\": {\n                \"action\": 'get_reward',\n                \"gameId\": tywx.SystemInfo.gameId,\n                \"pointId\": sharePoint || 10700001\n            }\n        };\n        tcpManager.sendCmd.sendMsg(pars);\n    },\n\n    //获取背包信息\n    getBagInfo: function() {\n        var params = {\n            'cmd': 'bag',\n            'params': {\n                'action': 'update'\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    //开始游戏\n    beginGame: function() {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action': 'game_begin',\n                \"gameId\": tywx.SystemInfo.gameId,\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    //存档\n    saveRecord: function(gameInfo) {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action': 'save_game',\n                \"gameId\": tywx.SystemInfo.gameId,\n                \"gameInfo\": gameInfo,\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n\n    //使用道具\n    consumeAssets: function (count,item) {\n        var params = {\n            'cmd': 'game',\n            'params': {\n                'action': 'consume_assets',\n                \"itemId\": item,\n                \"count\": count,\n                'gameId': tywx.SystemInfo.gameId\n            }\n        };\n        tcpManager.sendCmd.sendMsg(params);\n    },\n};\n\ntcpManager.sendCmd.lisiner();"]}