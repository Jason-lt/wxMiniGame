{"version":3,"sources":["ThirdAPI.js"],"names":["WXGlobal","require","Platform","wx","FBInstant","initOnEnter","ThirdAPI","getRank","params","type","console","log","getFriendRank","getGroupRank","getDailyRank","getMyInfo","shakeShort","shakeLong","showGameClub","value","initFriendRank","getNextFriend","getNextFriendRank","saveGamePropgress","parma","data","list","score","cc","sys","localStorage","setItem","JSON","stringify","error","loadGameProgress","result","storage","getItem","parse","clearGameProgressInfo","removeItem","saveScore","maxscore","gold","loadScore","callback","loadLocalScore","parseInt","saveReviveData","shareTimes","date","Date","toDateString","Global","reviveTodayTimes","clearReviveData","data2","loadReviveData","saveShareData","shareDate","loadShareData","clearShareData","clearRankData","unixTime","getTime","beforeClearTime","clearTime","oldTime","oldDay","getDay","todaySeconds","getHours","getMinutes","getSeconds","weekdayUnixTime","sundayUnixTime","currUnixTime","canClear","clearInfo","key","saveInfo","i","length","loadInfo","push","index","clearCurrentSkin","saveCurrentSkin","current","loadCurrentSkin","ret","currentSkin","getHelpInfo","shareGame","imageurl","failcallback","sourcecode","channelPrefix","saveFriendGenStoneInfo","loadFriendGenStoneInfo","clearFriendGenStoneInfo","getShareUserInfo","exitGame","exit","getSystemInfo","module","exports"],"mappings":"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","file":"ThirdAPI.js","sourceRoot":"../../../../../assets/Scripts/common","sourcesContent":["// var FBGlobal = require('./fbAPI')\nvar WXGlobal = require('./wxAPI')\nvar Platform = (typeof wx !== 'undefined') ? 1 : ((typeof FBInstant !== 'undefined') ? 2 : 0)\n\nif (Platform === 1) {\n\n    WXGlobal.initOnEnter();\n\n} else {\n\n}\n\nvar ThirdAPI = {\n\n    getRank: function (params, type) {\n        console.log('ThirdAPI getRank', params, type);\n\n        if (Platform === 1) {\n            if (type === 'Friend') {\n                return WXGlobal.getFriendRank(params);\n            } else if (type === 'Group') {\n                /* var shareManager = require('shareManager');\n                 var extraParam = {\n                     sendTime: (new Date()).getTime()\n                 };\n                 shareManager.sharePoint(\"229\", null, null, extraParam);*/\n\n                return WXGlobal.getGroupRank(params);\n            } else if (type === 'Daily') {\n                return WXGlobal.getDailyRank(params);\n            } else if (type === \"MyInfo\") {\n                return WXGlobal.getMyInfo(params);\n            }\n\n        } else if (Platform === 2) {\n            // return FBGlobal.getRank(params);\n        }\n    },\n\n    shakeShort: function (params) {\n        if (Platform === 1) {\n            WXGlobal.shakeShort(params);\n        } else if (Platform === 2) {\n            console.log('FB 平台未实现震动');\n        }\n    },\n\n    shakeLong: function (params) {\n        if (Platform === 1) {\n            WXGlobal.shakeLong(params);\n        } else if (Platform === 2) {\n            console.log('FB 平台未实现震动');\n        }\n    },\n\n    showGameClub: function (value) {\n        if (Platform === 1) {\n            WXGlobal.showGameClub(value);\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    initFriendRank: function () {\n        console.log('ThirdAPI initFriendRank');\n\n        if (Platform === 1) {\n            return WXGlobal.initFriendRank();\n        } else if (Platform === 2) {}\n    },\n\n    getNextFriend: function (params) {\n        //console.log('ThirdAPI getNextFriend', params);\n\n        if (Platform === 1) {\n            return WXGlobal.getNextFriendRank(params);\n        } else if (Platform === 2) {\n            // return FBGlobal.getRank(params);\n        }\n    },\n\n    //保存游戏进度\n    saveGamePropgress: function (parma) {\n        try {\n            var data = {\n                'list': parma.list,\n                'score': parma.score\n            };\n            cc.sys.localStorage.setItem(\"new2048-keep-data\", JSON.stringify(data));\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //加载存档数据\n    loadGameProgress: function () {\n        var result = {\n            'list': [],\n            'score': 0\n        };\n        try {\n            var storage = cc.sys.localStorage.getItem('new2048-keep-data');\n            console.log('keep storage data : ' + storage);\n            if (!storage) {\n                return result;\n            }\n            var data = JSON.parse(storage);\n            if (data) {\n                return data;\n            }\n            return result;\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    clearGameProgressInfo: function () {\n        try {\n            cc.sys.localStorage.removeItem('new2048-keep-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //保存分数\n    saveScore: function (maxscore, gold) {\n        console.log('ThirdAPI saveScore', maxscore, gold);\n\n        if (Platform === 1) {\n            WXGlobal.saveScore(maxscore, gold);\n        } else if (Platform === 2) {\n            // FBGlobal.saveFBScore(maxscore, gold);\n        }\n        // 本地通过cocos再存储一份\n        try {\n            var data = \"{ \\\"maxscore\\\": \" + maxscore + \",\\n \\\"gold\\\": \" + gold + \"\" + \" }\"\n            console.log('try save local score', data);\n            cc.sys.localStorage.setItem(\"triline-data\", data);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //获取本地分数\n    loadScore: function (callback) {\n        if (Platform === 1) {\n            // return WXGlobal.loadScore(callback);\n            // 微信无法在主域获取用户托管数据,所以取通过cocos存储的本地数据\n            var result = this.loadLocalScore();\n            if (callback) {\n                callback(result.maxscore, result.gold);\n            }\n        } else if (Platform === 2) {\n            // return FBGlobal.getFBScore(callback);\n        }\n    },\n\n    loadLocalScore: function () {\n        var result = {\n            maxscore: 0,\n            gold: 0\n        }\n        try {\n            var storage = cc.sys.localStorage.getItem('triline-data');\n            console.log('storage data : ' + storage);\n            if(storage != \"\") {\n                var data = JSON.parse(storage);\n                if (data) {\n                    result.maxscore = parseInt(data.maxscore);\n                    if (data.gold) {\n                        result.gold = parseInt(data.gold);\n                    }\n                }\n            }\n\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    //存储复活次数\n    saveReviveData: function (shareTimes) {\n        try {\n            var storage = cc.sys.localStorage.getItem('2048-revive-data');\n            var data = JSON.parse(storage);\n            //如果本地数据\n            if (!data) {\n                data = {\n                    date: (new Date()).toDateString(),\n                    shareTimes: Global.reviveTodayTimes\n                };\n            } else {\n                if (data.date && data.date != (new Date()).toDateString()) {\n                    //删除无效数据\n                    console.log('重新保存数据：' + (new Date()).toDateString(), Global.reviveTodayTimes);\n                    this.clearReviveData();\n                    data = {\n                        date: (new Date()).toDateString(),\n                        shareTimes: Global.reviveTodayTimes\n                    };\n                } else {\n                    console.log('更新保存数据' + shareTimes);\n                    data = {\n                        date: (new Date()).toDateString(),\n                        shareTimes: shareTimes\n                    };\n                }\n            }\n            var data2 = JSON.stringify(data);\n            console.log('try save local revive', data2);\n            cc.sys.localStorage.setItem(\"2048-revive-data\", data2);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadReviveData: function () {\n        try {\n            var storage = cc.sys.localStorage.getItem('2048-revive-data');\n            console.log('revive storage data : ' + storage);\n            if (storage != \"\") {\n                var data = JSON.parse(storage);\n                if (data) {\n                    //判断是否是当天\n                    if (data.date && data.date == (new Date()).toDateString()) {\n                        return parseInt(data.shareTimes);\n                    } else {\n                        return Global.reviveTodayTimes;\n                    }\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return Global.reviveTodayTimes;\n    },\n\n    //清除复活次数\n    clearReviveData: function () {\n        try {\n            cc.sys.localStorage.removeItem('2048-revive-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //复活次数存储\n    saveShareData: function (shareTimes, shareDate) {\n        try {\n            var data = {\n                shareDate: shareDate,\n                shareTimes: shareTimes\n            };\n            var data2 = JSON.stringify(data);\n            cc.sys.localStorage.setItem(\"2048-share-data\", data2);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadShareData: function () {\n        var result = {\n            shareTimes: 0,\n            shareDate: ''\n        }\n        try {\n            var storage = cc.sys.localStorage.getItem('2048-share-data');\n            if (storage) {\n                var data = JSON.parse(storage);\n                if (data) {\n                    if (data.shareDate) {\n                        result.shareDate = data.shareDate;\n                    }\n                    if (data.shareTimes) {\n                        result.shareTimes = data.shareTimes;\n                    }\n                }\n            }\n        } catch (error) {\n            console.error(error);\n        }\n        return result;\n    },\n\n    //清除分享次数\n    clearShareData: function () {\n        try {\n            cc.sys.localStorage.removeItem('2048-share-data');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    //清除排行榜数据\n    clearRankData: function () {\n        console.log('ThirdAPI ready clearRankData');\n        if (Platform === 1) {\n            var data = ThirdAPI.loadLocalScore();\n            var score = parseInt(data.maxscore);\n            var gold = parseInt(data.gold);\n            ThirdAPI.loadScore(function(maxscore, gold) {\n                score = parseInt(maxscore);\n                gold = parseInt(gold);\n                console.log('clearRankData on ThirdAPI loadScore', score + \" :: \" + gold);\n            });\n\n            //先判断这一周是否有被清空过排行榜数据，没有数据则自动清空\n            try {\n                var unixTime = (new Date()).getTime();\n                var storage = cc.sys.localStorage.getItem('2048-rank-data');\n                if (storage) {\n                    // 有数据则判断这周是否清零过\n                    var data2 = JSON.parse(storage);\n                    var beforeClearTime = parseInt(data2.clearTime);\n                    if (beforeClearTime == 0) {\n                        console.log('清除排行的时间为0');\n                        //没有排行本地数据则分数清零\n                        cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                            clearTime: parseInt(unixTime)\n                        }));\n                        ThirdAPI.saveScore(0, gold);\n                    } else {\n                        var oldTime = new Date(beforeClearTime);\n                        var oldDay = (oldTime.getDay() == 0) ? 7 : oldTime.getDay();\n\n                        //计算当天从零点开始的秒数(小时、分钟、秒)\n                        var todaySeconds = oldTime.getHours() * 3600 + oldTime.getMinutes() * 60 + oldTime.getSeconds();\n\n                        var weekdayUnixTime = (beforeClearTime / 1000) - parseInt(oldDay - 1) * 86400 - todaySeconds;\n                        var sundayUnixTime = (beforeClearTime / 1000) + (7 - oldDay) * 86400 + (86400 - todaySeconds - 1);\n\n                        //如果这周没有清零则清一遍\n                        var currUnixTime = (new Date()).getTime();\n                        var canClear = ((parseInt(weekdayUnixTime * 1000) <= currUnixTime) && (currUnixTime <= parseInt(sundayUnixTime * 1000))) ? false : true;\n                        if (canClear) {\n                            //这一周排行榜数据没有清零\n                            console.log('新的一周可以清空排行榜数据');\n                            cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                                clearTime: parseInt(unixTime)\n                            }));\n                            ThirdAPI.saveScore(0, gold);\n                        }\n                    }\n                } else {\n                    //没有排行本地数据则分数清零\n                    cc.sys.localStorage.setItem(\"2048-rank-data\", JSON.stringify({\n                        clearTime: parseInt(unixTime)\n                    }));\n                    ThirdAPI.saveScore(0, gold);\n                }\n            } catch (error) {\n                console.error(error);\n            }\n        } else if (Platform === 2) {\n            //FB暂未清除排行榜\n        }\n    },\n\n    clearInfo: function (key) {\n        //console.log('ThirdAPI clearStoreInfo');\n        var list = []\n        try {\n            cc.sys.localStorage.removeItem('triline-data' + key);\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    saveInfo: function (key, list) {\n        //console.log('ThirdAPI saveStoreInfo');\n\n        // 本地通过cocos再存储一份\n        try {\n\n            var data = \"[\";\n            for (var i = 0; i < list.length; i++) {\n                if (i > 0) {\n                    data += \",\";\n                }\n                data += \"{\\\"index\\\":\\\"\" + list[i] + \"\\\"}\";\n            }\n            data += \"]\";\n            //var data = \"{ \\\"name\\\" : \\\"bob\\\", \\\"id\\\":\\\"10\\\"}\";\n            //console.log('try save local score',data);\n            cc.sys.localStorage.setItem('triline-data' + key, data);\n        } catch (error) {\n            //console.error(error);\n        }\n    },\n\n    loadInfo: function (key) {\n        //console.log('ThirdAPI loadStoreInfo');\n        var list = []\n        try {\n            var storage = cc.sys.localStorage.getItem('triline-data' + key);\n            //console.log('storage data : ' + storage);\n            var data = JSON.parse(storage);\n            //console.log('data : ', data);\n            if (data) {\n                for (var i = 0; i < data.length; i++) {\n                    list.push(data[i].index);\n                }\n                //console.log(\"the list of store data is :\", list);\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    clearCurrentSkin: function () {\n        //console.log('ThirdAPI clearStoreInfo');\n        var list = []\n        try {\n            cc.sys.localStorage.removeItem('triline-currentskin-data');\n        } catch (error) {\n            //console.error(error);\n        }\n        return list;\n    },\n\n    saveCurrentSkin: function (current) {\n        //console.log('ThirdAPI saveStoreInfo');\n\n        // 本地通过cocos再存储一份\n        try {\n            var data = \"{ \\\"currentSkin\\\": \" + current + \" }\"\n            //console.log('try save local score',data);\n            cc.sys.localStorage.setItem(\"triline-currentskin-data\", data);\n        } catch (error) {\n            //console.error(error);\n        }\n    },\n\n    loadCurrentSkin: function () {\n        //console.log('ThirdAPI loadStoreInfo');\n        var ret = 0;\n        try {\n            var storage = cc.sys.localStorage.getItem('triline-currentskin-data');\n            var data = JSON.parse(storage);\n            if (data) {\n                ret = parseInt(data.currentSkin);\n            }\n        } catch (error) {\n            //console.error(error);\n        }\n        return ret;\n    },\n    \n    getHelpInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getHelpInfo();\n        } else if (Platform === 2) {}\n    },\n\n    shareGame: function (imageurl, callback, failcallback, sourcecode,channelPrefix) {\n        if (Platform === 1) {\n            if (callback) {\n                console.log('wx has callback');\n\n            } else {\n                console.log('wx has no callback');\n            }\n            \n            WXGlobal.shareGame(imageurl, callback, failcallback, sourcecode,channelPrefix);\n\n            /*\n            var shareManager = require('shareManager');\n            var extraParam = {\n                sendTime: (new Date()).getTime()\n            };\n            shareManager.sharePoint(sourcecode, callback, failcallback, extraParam);*/\n        } else if (Platform === 2) {\n            // FBGlobal.onShareGame(imageurl, callback);\n        }\n    },\n    \n    //加载好友索取钻石的信息\n    saveFriendGenStoneInfo: function (storage) {\n        console.log('ThirdAPI saveInfo');\n        try {\n            var data = JSON.stringify(storage);\n            console.log('try save local data', data);\n            cc.sys.localStorage.setItem('new2048-claimData', data);\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    loadFriendGenStoneInfo: function () {\n        console.log('ThirdAPI loadInfo');\n        try {\n            var storage = cc.sys.localStorage.getItem('new2048-claimData');\n            console.log('storage data : ' + storage);\n            var data = JSON.parse(storage);\n            if (data) {\n                return data;\n            }\n            return null;\n        } catch (error) {\n            return null;\n        }\n        return null;\n    },\n\n    clearFriendGenStoneInfo: function () {\n        try {\n            cc.sys.localStorage.removeItem('new2048-claimData');\n        } catch (error) {\n            console.error(error);\n        }\n    },\n\n    getShareUserInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getShareUserInfo()\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    exitGame: function () {\n        if (Platform === 1) {\n            return WXGlobal.exit()\n        } else if (Platform === 2) {\n\n        }\n    },\n\n    getSystemInfo: function () {\n        if (Platform === 1) {\n            return WXGlobal.getSystemInfo()\n        } else if (Platform === 2) {\n\n        }\n    }\n}\n\nmodule.exports = ThirdAPI;"]}